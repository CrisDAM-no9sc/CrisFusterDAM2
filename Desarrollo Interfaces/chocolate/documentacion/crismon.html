
    <!DOCTYPE html>
    <html lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Documentacion </title>
        <style>
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                margin: 10px;
                padding: 0;
                background-color: #eef2f3;
                color: #333;
            }
            .container {
                max-width: 900px;
                margin: 0 auto;
                padding: 0 20px;
            }
            header {
                background: linear-gradient(135deg, #2980b9, #6dd5fa);
                color: #fff;
                padding: 30px;
                text-align: center;
                position: relative;
            }
            header img {
                max-height: 80px;
                position: absolute;
                left: 20px;
                top: 50%;
                transform: translateY(-50%);
            }
            header h1 {
                margin: 0;
                font-size: 2.5em;
            }
            header h2 {
                margin: 5px 0 0;
                font-size: 1.2em;
                font-weight: normal;
            }
            header p {
                margin: 5px 0 0;
                font-size: 1em;
                font-style: italic;
            }
            main {
                padding: 20px 0;
            }
            pre {
                background: #2d2d2d;
                color: #ccc;
                padding: 10px;
                border-radius: 5px;
                overflow-x: auto;
            }
            code {
                font-family: Consolas, monospace;
            }
            a {
                color: #2980b9;
                text-decoration: none;
            }
            a:hover {
                text-decoration: underline;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <header>
                <img src="C:/xampp/htdocs/Desarrollo Interfaces/chocolate/documentacion\logo_crsimon.png" alt="Logo Crsimon">
                <h1>Documentacion </h1>
                <h2>Version 0.1</h2>
                <p>Autor: Cristina Fuster</p>
            </header>
            <main>
                <h1>Estructura del Proyecto</h1>
<ul>
<li><strong>🗀  097-implemnetacion seguridad/</strong><ul>
<li><strong>🗀  api/</strong><ul>
<li>🗋  formulario.html</li>
<li>🗋  index.php</li>
<li>🗋  ip.php</li>
<li><strong>🗀  inc/</strong><ul>
<li>🗋  damepedidos.php</li>
<li>🗋  error.php</li>
<li>🗋  insertarCliente.php</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  cliente/</strong><ul>
<li>🗋  estilologin.css</li>
<li>🗋  index.php</li>
<li>🗋  login.js</li>
<li><strong>🗀  analisis/</strong><ul>
<li>🗋  cosigo.js</li>
<li>🗋  estilo.css</li>
<li>🗋  index.html</li>
</ul>
</li>
<li><strong>🗀  aplicaciones/</strong><ul>
<li><strong>🗀  cms/</strong></li>
<li><strong>🗀  crm/</strong></li>
</ul>
</li>
<li><strong>🗀  escritorio/</strong><ul>
<li>🗋  comportamiento.js</li>
<li>🗋  estilo.css</li>
<li>🗋  index.html</li>
<li><strong>🗀  img/</strong><ul>
<li>🗋  cerrar_sesion.png</li>
<li>🗋  icono.png</li>
<li>🗋  logo.png</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  img/</strong><ul>
<li>🗋  aplicacioenes.png</li>
<li>🗋  clientes.png</li>
<li>🗋  documento.png</li>
<li>🗋  eliminar.png</li>
<li>🗋  icnotabla.png</li>
<li>🗋  icono.png</li>
<li>🗋  iconodocumento.png</li>
<li>🗋  informe.png</li>
<li>🗋  listapedidos.png</li>
<li>🗋  lupa.png</li>
<li>🗋  nombrecliente.png</li>
<li>🗋  pedidos.png</li>
<li>🗋  productos.png</li>
<li>🗋  usuarios.png</li>
</ul>
</li>
<li><strong>🗀  inc/</strong><ul>
<li>🗋  geolocalizacion.php</li>
<li>🗋  sis_seguridad.php</li>
<li>🗋  verificar_ip.php</li>
<li>🗋  verificar_navegador.php</li>
</ul>
</li>
<li><strong>🗀  include/</strong><ul>
<li>🗋  idiomas.php</li>
</ul>
</li>
<li><strong>🗀  supercontrolador/</strong><ul>
<li>🗋  comportamiento.js</li>
<li>🗋  estilo.css</li>
<li>🗋  index.php</li>
<li><strong>🗀  apps/</strong><ul>
<li>🗋  apps.json</li>
<li><strong>🗀  clientes/</strong><ul>
<li><strong>🗀  ficha_clientes/</strong><ul>
<li>🗋  index.html</li>
</ul>
</li>
<li><strong>🗀  historico_compra/</strong><ul>
<li>🗋  index.html</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  pedidos/</strong><ul>
<li><strong>🗀  detalle_pedido/</strong><ul>
<li>🗋  index.html</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  ayuda/</strong><ul>
<li>🗋  index.php</li>
<li><strong>🗀  docs/</strong><ul>
<li>🗋  003.Preguntas Frecuentes.html</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  img/</strong><ul>
<li>🗋  icono.png</li>
<li>🗋  iconoconsola.png</li>
<li>🗋  informe.png</li>
</ul>
</li>
<li><strong>🗀  js/</strong><ul>
<li>🗋  cargaDatosTabla.js</li>
<li>🗋  cargarDatosColeccion.js</li>
<li>🗋  convierteTipoDato.js</li>
<li>🗋  crearMenuTablas.js</li>
<li>🗋  funciones.js</li>
<li>🗋  pueblaTabla.js</li>
</ul>
</li>
<li><strong>🗀  lib/</strong><ul>
<li><strong>🗀  ampliador/</strong><ul>
<li>🗋  ampliador.css</li>
<li>🗋  ampliador.js</li>
</ul>
</li>
<li><strong>🗀  graficos/</strong><ul>
<li>🗋  graficos.js</li>
</ul>
</li>
<li><strong>🗀  selectjv/</strong><ul>
<li>🗋  selectjv.css</li>
<li>🗋  selectjv.js</li>
</ul>
</li>
<li><strong>🗀  textEditor/</strong><ul>
<li>🗋  TextEditor.css</li>
<li>🗋  TextEditor.js</li>
</ul>
</li>
<li><strong>🗀  tooltip/</strong><ul>
<li>🗋  tooltip.css</li>
<li>🗋  tooltip.js</li>
</ul>
</li>
<li><strong>🗀  vistaTabla/</strong><ul>
<li>🗋  vistaTabla.css</li>
<li>🗋  vistaTabla.js</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  modulos/</strong><ul>
<li><strong>🗀  cabecera/</strong><ul>
<li>🗋  cabecera.css</li>
<li>🗋  cabecera.js</li>
<li>🗋  cabecera.php</li>
</ul>
</li>
<li><strong>🗀  cierre/</strong><ul>
<li>🗋  cierre.css</li>
<li>🗋  cierre.php</li>
</ul>
</li>
<li><strong>🗀  librerias/</strong><ul>
<li>🗋  librerias.php</li>
</ul>
</li>
<li><strong>🗀  modal/</strong><ul>
<li>🗋  modal.css</li>
<li>🗋  modal.js</li>
<li>🗋  modal.php</li>
</ul>
</li>
<li><strong>🗀  principal/</strong><ul>
<li>🗋  principal.css</li>
<li>🗋  principal.js</li>
<li>🗋  principal.php</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  traductor/</strong><ul>
<li>🗋  en.json</li>
<li>🗋  es.json</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  documentación/</strong><ul>
<li>🗋  diagrama cliente_servidor.odg</li>
<li>🗋  diagrama.odg</li>
</ul>
</li>
<li><strong>🗀  formularios/</strong><ul>
<li>🗋  descargar.php</li>
<li>🗋  documentos.php</li>
<li>🗋  envia.php</li>
<li>🗋  estilo.css</li>
<li>🗋  index.php</li>
<li>🗋  panel.php</li>
<li>🗋  vista.php</li>
<li><strong>🗀  documentos/</strong><ul>
<li>🗋  1738667300.json</li>
<li>🗋  1738667456.json</li>
<li>🗋  1738668266.json</li>
<li><strong>🗀  cliente/</strong><ul>
<li>🗋  20250220_083016.json</li>
</ul>
</li>
<li><strong>🗀  productos/</strong><ul>
<li>🗋  20250220_090702.json</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  forms/</strong><ul>
<li>🗋  cliente.json</li>
<li>🗋  productos.json</li>
<li>🗋  registro.json</li>
</ul>
</li>
<li><strong>🗀  lib/</strong><ul>
<li><strong>🗀  validadorForm/</strong><ul>
<li>🗋  validadorForm.css</li>
<li>🗋  validadorForm.js</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>🗀  public/</strong><ul>
<li>🗋  index.php</li>
</ul>
</li>
<li><strong>🗀  servidor/</strong><ul>
<li>🗋  ConectorMongoDB.php</li>
<li>🗋  conexionDB.php</li>
<li>🗋  index.php</li>
<li><strong>🗀  antiguo/</strong><ul>
<li>🗋  columnas_tabla.php</li>
<li>🗋  datos_tabla.php</li>
<li>🗋  eliminar_dato.php</li>
<li>🗋  insertar.php</li>
<li>🗋  lista_aplicaciones.php</li>
<li>🗋  lista_tablas.php</li>
<li>🗋  loginusuario.php</li>
</ul>
</li>
<li><strong>🗀  lib/</strong><ul>
<li>🗋  codificador.php</li>
<li>🗋  fuerza_bruta.php</li>
<li>🗋  ips_control.php</li>
<li>🗋  registros.php</li>
<li>🗋  sanear.php</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1>Documentación de Archivos</h1>
<h2>api\formulario.html</h2>
<p>cuando el usuario rellena los datos del formulario al apretar el boton de enviar esos datos se pasaran al archivo de api
para que sean procesados e insertados en la base de datos</p>
<h2>api\inc\damepedidos.php</h2>
<p>es un archivo con la lógica para consultar los pedidos de los clientes y organizarlos en formato JSON.</p>
<h2>cliente\estilologin.css</h2>
<h1>Estilos del Sistema de Login</h1>
<h2>Descripción:</h2>
<ul>
<li>Define la apariencia del formulario de login.</li>
<li>Mejora la usabilidad y accesibilidad del sistema.</li>
</ul>
<h2>cliente\login.js</h2>
<p>*
 * # Sistema de Login Dinámico
 *
 * ## Descripción:
 * Este script maneja el proceso de autenticación del usuario mediante un formulario dinámico.
 *
 * ## Funciones principales:
 * - Carga las traducciones según el idioma del navegador.
 * - Maneja eventos del formulario de login.
 * - Valida la entrada del usuario antes de enviarla al servidor.
 * - Autenticación del usuario con <code>fetch</code> enviando JSON.
 * - Muestra mensajes y errores en la interfaz.</p>
<h2>cliente\analisis\cosigo.js</h2>
<ul>
<li>Se encarga de obtener la lista de tablas desde el servidor.</li>
<li>Permite seleccionar las columnas que se desean consultar.</li>
<li>Realiza la consulta a la base de datos a través de una solicitud fetch.</li>
<li>Muestra los resultados en una tabla dentro del <div class="resultados">.</li>
<li>Proporciona funciones para descargar los resultados en CSV y PDF.</li>
</ul>
<h2>cliente\escritorio\comportamiento.js</h2>
<p>*
 * # Sistema de Validación y Carga Dinámica de Aplicaciones
 * 
 * ## Descripción:
 * Este script maneja la autenticación del usuario, validación de tokens y 
 * carga dinámica de las aplicaciones disponibles para el usuario autenticado.
 * 
 * ## Funcionalidades principales:
 * - Verificación del usuario y token en <code>localStorage</code>.
 * - Validación del token con el servidor (<code>fetch</code> a <code>compruebatoken</code>).
 * - Carga de las aplicaciones disponibles desde el servidor.
 * - Renderizado dinámico de las aplicaciones en la interfaz.
 * - Manejo de eventos <code>onclick</code> en los elementos generados.
 * - Cierre de sesión eliminando credenciales del <code>localStorage</code>.</p>
<h2>cliente\escritorio\estilo.css</h2>
<p>Estilo global</p>
<h2>cliente\inc\geolocalizacion.php</h2>
<p>*
 * ##  Descripción:
 * Este archivo se encarga de la <strong>verificación geográfica</strong> de los accesos al sistema. 
 * Utiliza tanto la base de datos local como una API externa para obtener la ubicación 
 * geográfica de una dirección IP y determinar si el acceso está permitido.
 *
 * ## Funciones Principales:
 * - Obtiene el país de una IP desde la base de datos y, si no existe, consulta una API externa.
 * - Devuelve <code>true</code> si la IP pertenece a España (<code>'ES'</code>), <code>false</code> en caso contrario.
 *
 * ##  Notas:
 * - <strong>Uso de API Externa:</strong> Si la IP no está registrada en la base de datos, se realiza una consulta a <code>ip-api.com</code> para obtener la ubicación.
 * - <strong>Optimización:</strong> Se guarda la información en la base de datos para evitar consultas repetitivas a la API.
 * - <strong>Seguridad:</strong> Evita accesos no autorizados restringiendo el acceso únicamente a IPs españolas.</p>
<h2>cliente\inc\sis_seguridad.php</h2>
<p>*
 * ## Descripción:
 * Este archivo es el <strong>núcleo del sistema de seguridad</strong> del proyecto. 
 * Se encarga de verificar y restringir el acceso al sistema basándose en:
 * - <strong>Lista negra de IPs</strong> (bloqueo de direcciones IP no autorizadas).
 * - <strong>Restricción de navegadores</strong> (impide el acceso desde navegadores no permitidos).
 * - <strong>Ubicación geográfica</strong> (permite solo accesos desde España).
 * - <strong>Registro de accesos</strong> (almacena la información de cada intento de conexión).
 *
 * ## Notas:
 * - Se requiere <code>conexionDB.php</code> para la conexión a la base de datos.
 * - Usa <code>ips_control.php</code> para manejar la gestión de direcciones IP.
 * - Utiliza <code>verificar_ip.php</code>, <code>verificar_navegador.php</code> y <code>geolocalizacion.php</code> para controles específicos.</p>
<h2>cliente\inc\verificar_ip.php</h2>
<p>*
 * # Verificación de IP en Listas Negra o Blanca
 *
 * ## Descripción:
 * Este archivo contiene la función <code>ipEnLista()</code>, utilizada para verificar si una IP
 * está registrada en una lista blanca o negra dentro de la base de datos.
 *
 * ## Funciones principales:
 * - Conectar con la base de datos mediante <code>$conexion</code>.
 * - Consultar si la IP está en la lista negra (<code>lista_negra</code>) o blanca (<code>lista_blanca</code>).
 * - Devolver <code>true</code> si la IP está en la lista especificada, o <code>false</code> en caso contrario.</p>
<h2>cliente\inc\verificar_navegador.php</h2>
<ul>
<li></li>
<li>
<h2>Descripción:</h2>
</li>
<li>Este archivo forma parte del sistema de seguridad y su función principal es <strong>verificar si una IP accedió con un navegador prohibido</strong>.</li>
<li>Actualmente, el sistema <strong>bloquea el acceso a usuarios que utilicen Mozilla Firefox</strong>, aunque se pueden añadir más navegadores si es necesario.</li>
<li></li>
<li>
<h2>Funcionamiento:</h2>
</li>
<li>
<ol>
<li><strong>Incluye el archivo <code>sis_seguridad.php</code></strong> para acceder a la configuración de seguridad y la conexión a la base de datos.</li>
</ol>
</li>
<li>
<ol>
<li><strong>Define la función <code>navegadorProhibido($ip, $conexion)</code></strong>:</li>
</ol>
</li>
<li>
<ul>
<li>Consulta la tabla <code>ips_control</code> en la base de datos para verificar qué navegador ha sido registrado con la dirección IP dada.</li>
</ul>
</li>
<li>
<ul>
<li>Si el navegador registrado es <strong>Firefox</strong>, devuelve <code>true</code>, indicando que el acceso debe ser restringido.</li>
</ul>
</li>
<li>
<ul>
<li>En caso contrario, devuelve <code>false</code>, permitiendo el acceso.</li>
</ul>
</li>
<li></li>
<li>
<h2>Dependencias:</h2>
</li>
<li>
<ul>
<li><code>sis_seguridad.php</code>: Proporciona la conexión a la base de datos.</li>
</ul>
</li>
<li>
<ul>
<li>Base de datos: La tabla <code>ips_control</code> almacena la información de IPs y navegadores registrados.</li>
</ul>
</li>
</ul>
<h2>cliente\supercontrolador\comportamiento.js</h2>
<p>*
 * # Comportamiento de la Aplicación
 *
 * ## Descripción:
 * Script encargado de la inicialización de la aplicación y el manejo de eventos principales.
 *
 * ## Funciones principales:
 * - <code>mostrarUsuario()</code>: Muestra el usuario autenticado.
 * - <code>logout()</code>: Maneja la acción de cierre de sesión.
 * - <code>abrirCorreo()</code>: Permite abrir el correo corporativo.
 * - <code>imprimir()</code>: Habilita la función de impresión de contenido.
 * - <code>listadoTablas(aplicacion)</code>: Carga las tablas asociadas a la aplicación seleccionada.
 * - <code>listadoDocumentos()</code>: Muestra la lista de documentos disponibles.
 * - <code>cargaGraficas()</code>: Carga y renderiza las gráficas de datos.
 * - <code>cargoAplicaciones()</code>: Carga la lista de aplicaciones disponibles.</p>
<h2>cliente\supercontrolador\estilo.css</h2>
<p>Estilo global</p>
<h2>cliente\supercontrolador\index.php</h2>
<p>*
 * # Página Principal de la Aplicación
 *
 * ## Descripción:
 * Este archivo carga los módulos principales de la aplicación, organizando el layout de la interfaz.
 *
 * ## Módulos incluidos:
 * - <strong>Cabecera (<code>cabecera.php</code>)</strong>: Contiene el encabezado del sistema.
 * - <strong>Principal (<code>principal.php</code>)</strong>: Cuerpo principal donde se muestra la información.
 * - <strong>Modal (<code>modal.php</code>)</strong>: Ventanas emergentes o modales para interacciones.
 * - <strong>Librerías (<code>librerias.php</code>)</strong>: Carga scripts y estilos adicionales.
 * - <strong>Cierre (<code>cierre.php</code>)</strong>: Pie de página o cierre de estructuras HTML abiertas.
 *
 * ## Funciones principales:
 * - Ensamblar los módulos del sistema.
 * - Cargar los scripts de comportamiento (<code>comportamiento.js</code>).</p>
<h2>cliente\supercontrolador\ayuda\index.php</h2>
<p>Función para recorrer y mostrar carpetas y archivos</p>
<h2>cliente\supercontrolador\js\cargaDatosTabla.js</h2>
<p>CREO UNA FUNCIÓN PARA CARGAR DINÁMICAMENTE TABLAS /////////////////////////////////////////////</p>
<h2>cliente\supercontrolador\lib\ampliador\ampliador.css</h2>
<p>Estilo de la Página General</p>
<h2>cliente\supercontrolador\lib\graficos\graficos.js</h2>
<p>*
 * # Generador de Gráficos Dinámicos
 * 
 * ## Descripción:
 * Esta clase permite generar gráficos de pastel y de barras de manera dinámica utilizando
 * el elemento <code>&lt;canvas&gt;</code>. Se pueden personalizar los colores, el título y el contenedor
 * donde se insertará el gráfico.
 * 
 * ## Funcionalidades principales:
 * - Creación de gráficos circulares (tipo pastel).
 * - Creación de gráficos de barras.
 * - Soporte para personalización de colores y títulos.
 * - Conversión de colores de formato hexadecimal a RGB.
 * - Distribución automática de etiquetas en los gráficos.</p>
<h2>cliente\supercontrolador\lib\textEditor\TextEditor.js</h2>
<p>*
 * # Editor de Texto Enriquecido
 * 
 * ## Descripción:
 * Este script convierte los elementos <code>&lt;textarea&gt;</code> en editores de texto enriquecido,
 * permitiendo aplicar estilos como negrita, cursiva, subrayado, alineaciones, colores,
 * tamaños de fuente y listas ordenadas/desordenadas.
 * 
 * ## Funcionalidades principales:
 * - Reemplaza los <code>&lt;textarea&gt;</code> con una versión editable (<code>div[contenteditable]</code>).
 * - Agrega una barra de herramientas para modificar el texto.
 * - Permite cambiar estilos de texto como negrita, cursiva, subrayado, color y tamaño.
 * - Agrega funcionalidades de alineación y listas.
 * - Mantiene sincronización entre el editor visual y el textarea original.</p>
<h2>cliente\supercontrolador\lib\vistaTabla\vistaTabla.css</h2>
<p>*
 * # Estilos de Tablas Dinámicas
 *
 * ## Descripción:
 * Define los estilos visuales para mejorar la apariencia de las tablas.
 *
 * ## Funcionalidades principales:
 * - Aplicar colores y formatos a cabeceras, filas y celdas.
 * - Alternar colores para mejorar la legibilidad.
 * - Resaltar filas al pasar el cursor sobre ellas.</p>
<h2>cliente\supercontrolador\lib\vistaTabla\vistaTabla.js</h2>
<p>*
 * # Configuración Dinámica de Tablas
 *
 * ## Descripción:
 * Este script configura la estructura de una tabla, permitiendo:
 * - Extraer los datos dinámicamente desde el contenido actual.
 * - Ordenar las columnas al hacer clic en los encabezados.
 * - Agregar un contador de filas.
 * - Actualizar los datos de la tabla después de cada ordenación.
 * - Detectar nuevas tablas agregadas dinámicamente al DOM y configurarlas automáticamente.
 *
 * ## Funcionalidades principales:
 * - <code>configurarTabla(tabla)</code>: Configura una tabla para que sea interactiva y ordenable.
 * - <code>datosTabla()</code>: Pobla la tabla con los datos extraídos y ordenados.
 * - <code>MutationObserver()</code>: Detecta y configura nuevas tablas añadidas al DOM.</p>
<h2>cliente\supercontrolador\modulos\cabecera\cabecera.css</h2>
<p>Estilo del header</p>
<h2>cliente\supercontrolador\modulos\cabecera\cabecera.js</h2>
<p>Función para mostrar el nombre de usuario guardado en localStorage</p>
<h2>cliente\supercontrolador\modulos\cierre\cierre.css</h2>
<p>Estilo del footer</p>
<h2>cliente\supercontrolador\modulos\modal\modal.css</h2>
<p><strong><em>*</em></strong><strong><em>*</em></strong><strong><em>* ESTILO VENTANA EMERGENTE </em></strong><strong><em>*</em></strong><strong><em>*</em></strong><strong>*</strong>*</p>
<h2>cliente\supercontrolador\modulos\modal\modal.js</h2>
<p>--- Ventana modal para INSERTAR REGISTROS ---</p>
<h2>cliente\supercontrolador\modulos\principal\principal.js</h2>
<p>Función para listar las tablas según la aplicación seleccionada</p>
<h2>formularios\descargar.php</h2>
<p>*
 * ##  Funcionalidad:
 * - Permite descargar un documento JSON almacenado en <code>documentos/</code>.</p>
<h2>formularios\documentos.php</h2>
<p>*
 * ## Funcionalidad:
 * - Muestra los documentos generados en <code>documentos/{formulario}/</code>.
 * - Lista los archivos JSON guardados para cada formulario.
 * - Permite visualizar y descargar los archivos JSON generados.</p>
<h2>formularios\envia.php</h2>
<ul>
<li>Recibe los datos enviados desde index.php.</li>
<li>Valida los datos según las reglas definidas en el JSON del formulario.</li>
<li>Guarda la información en un archivo JSON dentro de documentos/{formulario}/.
*</li>
</ul>
<h2>formularios\estilo.css</h2>
<p>Estilo general del formulario</p>
<h2>formularios\vista.php</h2>
<p>*
 * Funcionalidad:
 * Permite visualizar el contenido de un documento JSON en una página amigable.
 * Recibe el archivo a visualizar desde $_GET['archivo'].
 * La Carga el contenido del archivo JSON y lo formatea con json_encode().
 * Incluye un botón "Volver" para regresar a documentos.php.</p>
<h2>formularios\lib\validadorForm\validadorForm.css</h2>
<p>Clase para campos inválidos (error)</p>
<h2>formularios\lib\validadorForm\validadorForm.js</h2>
<p>Seleccionamos todos los elementos <input> del documento</p>
<h2>public\index.php</h2>
<p>*
 * ##  Descripción:
 * Este script proporciona una <strong>API pública REST</strong> para recuperar información de productos desde la base de datos.
 * Es un <strong>endpoint que devuelve un JSON</strong> con la lista de productos, incluyendo imágenes si están disponibles.
 *
 *
 * ##  Funcionalidades:
 * - <strong>Habilita CORS</strong> para permitir solicitudes desde cualquier origen (<code>*</code>).
 * - <strong>Obtiene la lista de productos desde MySQL</strong>.
 * - <strong>Modifica la URL de las imágenes</strong> para que sean accesibles desde un servidor externo.
 * - <strong>Devuelve los resultados en formato JSON</strong>.
 *</p>
<h2>servidor\ConectorMongoDB.php</h2>
<p>*
 * ## Descripción:
 * Este archivo implementa una <strong>clase para la gestión de bases de datos en MongoDB</strong> dentro del sistema.
 * Permite la conexión, consulta, inserción y eliminación de documentos en una base de datos <strong>NoSQL</strong>.
 *
 * ## Funcionalidades:
 * - <code>listar($coleccion)</code>: Devuelve todos los documentos de una colección en formato JSON.
 * - <code>listarColeccion()</code>: Lista todas las colecciones disponibles en la base de datos.
 * - <code>insertar($coleccion, $datos)</code>: Inserta un nuevo documento en la colección especificada.
 * - <code>eliminar($coleccion, $id)</code>: Elimina un documento específico según su <code>_id</code>.
 *</p>
<h2>servidor\conexionDB.php</h2>
<p>*
 * 
 <em>## Descripción:
 * Este archivo define la clase <code>conexionDB</code>, que maneja la conexión a la base de datos MySQL y 
 * proporciona diversas funciones para interactuar con ella, incluyendo:
 * - Conexión y gestión de la base de datos <code>crismon1</code>.
 * - Métodos para buscar, insertar, actualizar y eliminar registros en las tablas.
 * - Métodos para obtener información sobre la estructura de la base de datos.
 * - Implementación de seguridad mediante saneamiento de datos.
 * - Generación de datos para gráficas basadas en la cantidad de registros en las tablas.
 *
 * ## Notas:
 * - </em><em>Seguridad:</em><em> Se implementa saneamiento de datos con <code>mysqli_real_escape_string()</code> y <code>sanear()</code>.
 * - </em><em>Optimización:</em><em> Se han agregado métodos reutilizables para mejorar el rendimiento.
 * - </em><em>Uso:</em>* Este archivo debe ser incluido en otros scripts que necesiten acceso a la base de datos.</p>
<h2>servidor\index.php</h2>
<p>*
 * ## 🔹 Descripción:
 * Este script actúa como un <strong>controlador de la API</strong>, gestionando solicitudes HTTP (GET y POST) 
 * para interactuar con las bases de datos <strong>MySQL</strong> y <strong>MongoDB</strong>.
 *
 *
 * ##  Funcionalidades:
 * - <strong>Conexión a bases de datos</strong> (MySQL y MongoDB).
 * - <strong>Gestión de usuarios y permisos</strong>.
 * - <strong>Operaciones CRUD</strong> en MySQL y MongoDB.
 * - <strong>Protección contra ataques</strong>:
 *   - <strong>Fuerza bruta</strong> (detección y bloqueo de IPs sospechosas).
 *   - <strong>Saneamiento de entradas</strong> (prevención de inyección SQL).
 *   - <strong>Cifrado de datos sensibles</strong>.
 *</p>
<h2>servidor\lib\codificador.php</h2>
<p>*
 * ##  Descripción:
 * Este archivo define una <strong>clase de cifrado personalizada</strong> que permite codificar y descodificar cadenas de texto. 
 * Se usa para proteger datos sensibles mediante un doble proceso de cifrado:
 * 1. <strong>Modificación de caracteres ASCII</strong> sumando/restando 5 posiciones en cada carácter.
 * 2. <strong>Triple codificación Base64</strong> para mayor complejidad.
 *</p>
<h2>servidor\lib\fuerza_bruta.php</h2>
<p>*
 * # Archivo: fuerza_bruta.php
 *
 * ##  Descripción:
 * Este archivo implementa un <strong>sistema de protección contra ataques de fuerza bruta</strong>. Su objetivo es:
 * - <strong>Monitorear intentos de conexión</strong> en un período de 60 segundos.
 * - <strong>Bloquear una IP</strong> si supera los 100 intentos en dicho intervalo.
 * - <strong>Registrar intentos sospechosos</strong> en la base de datos.
 * - <strong>Enviar una respuesta JSON en caso de detección de ataque</strong>.
 *
 *
 * ##  Notas:
 * - La verificación se realiza utilizando la tabla <code>registros</code>.
 * - Requiere que la tabla <code>registros</code> contenga los campos: <code>ip</code>, <code>epoch</code>, <code>user_agent</code>, <code>url</code>, y <code>motivo</code>.</p>
<h2>servidor\lib\ips_control.php</h2>
<p>*
 * ## Descripción:
 * Este archivo se encarga de <strong>registrar y verificar accesos de usuarios</strong> en la base de datos mediante:
 * - <strong>Consulta de país de la IP</strong> a través de una API externa.
 * - <strong>Registro de IPs</strong> en la base de datos (<code>ips_control</code>).
 * - <strong>Actualización de país y navegador</strong> en la base de datos cuando un usuario vuelve a conectarse.
 * - <strong>Detección del navegador del usuario</strong> para su posterior restricción si es necesario.
 *
 * ## Notas:
 * - Requiere <code>conexionDB.php</code> para conectar con la base de datos.
 * - Requiere <code>geolocalizacion.php</code> para verificar la ubicación geográfica de la IP.
 * - El registro de IPs permite futuras restricciones basadas en listas negras y ubicación.</p>
<h2>servidor\lib\registros.php</h2>
<p>*
 * ## Descripción:
 * Este archivo <strong>registra todas las solicitudes</strong> a la aplicación en una base de datos. 
 * Se utiliza para <strong>monitoreo de accesos</strong> y <strong>detección de intentos sospechosos</strong>.
 *
 *
 * ## Funcionamiento:
 * - Se conecta a la base de datos <code>crismon1</code>.
 * - Inserta un nuevo registro en la tabla <code>registros</code> con los siguientes datos:
 *   - <strong>Fecha y hora del acceso</strong> (<code>epoch</code>).
 *   - <strong>Dirección IP del usuario</strong> (<code>REMOTE_ADDR</code>).
 *   - <strong>Navegador usado</strong> (<code>HTTP_USER_AGENT</code>).
 *   - <strong>Página solicitada</strong> (<code>REQUEST_URI</code>).
 *</p>
<h2>servidor\lib\sanear.php</h2>
<p>*
 * ## Descripción:
 * Este archivo contiene una función para <strong>sanitizar datos de entrada</strong> y prevenir ataques de inyección SQL.
 *
 *
 * ## Funcionamiento:
 * - <code>sanear($elemento)</code>: 
 *   - Verifica si la entrada es un array, de lo contrario devuelve un error JSON.
 *   - Comprueba que las claves y valores no contengan palabras prohibidas (<code>DELETE</code>, <code>DROP</code>, <code>TRUNCATE</code>, <code>TABLE</code>).
 *   - Aplica la verificación <strong>de manera recursiva en arrays anidados</strong>.
 *</p>
<h1>Código de Archivos</h1>
<h2>api\formulario.html</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">&lt;!--</span>
<span class="cm">cuando el usuario rellena los datos del formulario al apretar el boton de enviar esos datos se pasaran al archivo de api</span>
<span class="cm">para que sean procesados e insertados en la base de datos</span>
<span class="cm">--&gt;</span>
<span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;api.php?o=insertarCliente&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;nombre&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;apellidos&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;clave&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;claveprueba&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>

<h2>api\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="k">include</span> <span class="s2">&quot;inc/error.php&quot;</span><span class="p">;</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>


    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">])){</span>
        <span class="k">switch</span> <span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="k">case</span> <span class="s2">&quot;clientes&quot;</span><span class="o">:</span>
                <span class="k">include</span> <span class="s2">&quot;inc/damepedidos.php&quot;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="k">case</span> <span class="s2">&quot;insertarCliente&quot;</span><span class="o">:</span>
                <span class="k">include</span> <span class="s2">&quot;inc/insertarCliente.php&quot;</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="k">default</span><span class="o">:</span>
                <span class="k">echo</span> <span class="s2">&quot;no&quot;</span><span class="p">;</span>
        <span class="p">}</span>           
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;no&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>api\ip.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="k">echo</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_ADDR&#39;</span><span class="p">];</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>api\inc\damepedidos.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="c1">///es un archivo con la lógica para consultar los pedidos de los clientes y organizarlos en formato JSON.</span>
<span class="k">include</span> <span class="s2">&quot;conexionDB.php&quot;</span><span class="p">;</span>

<span class="c1">// Definimos la consulta SQL que vamos a ejecutar</span>
<span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">    SELECT </span>
<span class="s2">        clientes.nombre AS nombre,  </span>
<span class="s2">        clientes.apellidos AS apellidos,  </span>
<span class="s2">        pedidos.fecha AS pedidos_fecha,  </span>
<span class="s2">        listapedidos.productos_nombre AS producto_id,  </span>
<span class="s2">        productos.nombre AS producto_nombre, </span>
<span class="s2">        listapedidos.cantidad AS cantidad  </span>
<span class="s2">    FROM clientes  </span>
<span class="s2">    LEFT JOIN pedidos ON clientes.Identificador = pedidos.clientes_nombre  </span>
<span class="s2">    LEFT JOIN listapedidos ON pedidos.Identificador = listapedidos.pedidos_fecha</span>
<span class="s2">    LEFT JOIN productos ON listapedidos.productos_nombre = productos.Identificador</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>

<span class="nv">$datos</span> <span class="o">=</span> <span class="p">[];</span>

<span class="k">while</span> <span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">))</span> <span class="p">{</span>
    <span class="c1">// Construir la estructura JSON</span>
    <span class="nv">$cliente_key</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s2">&quot; &quot;</span> <span class="o">.</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;apellidos&#39;</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$datos</span><span class="p">[</span><span class="nv">$cliente_key</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$datos</span><span class="p">[</span><span class="nv">$cliente_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;cliente&quot;</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s2">&quot;nombre&quot;</span> <span class="o">=&gt;</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">],</span>
                <span class="s2">&quot;apellidos&quot;</span> <span class="o">=&gt;</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;apellidos&#39;</span><span class="p">]</span>
            <span class="p">],</span>
            <span class="s2">&quot;pedidos&quot;</span> <span class="o">=&gt;</span> <span class="p">[]</span>
        <span class="p">];</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;pedidos_fecha&#39;</span><span class="p">])</span> <span class="p">{</span>
        <span class="nv">$pedido_key</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;pedidos_fecha&#39;</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$datos</span><span class="p">[</span><span class="nv">$cliente_key</span><span class="p">][</span><span class="s2">&quot;pedidos&quot;</span><span class="p">][</span><span class="nv">$pedido_key</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$datos</span><span class="p">[</span><span class="nv">$cliente_key</span><span class="p">][</span><span class="s2">&quot;pedidos&quot;</span><span class="p">][</span><span class="nv">$pedido_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;fecha&quot;</span> <span class="o">=&gt;</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;pedidos_fecha&#39;</span><span class="p">],</span>
                <span class="s2">&quot;listapedidos&quot;</span> <span class="o">=&gt;</span> <span class="p">[]</span>
            <span class="p">];</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;producto_nombre&#39;</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;cantidad&#39;</span><span class="p">])</span> <span class="p">{</span>
            <span class="nv">$datos</span><span class="p">[</span><span class="nv">$cliente_key</span><span class="p">][</span><span class="s2">&quot;pedidos&quot;</span><span class="p">][</span><span class="nv">$pedido_key</span><span class="p">][</span><span class="s2">&quot;listapedidos&quot;</span><span class="p">][]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;producto&quot;</span> <span class="o">=&gt;</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;producto_nombre&#39;</span><span class="p">],</span>
                <span class="s2">&quot;cantidad&quot;</span> <span class="o">=&gt;</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;cantidad&#39;</span><span class="p">]</span>
            <span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Reorganizar el array para eliminar índices de cliente y pedidos</span>
<span class="nv">$output</span> <span class="o">=</span> <span class="p">[];</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$datos</span> <span class="k">as</span> <span class="nv">$cliente</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$cliente_pedidos</span> <span class="o">=</span> <span class="p">[];</span>
    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cliente</span><span class="p">[</span><span class="s1">&#39;pedidos&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$pedido</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$cliente_pedidos</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$pedido</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nv">$output</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;cliente&quot;</span> <span class="o">=&gt;</span> <span class="nv">$cliente</span><span class="p">[</span><span class="s1">&#39;cliente&#39;</span><span class="p">],</span>
        <span class="s2">&quot;pedidos&quot;</span> <span class="o">=&gt;</span> <span class="nv">$cliente_pedidos</span>
    <span class="p">];</span>
<span class="p">}</span>

<span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$output</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>api\inc\error.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Activo errores</span>
    <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="c1">// Activo errores de inicio</span>
    <span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span> 

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>api\inc\insertarCliente.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">    SELECT * FROM clavesapi</span>
<span class="s2">    WHERE clave = &#39;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;clave&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">&quot;</span><span class="p">;</span>
<span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>
<span class="k">if</span><span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">)){</span>
    <span class="k">echo</span> <span class="s2">&quot;Acceso correcto, vamos a realizar la insercion&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error de acceso&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nv">$ip_servidor</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;SERVER_ADDR&#39;</span><span class="p">];</span>

<span class="c1">// Si estás trabajando en un entorno local, puede ser tanto IPv4 como IPv6</span>
<span class="k">if</span> <span class="p">(</span><span class="nv">$ip_servidor</span> <span class="o">==</span> <span class="s2">&quot;192.168.0.22&quot;</span> <span class="o">||</span> <span class="nv">$ip_servidor</span> <span class="o">==</span> <span class="s2">&quot;127.0.0.1&quot;</span> <span class="o">||</span> <span class="nv">$ip_servidor</span> <span class="o">==</span> <span class="s2">&quot;::1&quot;</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Si la IP coincide, continuamos con la inserción</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error de IP no admitida&quot;</span><span class="p">);</span>
<span class="p">}</span>
<span class="c1">//if($_SERVER[&#39;SERVER_ADDR&#39;] == &quot;192.168.0.22&quot;){}</span>

<span class="c1">///////////////// AQUI VAMOS APONER LA LOGICA DE INSERTAR ////////////</span>
<span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;apellidos&#39;</span><span class="p">])){</span>
    <span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        INSERT INTO clientes</span>
<span class="s2">        (nombre, apellidos)</span>
<span class="s2">        VALUES (</span>
<span class="s2">            &#39;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">            &#39;&quot;</span><span class="o">.</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;apellidos&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">        );</span>
<span class="s2">    &quot;</span><span class="p">;</span>
    <span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>
<span class="p">}</span><span class="k">else</span><span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;Error en la petición&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>cliente\estilologin.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* </span>
<span class="c"># Estilos del Sistema de Login</span>
<span class="c">## Descripción:</span>
<span class="c">- Define la apariencia del formulario de login.</span>
<span class="c">- Mejora la usabilidad y accesibilidad del sistema.</span>
<span class="c">*/</span>

<span class="c">/* Estilo General del Cuerpo */</span>
<span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">vh</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/* Contenedor del Formulario de Login */</span>
<span class="p">#</span><span class="nn">formlogin</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">320</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">relative</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/* Logo */</span>
<span class="p">#</span><span class="nn">logo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Campos de Entrada y Botón */</span>
<span class="nt">input</span><span class="o">,</span><span class="w"> </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Campos de Entrada */</span>
<span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#FFFFFF</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">border</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">input</span><span class="p">:</span><span class="nd">focus</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">border-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">outline</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del Botón */</span>
<span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">button</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/* Mensaje de error o comentarios */</span>
<span class="p">#</span><span class="nn">comentario</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">red</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Responsividad para Dispositivos Móviles */</span>
<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="o">(</span><span class="nt">max-width</span><span class="o">:</span><span class="w"> </span><span class="nt">400px</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">#</span><span class="nn">formlogin</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="kt">%</span><span class="p">;</span>
<span class="w">      </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="nt">input</span><span class="o">,</span><span class="w"> </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">toast</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">400</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">line-height</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">-200</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">animado</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">animation</span><span class="p">:</span><span class="w"> </span><span class="n">aparece</span><span class="w"> </span><span class="mi">10</span><span class="kt">s</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="k">keyframes</span><span class="w"> </span><span class="nt">aparece</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">0</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="nt">10</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="nt">90</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="nt">100</span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;!-- </span>
<span class="x">*** Es la página de inicio del sistema de login. Carga el formulario dinámicamente y permite la autenticación</span>
<span class="x">*** Funciones principales:</span>
<span class="x">* - Incluye sis_seguridad.php para validar el acceso seguro.</span>
<span class="x">* - Carga las traducciones desde include/idiomas.php.</span>
<span class="x">* - Genera dinámicamente el formulario con los textos en el idioma seleccionado.</span>
<span class="x">* - Incluye login.js con defer para que se ejecute después de cargar el DOM.</span>
<span class="x">--&gt;</span>


<span class="cp">&lt;?php</span> <span class="k">include</span> <span class="s2">&quot;inc/sis_seguridad.php&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span>

<span class="cp">&lt;?php</span> <span class="k">include</span> <span class="s2">&quot;include/idiomas.php&quot;</span><span class="p">;</span> <span class="cp">?&gt;</span>

<span class="x">&lt;!doctype html&gt;</span>
<span class="x">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="x">  &lt;head&gt;</span>
<span class="x">    &lt;title&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$idioma</span><span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">][</span><span class="s1">&#39;contenido&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span>
<span class="x">    &lt;/title&gt;</span>
<span class="x">    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
<span class="x">    &lt;link rel=&quot;stylesheet&quot; href=&quot;estilologin.css&quot;&gt;</span>
<span class="x">    &lt;script src=&quot;login.js&quot; defer&gt;&lt;/script&gt;</span>
<span class="x">  &lt;/head&gt;</span>
<span class="x">  &lt;body&gt;</span>
<span class="x">    &lt;div id=&quot;formlogin&quot;&gt;</span>
<span class="x">      &lt;img src=&quot;img/icono.png&quot; id=&quot;logo&quot;&gt;</span>
<span class="x">      &lt;input type=&quot;text&quot; id=&quot;usuario&quot; placeholder=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$idioma</span><span class="p">[</span><span class="s1">&#39;usuario&#39;</span><span class="p">][</span><span class="s1">&#39;contenido&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">      &lt;input type=&quot;text&quot; id=&quot;contrasena&quot; placeholder=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$idioma</span><span class="p">[</span><span class="s1">&#39;contrasena&#39;</span><span class="p">][</span><span class="s1">&#39;contenido&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">      &lt;button id=&quot;login&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$idioma</span><span class="p">[</span><span class="s1">&#39;login&#39;</span><span class="p">][</span><span class="s1">&#39;contenido&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/button&gt;</span>
<span class="x">      &lt;div id=&quot;comentario&quot;&gt;&lt;/div&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;div id=&quot;toast&quot;&gt;&lt;/div&gt;</span>
<span class="x">  &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</code></pre></div>

<h2>cliente\login.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * # Sistema de Login Dinámico</span>
<span class="cm"> *</span>
<span class="cm"> * ## Descripción:</span>
<span class="cm"> * Este script maneja el proceso de autenticación del usuario mediante un formulario dinámico.</span>
<span class="cm"> *</span>
<span class="cm"> * ## Funciones principales:</span>
<span class="cm"> * - Carga las traducciones según el idioma del navegador.</span>
<span class="cm"> * - Maneja eventos del formulario de login.</span>
<span class="cm"> * - Valida la entrada del usuario antes de enviarla al servidor.</span>
<span class="cm"> * - Autenticación del usuario con `fetch` enviando JSON.</span>
<span class="cm"> * - Muestra mensajes y errores en la interfaz.</span>
<span class="cm"> */</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Javascript cargado&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Seleccionar elementos del DOM</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">titulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#titulo&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">usuarioInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#usuario&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">contrasenaInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#contrasena&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">loginBtn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#login&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">comentario</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#comentario&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">toast</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#toast&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">usuarioInput</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">contrasenaInput</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">loginBtn</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error: No se encontraron los elementos del formulario.&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">cargarTraducciones</span><span class="p">();</span>

<span class="w">  </span><span class="nx">loginBtn</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">login</span><span class="p">);</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Carga las traducciones según el idioma del navegador.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">cargarTraducciones</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">idioma</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">navigator</span><span class="p">.</span><span class="nx">language</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mf">0</span><span class="p">];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`traductor/</span><span class="si">${</span><span class="nx">idioma</span><span class="si">}</span><span class="sb">.json`</span><span class="p">;</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">ok</span><span class="p">)</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="ne">Error</span><span class="p">(</span><span class="s2">&quot;Archivo de traducción no encontrado&quot;</span><span class="p">);</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">datos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Traducciones cargadas:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">titulo</span><span class="p">)</span><span class="w"> </span><span class="nx">titulo</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">titulo</span><span class="p">.</span><span class="nx">contenido</span><span class="p">;</span>
<span class="w">      </span><span class="nx">usuarioInput</span><span class="p">.</span><span class="nx">placeholder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">usuario</span><span class="p">.</span><span class="nx">contenido</span><span class="p">;</span>
<span class="w">      </span><span class="nx">contrasenaInput</span><span class="p">.</span><span class="nx">placeholder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">contrasena</span><span class="p">.</span><span class="nx">contenido</span><span class="p">;</span>
<span class="w">      </span><span class="nx">loginBtn</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">login</span><span class="p">.</span><span class="nx">contenido</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Error cargando traducciones:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Usar valores predeterminados en caso de error</span>
<span class="w">      </span><span class="nx">usuarioInput</span><span class="p">.</span><span class="nx">placeholder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Usuario&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">contrasenaInput</span><span class="p">.</span><span class="nx">placeholder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Contraseña&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">loginBtn</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Iniciar sesión&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Maneja el proceso de login.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">login</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Has pulsado el botón&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">usuario</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">usuarioInput</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">contrasena</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">contrasenaInput</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">usuario</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">contrasena</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">mostrarMensaje</span><span class="p">(</span><span class="s2">&quot;Por favor, completa todos los campos.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">datos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">usuario</span><span class="p">,</span><span class="w"> </span><span class="nx">contrasena</span><span class="w"> </span><span class="p">};</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../servidor/?o=buscar&amp;tabla=usuarios&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">datos</span><span class="p">),</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Respuesta del servidor:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>

<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">nombreCompleto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">data</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">nombre</span><span class="si">}</span><span class="sb"> </span><span class="si">${</span><span class="nx">data</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">apellidos</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>

<span class="w">        </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">&quot;nombre_usuario&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">nombreCompleto</span><span class="p">);</span>
<span class="w">        </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">&quot;crismon1_token&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">token</span><span class="p">);</span>
<span class="w">        </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s2">&quot;crismon1_usuario&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">[</span><span class="mf">0</span><span class="p">].</span><span class="nx">usuario</span><span class="p">);</span>

<span class="w">        </span><span class="nx">mostrarMensaje</span><span class="p">(</span><span class="s2">&quot;Acceso correcto. Redirigiendo en 5 segundos...&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;green&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;escritorio/index.html&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">5000</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mostrarMensaje</span><span class="p">(</span><span class="s2">&quot;Usuario incorrecto. Redirigiendo en 5 segundos...&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;red&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="nx">setTimeout</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">reload</span><span class="p">();</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span><span class="mf">5000</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">mostrarToast</span><span class="p">(</span><span class="s2">&quot;Error en acceso. Inténtalo de nuevo más tarde.&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">warn</span><span class="p">(</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Muestra un mensaje en la página.</span>
<span class="cm">   * @param {string} texto - Texto del mensaje.</span>
<span class="cm">   * @param {string} color - Color del texto.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">mostrarMensaje</span><span class="p">(</span><span class="nx">texto</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">comentario</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">comentario</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">;</span>
<span class="w">      </span><span class="nx">comentario</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">texto</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Muestra un mensaje de error en un toast.</span>
<span class="cm">   * @param {string} mensaje - Mensaje a mostrar.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">mostrarToast</span><span class="p">(</span><span class="nx">mensaje</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">toast</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">toast</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">toast</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;animado&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">toast</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mensaje</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<h2>cliente\analisis\cosigo.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/*</span>
<span class="cm">*    Se encarga de obtener la lista de tablas desde el servidor.</span>
<span class="cm">*    Permite seleccionar las columnas que se desean consultar.</span>
<span class="cm">*    Realiza la consulta a la base de datos a través de una solicitud fetch.</span>
<span class="cm">*    Muestra los resultados en una tabla dentro del &lt;div class=&quot;resultados&quot;&gt;.</span>
<span class="cm">*    Proporciona funciones para descargar los resultados en CSV y PDF.</span>
<span class="cm">*/</span>

<span class="c1">/////////////////////// FUNCIONES PARA LISTAR LAS TABLAS  /////////////////////////////</span>

<span class="cm">/*Obtiene la lista de tablas desde el servidor*/</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">obtenerTablas</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=listatablas&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Tablas recibidas:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">data</span><span class="p">);</span>
<span class="w">        </span><span class="nx">renderizarOpcionesTablas</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al obtener las tablas:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Rellena el elemento select con las opciones de tablas.</span>
<span class="cm">   * @param {Array} tablas - Array con la información de las tablas.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">renderizarOpcionesTablas</span><span class="p">(</span><span class="nx">tablas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">selectTablas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#tablas&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Reiniciamos el select con la opción por defecto.</span>
<span class="w">    </span><span class="nx">selectTablas</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;option value=&quot;&quot;&gt;Selecciona una tabla&lt;/option&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">tablas</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">tablaObj</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">nombreTabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tablaObj</span><span class="p">.</span><span class="nx">Tables_in_crismon1</span><span class="p">;</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">opcion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nombreTabla</span><span class="p">;</span>
<span class="w">      </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nombreTabla</span><span class="p">;</span>
<span class="w">      </span><span class="nx">selectTablas</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">opcion</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>


<span class="w">  </span><span class="c1">////////////////////////// FUNCIONES PARA OBTENER Y MOSTRAR LAS COLUMNAS DE LA TABLA /////////////////////////////</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Obtiene las columnas de la tabla seleccionada.</span>
<span class="cm">   * @param {string} nombreTabla - Nombre de la tabla.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">obtenerColumnas</span><span class="p">(</span><span class="nx">nombreTabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`../../servidor/?o=columnastabla&amp;tabla=</span><span class="si">${</span><span class="nx">nombreTabla</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">renderizarColumnas</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al obtener las columnas de la tabla:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">)</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Muestra los checkboxes correspondientes a cada columna.</span>
<span class="cm">   * @param {Array} columnas - Array con las columnas.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">renderizarColumnas</span><span class="p">(</span><span class="nx">columnas</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">contenedor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#campotabla&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Limpiar el contenedor antes de agregar</span>
<span class="w">    </span><span class="nx">columnas</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">columna</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">etiqueta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;label&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">etiqueta</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">columna</span><span class="p">.</span><span class="nx">Field</span><span class="p">;</span>

<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">checkbox</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">checkbox</span><span class="p">.</span><span class="nx">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;checkbox&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">checkbox</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">columna</span><span class="p">.</span><span class="nx">Field</span><span class="p">;</span>
<span class="w">      </span><span class="nx">checkbox</span><span class="p">.</span><span class="nx">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;campos&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">checkbox</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`checkbox-</span><span class="si">${</span><span class="nx">columna</span><span class="p">.</span><span class="nx">Field</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>

<span class="w">      </span><span class="nx">etiqueta</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">checkbox</span><span class="p">);</span>
<span class="w">      </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">etiqueta</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span>


<span class="w">  </span><span class="c1">/////////////// FUNCIONES PARA REALIZAR LA BÚSQUEDA Y MOSTRAR RESULTADOS ////////////////////////////</span>

<span class="w">  </span><span class="cm">/* Realiza la búsqueda de datos en base a la tabla y campos seleccionados */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">realizarBusqueda</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tablaSeleccionada</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#tablas&quot;</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">checkboxesSeleccionados</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;#campotabla input:checked&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">camposSeleccionados</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">checkboxesSeleccionados</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">cb</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">cb</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Validar que se haya seleccionado al menos un campo</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">camposSeleccionados</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Por favor, selecciona al menos un campo para la búsqueda.&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">datosEnvio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">campos</span><span class="o">:</span><span class="w"> </span><span class="nx">camposSeleccionados</span><span class="w"> </span><span class="p">};</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Datos a enviar:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datosEnvio</span><span class="p">);</span>

<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`../../servidor/?o=buscarseleccion&amp;tabla=</span><span class="si">${</span><span class="nx">tablaSeleccionada</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">datosEnvio</span><span class="p">)</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">resultados</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">renderizarResultadosBusqueda</span><span class="p">(</span><span class="nx">resultados</span><span class="p">,</span><span class="w"> </span><span class="nx">camposSeleccionados</span><span class="p">);</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error en la búsqueda:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Muestra los resultados de la búsqueda en una tabla y añade opciones de descarga.</span>
<span class="cm">   * @param {Array} resultados - Array de objetos con los resultados.</span>
<span class="cm">   * @param {Array} camposSeleccionados - Campos que se muestran.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">renderizarResultadosBusqueda</span><span class="p">(</span><span class="nx">resultados</span><span class="p">,</span><span class="w"> </span><span class="nx">camposSeleccionados</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">contenedorResultados</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.resultados&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedorResultados</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;h2&gt;Resultados de la Búsqueda&lt;/h2&gt;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">resultados</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Crear la tabla de resultados</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">tablaResultados</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">tablaResultados</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;tablaResultados&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// ID para identificar la tabla</span>

<span class="w">      </span><span class="c1">// Crear encabezado de la tabla</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">filaEncabezado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">camposSeleccionados</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">campo</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">th</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">th</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">campo</span><span class="p">;</span>
<span class="w">        </span><span class="nx">filaEncabezado</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">th</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="nx">tablaResultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">filaEncabezado</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Crear filas con los datos</span>
<span class="w">      </span><span class="nx">resultados</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">fila</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">const</span><span class="w"> </span><span class="nx">tr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">camposSeleccionados</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">campo</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="kd">const</span><span class="w"> </span><span class="nx">td</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">          </span><span class="nx">td</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fila</span><span class="p">[</span><span class="nx">campo</span><span class="p">];</span>
<span class="w">          </span><span class="nx">tr</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">td</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">        </span><span class="nx">tablaResultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tr</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>

<span class="w">      </span><span class="nx">contenedorResultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tablaResultados</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// Crear opciones de descarga (CSV y PDF)</span>
<span class="w">      </span><span class="nx">crearOpcionesDescarga</span><span class="p">();</span>

<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">contenedorResultados</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s2">&quot;&lt;p&gt;No se encontraron resultados.&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="c1">// Limpiar contenedor de descargas si no hay resultados</span>
<span class="w">      </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#descargas&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>


<span class="w">  </span><span class="c1">////////////////// FUNCIONES PARA DESCARGAR RESULTADOS (CSV Y PDF) //////////////////////////////</span>

<span class="w">  </span><span class="cm">/*Descarga los resultados mostrados en la tabla en formato CSV */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">descargarCSV</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#tablaResultados&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;No hay resultados para descargar.&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">csv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">filas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nx">filas</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">fila</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">columnas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fila</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;th, td&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">filaDatos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">      </span><span class="nx">columnas</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">columna</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">texto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">columna</span><span class="p">.</span><span class="nx">innerText</span><span class="p">;</span>
<span class="w">        </span><span class="nx">texto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&quot;/g</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&quot;&quot;&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Escapar comillas dobles</span>
<span class="w">        </span><span class="nx">filaDatos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="sb">`&quot;</span><span class="si">${</span><span class="nx">texto</span><span class="si">}</span><span class="sb">&quot;`</span><span class="p">);</span>
<span class="w">      </span><span class="p">});</span>
<span class="w">      </span><span class="nx">csv</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">filaDatos</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">contenidoCSV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">csv</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;\n&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">blob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">Blob</span><span class="p">([</span><span class="nx">contenidoCSV</span><span class="p">],</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;text/csv;charset=utf-8;&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">URL</span><span class="p">.</span><span class="nx">createObjectURL</span><span class="p">(</span><span class="nx">blob</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">enlace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">enlace</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">url</span><span class="p">);</span>
<span class="w">    </span><span class="nx">enlace</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;download&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;resultados.csv&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">enlace</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">enlace</span><span class="p">);</span>
<span class="w">    </span><span class="nx">enlace</span><span class="p">.</span><span class="nx">click</span><span class="p">();</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">enlace</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Descarga los resultados mostrados en la tabla en formato PDF.</span>
<span class="cm">   * Requiere que jsPDF y autoTable estén incluidos en tu proyecto.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">descargarPDF</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#tablaResultados&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;No hay resultados para descargar.&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">jsPDF</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// Usamos autoTable para convertir la tabla a PDF</span>
<span class="w">    </span><span class="nx">doc</span><span class="p">.</span><span class="nx">autoTable</span><span class="p">({</span><span class="w"> </span><span class="nx">html</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;#tablaResultados&quot;</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="nx">doc</span><span class="p">.</span><span class="nx">save</span><span class="p">(</span><span class="s2">&quot;resultados.pdf&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="cm">/**</span>
<span class="cm">   * Crea los botones de descarga (CSV y PDF) y los agrega al contenedor de descargas.</span>
<span class="cm">   */</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">crearOpcionesDescarga</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">contenedorDescargas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#descargas&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedorDescargas</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Limpiar el contenedor</span>

<span class="w">    </span><span class="c1">// Botón para descargar CSV</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">botonCSV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">botonCSV</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Descargar CSV&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">botonCSV</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;boton-descarga&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">botonCSV</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">descargarCSV</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Botón para descargar PDF</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">botonPDF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">botonPDF</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Descargar PDF&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">botonPDF</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;boton-descarga&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">botonPDF</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">descargarPDF</span><span class="p">);</span>

<span class="w">    </span><span class="nx">contenedorDescargas</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">botonCSV</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedorDescargas</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">botonPDF</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>


<span class="w">  </span><span class="c1">/////////////////////// INICIALIZACIÓN Y ASIGNACIÓN DE EVENTOS  ////////////////////////////</span>

<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;DOMContentLoaded&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Cargar las tablas al iniciar la página</span>
<span class="w">    </span><span class="nx">obtenerTablas</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// Cuando se cambia la tabla seleccionada, cargar sus columnas</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#tablas&quot;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">nombreTabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">nombreTabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">obtenerColumnas</span><span class="p">(</span><span class="nx">nombreTabla</span><span class="p">);</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#campotabla&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Asignar el evento al botón de búsqueda</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#buscarBtn&quot;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">realizarBusqueda</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
</code></pre></div>

<h2>cliente\analisis\estilo.css</h2>
<div class="codehilite"><pre><span></span><code><span class="o">*</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">html</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/*********************** ESTILOS PARA EL CONTENEDOR **********************/</span>
<span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">flex-start</span><span class="p">;</span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">1200</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/* Ajuste para pantallas grandes */</span>
<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="o">(</span><span class="nt">min-width</span><span class="o">:</span><span class="w"> </span><span class="nt">1025px</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">row</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">flex-start</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">seleccion</span><span class="o">,</span><span class="w"> </span>
<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">45</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c">/* Añadir margen entre selección y resultados */</span>
<span class="w">    </span><span class="p">#</span><span class="nn">buscarBtn</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">align-self</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c">/* Estilo para la sección de selección */</span>
<span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">seleccion</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">    </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para la sección de resultados */</span>
<span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del iframe dentro de los resultados */</span>
<span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="nt">iframe</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">vh</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/*********************** ESTILOS PARA EL SELECT **********************/</span>
<span class="p">#</span><span class="nn">tablas</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="kc">all</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease-in-out</span><span class="p">;</span>
<span class="w">    </span><span class="k">outline</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Efecto al pasar el mouse sobre el select */</span>
<span class="p">#</span><span class="nn">tablas</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f5f5f5</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para las opciones */</span>
<span class="p">#</span><span class="nn">tablas</span><span class="w"> </span><span class="nt">option</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#ddd</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo al seleccionar una opción */</span>
<span class="p">#</span><span class="nn">tablas</span><span class="w"> </span><span class="nt">option</span><span class="p">:</span><span class="nd">checked</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/*********************** ESTILOS PARA LOS CAMPOS **********************/</span>
<span class="p">#</span><span class="nn">campotabla</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="k">grid</span><span class="p">;</span>
<span class="w">    </span><span class="k">grid-template-columns</span><span class="p">:</span><span class="w"> </span><span class="nf">repeat</span><span class="p">(</span><span class="kc">auto</span><span class="nv">-fill</span><span class="p">,</span><span class="w"> </span><span class="nf">minmax</span><span class="p">(</span><span class="mi">200</span><span class="kt">px</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">fr</span><span class="p">));</span><span class="w"> </span>
<span class="w">    </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para los labels y checkboxes */</span>
<span class="p">#</span><span class="nn">campotabla</span><span class="w"> </span><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">campotabla</span><span class="w"> </span><span class="nt">label</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#e0f0f0</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">campotabla</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.2</span><span class="p">);</span>
<span class="w">    </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">accent-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/*********************** ESTILOS PARA EL BOTÓN **********************/</span>
<span class="c">/* Estilo del botón Mostrar Resultados */</span>
<span class="p">#</span><span class="nn">buscarBtn</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="mi">24</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">align-self</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">buscarBtn</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#3b6a80</span><span class="p">;</span><span class="w"> </span><span class="c">/* Cambio de color de fondo */</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translateY</span><span class="p">(</span><span class="mi">-2</span><span class="kt">px</span><span class="p">);</span><span class="w"> </span><span class="c">/* Efecto de elevación */</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra */</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">buscarBtn</span><span class="p">:</span><span class="nd">active</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#2f5570</span><span class="p">;</span><span class="w"> </span><span class="c">/* Cambio de color de fondo al hacer clic */</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translateY</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="c">/* Revertir la elevación */</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra reducida */</span>
<span class="p">}</span>

<span class="c">/*********************** ESTILOS DE LOS RESULTADOS **********************/</span>
<span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">table</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span><span class="c">/* Ancho completo */</span>
<span class="w">    </span><span class="k">border-collapse</span><span class="p">:</span><span class="w"> </span><span class="kc">collapse</span><span class="p">;</span><span class="w"> </span><span class="c">/* Eliminar espacios entre bordes */</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado superior */</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra alrededor de la tabla */</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Bordes redondeados */</span>
<span class="w">    </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span><span class="w"> </span><span class="c">/* Ocultar desbordamientos */</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">th</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color de fondo de los encabezados */</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color del texto de los encabezados */</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado interno */</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">left</span><span class="p">;</span><span class="w"> </span><span class="c">/* Alineación del texto */</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span><span class="w"> </span><span class="c">/* Tamaño de fuente */</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">td</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#dddddd</span><span class="p">;</span><span class="w"> </span><span class="c">/* Línea divisoria */</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado interno */</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.95</span><span class="kt">rem</span><span class="p">;</span><span class="w"> </span><span class="c">/* Tamaño de fuente */</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333333</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color del texto */</span>
<span class="p">}</span>
<span class="c">/* Color de fondo para filas pares */</span>
<span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">nth-child</span><span class="o">(</span><span class="nt">even</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f9f9f9</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f1f1f1</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">h2</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="kt">rem</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/*********************** ESTILOS RESPONSIVE **********************/</span>
<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="o">(</span><span class="nt">max-width</span><span class="o">:</span><span class="w"> </span><span class="nt">1024px</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">        </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">seleccion</span><span class="o">,</span><span class="w"> </span>
<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c">/* Ajustar el botón para pantallas medianas */</span>
<span class="w">    </span><span class="p">#</span><span class="nn">buscarBtn</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">align-self</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">        </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c">/* Para móviles */</span>
<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="o">(</span><span class="nt">max-width</span><span class="o">:</span><span class="w"> </span><span class="nt">768px</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">        </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">seleccion</span><span class="o">,</span><span class="w"> </span>
<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">contenedor</span><span class="w"> </span><span class="nt">iframe</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="kt">vh</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">tablas</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">        </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">campotabla</span><span class="w"> </span><span class="nt">label</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">        </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">#</span><span class="nn">campotabla</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;checkbox&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
<span class="w">        </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c">/* Ajustes para el botón en móviles */</span>
<span class="w">    </span><span class="p">#</span><span class="nn">buscarBtn</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c">/* Ajustes para la tabla en móviles */</span>
<span class="w">    </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">table</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">th</span><span class="o">,</span><span class="w"> </span><span class="p">.</span><span class="nc">resultados</span><span class="w"> </span><span class="nt">td</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">descargas</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w">  </span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w">    </span>
<span class="w">    </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w">                </span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w">        </span>
<span class="p">}</span>
<span class="c">/* Botones de descarga (CSV y PDF) */</span>
<span class="p">.</span><span class="nc">boton-descarga</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#fff</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton-descarga</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#3b6a80</span><span class="p">;</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translateY</span><span class="p">(</span><span class="mi">-2</span><span class="kt">px</span><span class="p">);</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton-descarga</span><span class="p">:</span><span class="nd">active</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#2f5570</span><span class="p">;</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translateY</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\analisis\index.html</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;../analisis/estilo.css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Búsqueda de Datos<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;contenedor&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;seleccion&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;tablas&quot;</span><span class="p">&gt;</span>Selecciona una tabla:<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">select</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;tablas&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;&quot;</span><span class="p">&gt;</span>Selecciona una tabla<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
                <span class="cm">&lt;!-- Opciones dinámicas --&gt;</span>
            <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Selecciona los campos:<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;campotabla&quot;</span><span class="p">&gt;</span>
                <span class="cm">&lt;!-- Checkboxes generados dinámicamente --&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- Mover el botón dentro del contenedor .seleccion --&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;buscarBtn&quot;</span><span class="p">&gt;</span>Mostrar Resultados<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;resultados&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;resultados&quot;</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- Resultados de la búsqueda --&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;descargas&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;descargas&quot;</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- Botones de descarga CSV y PDF se agregarán aquí --&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf.plugin.autotable.min.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>    
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;../analisis/cosigo.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<h2>cliente\escritorio\comportamiento.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * # Sistema de Validación y Carga Dinámica de Aplicaciones</span>
<span class="cm"> * </span>
<span class="cm"> * ## Descripción:</span>
<span class="cm"> * Este script maneja la autenticación del usuario, validación de tokens y </span>
<span class="cm"> * carga dinámica de las aplicaciones disponibles para el usuario autenticado.</span>
<span class="cm"> * </span>
<span class="cm"> * ## Funcionalidades principales:</span>
<span class="cm"> * - Verificación del usuario y token en `localStorage`.</span>
<span class="cm"> * - Validación del token con el servidor (`fetch` a `compruebatoken`).</span>
<span class="cm"> * - Carga de las aplicaciones disponibles desde el servidor.</span>
<span class="cm"> * - Renderizado dinámico de las aplicaciones en la interfaz.</span>
<span class="cm"> * - Manejo de eventos `onclick` en los elementos generados.</span>
<span class="cm"> * - Cierre de sesión eliminando credenciales del `localStorage`.</span>
<span class="cm"> */</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>

<span class="w">      </span><span class="cm">/**</span>
<span class="cm">     * ## Validación del Usuario y Token</span>
<span class="cm">     * Se verifica si existen en `localStorage`. </span>
<span class="cm">     * Si no existen, redirige a la página de inicio.</span>
<span class="cm">     */</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">usuario</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&quot;crismon1_usuario&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">usuario</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">){</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&quot;crismon1_token&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">token</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">undefined</span><span class="p">){</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../&quot;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * ## Verificación del Token con el Servidor</span>
<span class="cm">     * Realiza una solicitud `fetch` al servidor para comprobar si el token es válido.</span>
<span class="cm">     * Si no es válido, redirige al usuario a la página de inicio.</span>
<span class="cm">    */</span>

<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=compruebatoken&amp;token=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">token</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">resultado</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;ok&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Token válido</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error en la validación del token:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * ## Carga de Aplicaciones del Usuario</span>
<span class="cm">     * Se solicita al servidor la lista de aplicaciones disponibles para el usuario autenticado.</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=listadoaplicacionesusuario&amp;usuario=&quot;</span><span class="o">+</span><span class="nx">usuario</span><span class="p">)</span><span class="w">         </span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Quiero que el servidor me devuelva un json</span>
<span class="w">          </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span><span class="w">                       </span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Cargo el template HTML como una plantilla en memoria (como un class)</span>
<span class="w">            </span><span class="kd">const</span><span class="w"> </span><span class="nx">plantilla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;plantilla_aplicacion&#39;</span><span class="p">);</span><span class="w">     </span>
<span class="w">            </span><span class="c1">// Vomito el json en pantalla         </span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span><span class="w">                                                   </span>
<span class="w">            </span><span class="c1">// Para cada uno de los elementos que vienen en el json de la base de datos            </span>
<span class="w">            </span><span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">elemento</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span>
<span class="w">                </span><span class="c1">// Pongo el elemento en pantalla simplemente para comprobar que funciona                                           </span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">elemento</span><span class="p">);</span><span class="w">        </span>
<span class="w">                </span><span class="c1">// Creo  una nueva instancia de la clase (como un instancia)                                              </span>
<span class="w">                </span><span class="kd">const</span><span class="w"> </span><span class="nx">instancia</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">plantilla</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w"> </span>
<span class="w">                </span><span class="c1">// Dentro de la plantilla selecciono a uno de los elementos                       </span>
<span class="w">                </span><span class="kd">const</span><span class="w"> </span><span class="nx">nombre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">instancia</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">);</span><span class="w">                                </span>
<span class="w">                </span><span class="c1">// Y le pongo el contenido que saco del json</span>
<span class="w">                </span><span class="nx">nombre</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">nombre</span><span class="p">;</span><span class="w"> </span>

<span class="w">                </span><span class="kd">const</span><span class="w"> </span><span class="nx">imagen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">instancia</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;img&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="nx">imagen</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="s2">&quot;img/&quot;</span><span class="o">+</span><span class="nx">elemento</span><span class="p">.</span><span class="nx">icono</span><span class="p">)</span>
<span class="w">                </span><span class="c1">// Por ultimo realmente pongo la instancia en el arbol html</span>
<span class="w">                </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">instancia</span><span class="p">);</span><span class="w">                      </span>
<span class="w">            </span><span class="p">});</span>
<span class="w">            </span><span class="c1">// Selecciono todas las aplicaciones y las pongo en un array</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">aplicaciones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.aplicacion&quot;</span><span class="p">)</span><span class="w">                     </span>
<span class="w">            </span><span class="c1">// Para cada una de las aplicaciones</span>
<span class="w">            </span><span class="nx">aplicaciones</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">aplicacion</span><span class="p">){</span><span class="w">   </span>
<span class="w">                </span><span class="c1">// Cuando haga click en esa aplicacion                                   </span>
<span class="w">                </span><span class="nx">aplicacion</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span><span class="w">   </span>

<span class="w">                    </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;crismon1_aplicacion&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="p">);</span><span class="w">                                        </span>
<span class="w">                    </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../supercontrolador/&quot;</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="cm">/**</span>
<span class="cm">         * ## Cierre de Sesión</span>
<span class="cm">         * Cuando el usuario presiona el botón de cerrar sesión, se eliminan los </span>
<span class="cm">         * datos del usuario y el token de `localStorage` y se redirige a la página de inicio.</span>
<span class="cm">        */</span>
<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#cerrar&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">            </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s2">&quot;crismon1_usuario&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s2">&quot;crismon1_token&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\escritorio\estilo.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* Estilo global */</span>
<span class="nt">html</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo general verde claro */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#91bcce</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto principal en azul oscuro */</span>
<span class="p">}</span>

<span class="c">/* Estilo del header */</span>
<span class="nt">header</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#d2e5e5</span><span class="p">;</span><span class="w"> </span><span class="c">/* Verde azulado medio */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto en azul claro */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">2.5</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Línea azul oscuro */</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra sutil */</span>
<span class="p">}</span>

<span class="c">/* Contenedor Principal (Main) */</span>
<span class="nt">main</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="k">grid</span><span class="p">;</span>
<span class="w">  </span><span class="k">grid-template-columns</span><span class="p">:</span><span class="w"> </span><span class="nf">repeat</span><span class="p">(</span><span class="kc">auto</span><span class="nv">-fit</span><span class="p">,</span><span class="w"> </span><span class="nf">minmax</span><span class="p">(</span><span class="mi">250</span><span class="kt">px</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">fr</span><span class="p">));</span>
<span class="w">  </span><span class="k">grid-auto-rows</span><span class="p">:</span><span class="w"> </span><span class="nb">calc</span><span class="p">(</span><span class="mi">200</span><span class="kt">px</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform-style</span><span class="p">:</span><span class="w"> </span><span class="kc">preserve-3d</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para las Tarjetas (Aplicaciones) */</span>
<span class="p">.</span><span class="nc">aplicacion</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span><span class="w"> </span><span class="c">/* Borde sutil */</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span><span class="w"> </span><span class="c">/* Para alinear imagen y texto */</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-size</span><span class="p">:</span><span class="w"> </span><span class="kc">cover</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-position</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span><span class="w"> </span><span class="c">/* Mayor opacidad para mejor visibilidad */</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">opacity</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#a8afaf</span><span class="p">;</span><span class="w"> </span><span class="c">/* Verde azulado medio */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto en azul claro */</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">relative</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Esquinas más redondeadas */</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra ligera */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espacio interno */</span>
<span class="p">}</span>

<span class="c">/* Efecto hover en las tarjetas */</span>
<span class="p">.</span><span class="nc">aplicacion</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c">/* Total visibilidad al hacer hover */</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.05</span><span class="p">);</span><span class="w"> </span><span class="c">/* Leve aumento al hacer hover */</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra más pronunciada */</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Cambia a azul oscuro en hover */</span>
<span class="p">}</span>

<span class="c">/* Estilo para la imagen dentro de las tarjetas */</span>
<span class="p">.</span><span class="nc">aplicacion</span><span class="w"> </span><span class="nt">img</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Tamaño del icono */</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espacio entre la imagen y el texto */</span>
<span class="p">}</span>

<span class="c">/* Texto en las tarjetas */</span>
<span class="p">.</span><span class="nc">aplicacion</span><span class="w"> </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Responsividad para pantallas más pequeñas */</span>
<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="o">(</span><span class="nt">max-width</span><span class="o">:</span><span class="w"> </span><span class="nt">600px</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">main</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">grid-template-columns</span><span class="p">:</span><span class="w"> </span><span class="nf">repeat</span><span class="p">(</span><span class="kc">auto</span><span class="nv">-fit</span><span class="p">,</span><span class="w"> </span><span class="nf">minmax</span><span class="p">(</span><span class="mi">150</span><span class="kt">px</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="n">fr</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>


<span class="p">#</span><span class="nn">cerrar</span><span class="p">{</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">right</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\escritorio\index.html</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Crimson ERP<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;estilo.css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;comportamiento.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;../supercontrolador/js/polyfill-browser.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- </span>
<span class="cm">      # Página Principal de Crimson ERP</span>

<span class="cm">      ## Descripción:</span>
<span class="cm">      Esta página representa la interfaz principal de **Crimson ERP**, donde se cargan las aplicaciones </span>
<span class="cm">      disponibles para el usuario. </span>

<span class="cm">      ## Funcionalidades:</span>
<span class="cm">      - Muestra el logo del sistema en la cabecera.</span>
<span class="cm">      - Permite cerrar sesión mediante el botón de `cerrar_sesion.png`.</span>
<span class="cm">      - Renderiza dinámicamente las aplicaciones disponibles en el `main` mediante `plantilla_aplicacion`.</span>
<span class="cm">      - Incluye `comportamiento.js` que gestiona la carga de datos y eventos.</span>
<span class="cm">      - Carga un **polyfill** para mejorar compatibilidad con navegadores antiguos.</span>

<span class="cm">      ## Estructura:</span>
<span class="cm">      - **Header**: Contiene el logo de Crimson ERP.</span>
<span class="cm">      - **Botón de Cerrar Sesión**: Imagen que permite cerrar la sesión del usuario.</span>
<span class="cm">      - **Main**: Sección donde se cargarán dinámicamente las aplicaciones disponibles.</span>
<span class="cm">      - **Template**: Plantilla de una aplicación para clonarla y agregarla dinámicamente.</span>

<span class="cm">    --&gt;</span>
    <span class="p">&lt;</span><span class="nt">header</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;img/logo.png&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;logologin&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">header</span><span class="p">&gt;</span>
    <span class="cm">&lt;!-- Contenedor principal donde se renderizarán las aplicaciones --&gt;</span>
    <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;img/cerrar_sesion.png&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;cerrar&quot;</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">main</span><span class="p">&gt;&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>
    <span class="cm">&lt;!-- </span>
<span class="cm">      ## Plantilla de Aplicación</span>
<span class="cm">      Este template se usará para generar dinámicamente las aplicaciones en la interfaz.</span>
<span class="cm">      - La imagen representa el icono de la aplicación.</span>
<span class="cm">      - El `&lt;p&gt;` contendrá el nombre de la aplicación.</span>
<span class="cm">    --&gt;</span>
    <span class="p">&lt;</span><span class="nt">template</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;plantilla_aplicacion&quot;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;aplicacion&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;img/icono.png&quot;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Plantilla<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<h2>cliente\inc\geolocalizacion.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ##  Descripción:</span>
<span class="sd"> * Este archivo se encarga de la **verificación geográfica** de los accesos al sistema. </span>
<span class="sd"> * Utiliza tanto la base de datos local como una API externa para obtener la ubicación </span>
<span class="sd"> * geográfica de una dirección IP y determinar si el acceso está permitido.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Funciones Principales:</span>
<span class="sd"> * - Obtiene el país de una IP desde la base de datos y, si no existe, consulta una API externa.</span>
<span class="sd"> * - Devuelve `true` si la IP pertenece a España (`&#39;ES&#39;`), `false` en caso contrario.</span>
<span class="sd"> *</span>
<span class="sd"> * ##  Notas:</span>
<span class="sd"> * - **Uso de API Externa:** Si la IP no está registrada en la base de datos, se realiza una consulta a `ip-api.com` para obtener la ubicación.</span>
<span class="sd"> * - **Optimización:** Se guarda la información en la base de datos para evitar consultas repetitivas a la API.</span>
<span class="sd"> * - **Seguridad:** Evita accesos no autorizados restringiendo el acceso únicamente a IPs españolas.</span>
<span class="sd"> */</span>


<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/sis_seguridad.php&quot;</span><span class="p">;</span> 

<span class="k">function</span> <span class="nf">obtenerPaisPorIP</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT pais FROM ips_control WHERE ip = ?&quot;</span><span class="p">);</span>
    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">);</span>
    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="nv">$resultado</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">get_result</span><span class="p">();</span>
    <span class="nv">$pais</span> <span class="o">=</span> <span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">()[</span><span class="s1">&#39;pais&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="k">null</span><span class="p">;</span>

    <span class="c1">// Si la IP no está en la base, usar API</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$pais</span> <span class="o">||</span> <span class="nv">$pais</span> <span class="o">===</span> <span class="s2">&quot;Desconocido&quot;</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$pais</span> <span class="o">=</span> <span class="nx">obtenerPaisDesdeAPI</span><span class="p">(</span><span class="nv">$ip</span><span class="p">);</span>
        <span class="c1">// Guardar en la base de datos para futuras consultas</span>
        <span class="nv">$query_update</span> <span class="o">=</span> <span class="s2">&quot;UPDATE ips_control SET pais = ? WHERE ip = ?&quot;</span><span class="p">;</span>
        <span class="nv">$stmt_update</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$query_update</span><span class="p">);</span>
        <span class="nv">$stmt_update</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;ss&quot;</span><span class="p">,</span> <span class="nv">$pais</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">);</span>
        <span class="nv">$stmt_update</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="nv">$pais</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">esIpDeEspaña</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">obtenerPaisPorIP</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;ES&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>cliente\inc\sis_seguridad.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo es el **núcleo del sistema de seguridad** del proyecto. </span>
<span class="sd"> * Se encarga de verificar y restringir el acceso al sistema basándose en:</span>
<span class="sd"> * - **Lista negra de IPs** (bloqueo de direcciones IP no autorizadas).</span>
<span class="sd"> * - **Restricción de navegadores** (impide el acceso desde navegadores no permitidos).</span>
<span class="sd"> * - **Ubicación geográfica** (permite solo accesos desde España).</span>
<span class="sd"> * - **Registro de accesos** (almacena la información de cada intento de conexión).</span>
<span class="sd"> *</span>
<span class="sd"> * ## Notas:</span>
<span class="sd"> * - Se requiere `conexionDB.php` para la conexión a la base de datos.</span>
<span class="sd"> * - Usa `ips_control.php` para manejar la gestión de direcciones IP.</span>
<span class="sd"> * - Utiliza `verificar_ip.php`, `verificar_navegador.php` y `geolocalizacion.php` para controles específicos.</span>
<span class="sd"> */</span>


<span class="nb">session_start</span><span class="p">();</span> <span class="c1">//Iniciar sesión para evitar bucles infinitos</span>

<span class="c1">//Incluir los archivos con funciones de seguridad</span>
<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/../../servidor/conexionDB.php&quot;</span><span class="p">;</span>
<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/../../servidor/lib/ips_control.php&quot;</span><span class="p">;</span> <span class="c1">// Ahora se encarga del registro automático de IPs</span>
<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/verificar_ip.php&quot;</span><span class="p">;</span>
<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/verificar_navegador.php&quot;</span><span class="p">;</span>
<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/geolocalizacion.php&quot;</span><span class="p">;</span>

<span class="c1">// ✅ Función para mostrar errores con diferentes colores de fondo</span>
<span class="k">function</span> <span class="nf">mostrarError</span><span class="p">(</span><span class="nv">$titulo</span><span class="p">,</span> <span class="nv">$mensaje</span><span class="p">,</span> <span class="nv">$colorFondo</span> <span class="o">=</span> <span class="s1">&#39;#f8d7da&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;</span>
<span class="s2">        &lt;style&gt;</span>
<span class="s2">            body { font-family: Arial, sans-serif; text-align: center; padding: 50px; background-color: white; }</span>
<span class="s2">            h1 { color: black; }</span>
<span class="s2">            p { color: black; font-size: 18px; }</span>
<span class="s2">            .container { border: 2px solid white; background: </span><span class="si">$colorFondo</span><span class="s2">; padding: 20px; display: inline-block; border-radius: 10px; }</span>
<span class="s2">        &lt;/style&gt;</span>
<span class="s2">        &lt;div class=&#39;container&#39;&gt;</span>
<span class="s2">            &lt;h1&gt;</span><span class="si">$titulo</span><span class="s2">&lt;/h1&gt;</span>
<span class="s2">            &lt;p&gt;</span><span class="si">$mensaje</span><span class="s2">&lt;/p&gt;</span>
<span class="s2">        &lt;/div&gt;</span>
<span class="s2">    &quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nv">$conexion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">conexionDB</span><span class="p">();</span>
<span class="nv">$direccionIP</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_X_FORWARDED_FOR&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">];</span>

<span class="c1">// Registrar acceso automáticamente</span>
<span class="nx">registrarAcceso</span><span class="p">(</span><span class="nv">$direccionIP</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">);</span>

<span class="c1">// Evitar doble verificación si el usuario ya está autenticado</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;usuario_verificado&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;usuario_verificado&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="k">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Verificar si la IP está en lista negra</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">ipEnLista</span><span class="p">(</span><span class="nv">$direccionIP</span><span class="p">,</span> <span class="s1">&#39;negra&#39;</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">mostrarError</span><span class="p">(</span><span class="s2">&quot;🚫 Acceso Denegado&quot;</span><span class="p">,</span> <span class="s2">&quot;Tu IP (</span><span class="si">$direccionIP</span><span class="s2">) ha sido bloqueada.&quot;</span><span class="p">,</span> <span class="s2">&quot;#f8d7da&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Verificar si el navegador está prohibido</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">navegadorProhibido</span><span class="p">(</span><span class="nv">$direccionIP</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">mostrarError</span><span class="p">(</span><span class="s2">&quot;⚠️ Acceso Restringido&quot;</span><span class="p">,</span> <span class="s2">&quot;No se permite el acceso con este navegador.&quot;</span><span class="p">,</span> <span class="s2">&quot;#fff3cd&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Verificar si la IP es de España</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">esIpDeEspaña</span><span class="p">(</span><span class="nv">$direccionIP</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">mostrarError</span><span class="p">(</span><span class="s2">&quot;🌍 Acceso Limitado&quot;</span><span class="p">,</span> <span class="s2">&quot;El acceso solo está permitido desde España.&quot;</span><span class="p">,</span> <span class="s2">&quot;#cce5ff&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Si todo está bien, permitir el acceso</span>
<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;usuario_verificado&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>cliente\inc\verificar_ip.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * # Verificación de IP en Listas Negra o Blanca</span>
<span class="sd"> *</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo contiene la función `ipEnLista()`, utilizada para verificar si una IP</span>
<span class="sd"> * está registrada en una lista blanca o negra dentro de la base de datos.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Funciones principales:</span>
<span class="sd"> * - Conectar con la base de datos mediante `$conexion`.</span>
<span class="sd"> * - Consultar si la IP está en la lista negra (`lista_negra`) o blanca (`lista_blanca`).</span>
<span class="sd"> * - Devolver `true` si la IP está en la lista especificada, o `false` en caso contrario.</span>
<span class="sd"> */</span>


    <span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/sis_seguridad.php&quot;</span><span class="p">;</span>

    <span class="k">function</span> <span class="nf">ipEnLista</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$tipoLista</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$columna</span> <span class="o">=</span> <span class="p">(</span><span class="nv">$tipoLista</span> <span class="o">===</span> <span class="s1">&#39;negra&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;lista_negra&#39;</span> <span class="o">:</span> <span class="s1">&#39;lista_blanca&#39;</span><span class="p">;</span>

        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM ips_control WHERE ip = ? AND </span><span class="si">$columna</span><span class="s2"> = 1&quot;</span><span class="p">);</span>
        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">);</span>
        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">get_result</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>cliente\inc\verificar_navegador.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/** </span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo forma parte del sistema de seguridad y su función principal es **verificar si una IP accedió con un navegador prohibido**.</span>
<span class="sd"> * Actualmente, el sistema **bloquea el acceso a usuarios que utilicen Mozilla Firefox**, aunque se pueden añadir más navegadores si es necesario.</span>
<span class="sd"> * </span>
<span class="sd"> * ## Funcionamiento:</span>
<span class="sd"> * 1. **Incluye el archivo `sis_seguridad.php`** para acceder a la configuración de seguridad y la conexión a la base de datos.</span>
<span class="sd"> * 2. **Define la función `navegadorProhibido($ip, $conexion)`**:</span>
<span class="sd"> *    - Consulta la tabla `ips_control` en la base de datos para verificar qué navegador ha sido registrado con la dirección IP dada.</span>
<span class="sd"> *    - Si el navegador registrado es **Firefox**, devuelve `true`, indicando que el acceso debe ser restringido.</span>
<span class="sd"> *    - En caso contrario, devuelve `false`, permitiendo el acceso.</span>
<span class="sd"> * </span>
<span class="sd"> * ## Dependencias:</span>
<span class="sd"> * - `sis_seguridad.php`: Proporciona la conexión a la base de datos.</span>
<span class="sd"> * - Base de datos: La tabla `ips_control` almacena la información de IPs y navegadores registrados.</span>
<span class="sd"> */</span>

<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/sis_seguridad.php&quot;</span><span class="p">;</span>

<span class="k">function</span> <span class="nf">navegadorProhibido</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="s2">&quot;SELECT navegador FROM ips_control WHERE ip = ?&quot;</span><span class="p">);</span>
    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">);</span>
    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="nv">$resultado</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">get_result</span><span class="p">();</span>
    <span class="nv">$navegadorRegistrado</span> <span class="o">=</span> <span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">()[</span><span class="s1">&#39;navegador&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s1">&#39;Desconocido&#39;</span><span class="p">;</span>

    <span class="k">return</span> <span class="p">(</span><span class="nv">$navegadorRegistrado</span> <span class="o">===</span> <span class="s1">&#39;Firefox&#39;</span><span class="p">);</span>  <span class="c1">// Puedes agregar más navegadores si lo deseas</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>cliente\include\idiomas.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="nv">$idioma</span> <span class="o">=</span> <span class="nb">explode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_ACCEPT_LANGUAGE&#39;</span><span class="p">])[</span><span class="mi">0</span><span class="p">];</span>


<span class="nv">$archivojson</span> <span class="o">=</span> <span class="s1">&#39;traductor/&#39;</span><span class="o">.</span><span class="nv">$idioma</span><span class="o">.</span><span class="s1">&#39;.json&#39;</span><span class="p">;</span>


<span class="nv">$contenidojson</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$archivojson</span><span class="p">);</span>
<span class="nv">$idioma</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$contenidojson</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>




<span class="cp">?&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\comportamiento.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * # Comportamiento de la Aplicación</span>
<span class="cm"> *</span>
<span class="cm"> * ## Descripción:</span>
<span class="cm"> * Script encargado de la inicialización de la aplicación y el manejo de eventos principales.</span>
<span class="cm"> *</span>
<span class="cm"> * ## Funciones principales:</span>
<span class="cm"> * - `mostrarUsuario()`: Muestra el usuario autenticado.</span>
<span class="cm"> * - `logout()`: Maneja la acción de cierre de sesión.</span>
<span class="cm"> * - `abrirCorreo()`: Permite abrir el correo corporativo.</span>
<span class="cm"> * - `imprimir()`: Habilita la función de impresión de contenido.</span>
<span class="cm"> * - `listadoTablas(aplicacion)`: Carga las tablas asociadas a la aplicación seleccionada.</span>
<span class="cm"> * - `listadoDocumentos()`: Muestra la lista de documentos disponibles.</span>
<span class="cm"> * - `cargaGraficas()`: Carga y renderiza las gráficas de datos.</span>
<span class="cm"> * - `cargoAplicaciones()`: Carga la lista de aplicaciones disponibles.</span>
<span class="cm"> */</span>

<span class="kd">var</span><span class="w"> </span><span class="nx">columnas_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w">  </span><span class="c1">// Variable global para almacenar columnas</span>
<span class="kd">var</span><span class="w"> </span><span class="nx">aplicaciones</span><span class="p">;</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Desde el módulo de cabecera</span>
<span class="w">  </span><span class="nx">mostrarUsuario</span><span class="p">();</span>
<span class="w">  </span><span class="nx">logout</span><span class="p">();</span>
<span class="w">  </span><span class="nx">abrirCorreo</span><span class="p">();</span>
<span class="w">  </span><span class="nx">imprimir</span><span class="p">();</span>

<span class="w">  </span><span class="c1">// Obtenemos la aplicación seleccionada</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">aplicacion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s2">&quot;crismon1_aplicacion&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;La aplicación es: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">aplicacion</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// Desde el módulo principal</span>
<span class="w">  </span><span class="nx">listadoTablas</span><span class="p">(</span><span class="nx">aplicacion</span><span class="p">);</span>
<span class="w">  </span><span class="nx">listadoDocumentos</span><span class="p">();</span>
<span class="w">  </span><span class="nx">cargaGraficas</span><span class="p">();</span>
<span class="w">  </span><span class="nx">cargoAplicaciones</span><span class="p">();</span>


<span class="p">};</span>
</code></pre></div>

<h2>cliente\supercontrolador\estilo.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* Estilo global */</span>
<span class="nt">html</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo general verde claro */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto principal en azul oscuro */</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * # Página Principal de la Aplicación</span>
<span class="sd"> *</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo carga los módulos principales de la aplicación, organizando el layout de la interfaz.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Módulos incluidos:</span>
<span class="sd"> * - **Cabecera (`cabecera.php`)**: Contiene el encabezado del sistema.</span>
<span class="sd"> * - **Principal (`principal.php`)**: Cuerpo principal donde se muestra la información.</span>
<span class="sd"> * - **Modal (`modal.php`)**: Ventanas emergentes o modales para interacciones.</span>
<span class="sd"> * - **Librerías (`librerias.php`)**: Carga scripts y estilos adicionales.</span>
<span class="sd"> * - **Cierre (`cierre.php`)**: Pie de página o cierre de estructuras HTML abiertas.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Funciones principales:</span>
<span class="sd"> * - Ensamblar los módulos del sistema.</span>
<span class="sd"> * - Cargar los scripts de comportamiento (`comportamiento.js`).</span>
<span class="sd"> */</span>

  <span class="k">include</span> <span class="s2">&quot;modulos/cabecera/cabecera.php&quot;</span><span class="p">;</span>
  <span class="k">include</span> <span class="s2">&quot;modulos/principal/principal.php&quot;</span><span class="p">;</span>
  <span class="k">include</span> <span class="s2">&quot;modulos/modal/modal.php&quot;</span><span class="p">;</span>
  <span class="k">include</span> <span class="s2">&quot;modulos/librerias/librerias.php&quot;</span><span class="p">;</span>
  <span class="k">include</span> <span class="s2">&quot;modulos/cierre/cierre.php&quot;</span><span class="p">;</span>

<span class="cp">?&gt;</span>
<span class="x">&lt;!-- Script principal de comportamiento --&gt;</span>
<span class="x">&lt;script src=&quot;comportamiento.js&quot;&gt;&lt;/script&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\apps\clientes\ficha_clientes\index.html</h2>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Aqui buscaremos todos los datosd el cliente<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\apps\clientes\historico_compra\index.html</h2>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Aqui vamos a poner las facturas de las compras<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\apps\pedidos\detalle_pedido\index.html</h2>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Aqui todos los detalles del pedido <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\ayuda\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="c1">// Función para recorrer y mostrar carpetas y archivos</span>
<span class="k">function</span> <span class="nf">recorrerCarpetaYArchivos</span><span class="p">(</span><span class="nv">$rutaCarpeta</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$rutaCarpeta</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&quot;La carpeta no existe: </span><span class="si">$rutaCarpeta</span><span class="s2">&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Función auxiliar para escanear recursivamente las carpetas</span>
    <span class="k">function</span> <span class="nf">escanearDirectorioRecursivo</span><span class="p">(</span><span class="nv">$ruta</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$elementos</span> <span class="o">=</span> <span class="nb">scandir</span><span class="p">(</span><span class="nv">$ruta</span><span class="p">);</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$elementos</span> <span class="k">as</span> <span class="nv">$elemento</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Saltar los punteros de directorio actual y padre</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$elemento</span> <span class="o">===</span> <span class="s1">&#39;.&#39;</span> <span class="o">||</span> <span class="nv">$elemento</span> <span class="o">===</span> <span class="s1">&#39;..&#39;</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="nv">$rutaCompleta</span> <span class="o">=</span> <span class="nv">$ruta</span> <span class="o">.</span> <span class="nx">DIRECTORY_SEPARATOR</span> <span class="o">.</span> <span class="nv">$elemento</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$rutaCompleta</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">echo</span> <span class="s2">&quot;&lt;h3&gt;&quot;</span> <span class="o">.</span> <span class="nv">$elemento</span> <span class="o">.</span> <span class="s2">&quot;&lt;/h3&gt;&quot;</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
                <span class="nx">escanearDirectorioRecursivo</span><span class="p">(</span><span class="nv">$rutaCompleta</span><span class="p">);</span> <span class="c1">// Llamada recursiva</span>
            <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_file</span><span class="p">(</span><span class="nv">$rutaCompleta</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$contenido</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$rutaCompleta</span><span class="p">);</span>
                <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;&quot;</span> <span class="o">.</span> <span class="nv">$contenido</span><span class="o">.</span> <span class="s2">&quot;&lt;/p&gt;&quot;</span> <span class="o">.</span> <span class="nx">PHP_EOL</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="c1">// Iniciar el escaneo desde la carpeta raíz proporcionada</span>
    <span class="nx">escanearDirectorioRecursivo</span><span class="p">(</span><span class="nv">$rutaCarpeta</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Uso del script con la ruta de la carpeta &#39;docs&#39;</span>
<span class="nv">$rutaCarpeta</span> <span class="o">=</span> <span class="s1">&#39;docs&#39;</span><span class="p">;</span>
<span class="nx">recorrerCarpetaYArchivos</span><span class="p">(</span><span class="nv">$rutaCarpeta</span><span class="p">);</span>
</code></pre></div>

<h2>cliente\supercontrolador\ayuda\docs\003.Preguntas Frecuentes.html</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;es&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Pantalla de Configuración de Accesibilidad<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="w">        </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">line-height</span><span class="p">:</span><span class="w"> </span><span class="mf">1.6</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#f4f4f4</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">container</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">700</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">h1</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#2c3e50</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="kt">px</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">h2</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#3498db</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#e74c3c</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">icono</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">            </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">em</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c">/*Estilos para el índice */</span>
<span class="w">        </span><span class="p">.</span><span class="nc">indice</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#ecf0f1</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">            </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">indice</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">list-style</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">            </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">indice</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="nt">li</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">indice</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">            </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#2980b9</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">indice</span><span class="w"> </span><span class="nt">a</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">underline</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c">/*Botón de &quot;Volver al índice&quot; */</span>
<span class="w">        </span><span class="p">.</span><span class="nc">volver</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="w">            </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">            </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">right</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">volver</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">            </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#e74c3c</span><span class="p">;</span>
<span class="w">            </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="p">.</span><span class="nc">volver</span><span class="w"> </span><span class="nt">a</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">underline</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>🔧 Pantalla de Configuración de Accesibilidad<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

        <span class="cm">&lt;!--Índice de navegación --&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;indice&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>📖 Índice<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#modo-oscuro&quot;</span><span class="p">&gt;</span> Modo Oscuro y Claro<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#fuente&quot;</span><span class="p">&gt;</span> Cambio de Fuente<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#restablecer&quot;</span><span class="p">&gt;</span> Restablecer Configuración<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#zoom&quot;</span><span class="p">&gt;</span> Ampliación de Pantalla<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>


        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;modo-oscuro&quot;</span><span class="p">&gt;</span> Modo Oscuro y Claro<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Activa o desactiva el modo oscuro para reducir la fatiga visual.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Se encuentra en la barra de navegación superior derecha.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>☼<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;boton&quot;</span><span class="p">&gt;</span>Modo Claro:<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> Aumenta la iluminación del sistema.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>🔾<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;boton&quot;</span><span class="p">&gt;</span>Modo Oscuro:<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> Activa el modo oscuro.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Para restablecer la configuración, usa el botón <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>⭯<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;volver&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>⬆️ Volver al índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

        <span class="cm">&lt;!-- Sección 2 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;fuente&quot;</span><span class="p">&gt;</span>Cambio de Fuente<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Modifica el tema del texto en la interfaz.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Ubicado en la barra de navegación superior derecha, representado por el icono &quot;F&quot;.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Ajusta la fuente con una variedad de estilos según necesidad.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Si deseas restablecer la configuración original, usa el botón <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>⭯<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;volver&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>⬆️ Volver al índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

        <span class="cm">&lt;!-- ✅ Sección 3 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;restablecer&quot;</span><span class="p">&gt;</span> Restablecer Configuración<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Restaura la apariencia del sistema a los valores predeterminados.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Se encuentra en la barra de navegación superior derecha, identificado con el icono <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>⭯<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;volver&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>⬆️ Volver al índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

        <span class="cm">&lt;!-- ✅ Sección 4 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;zoom&quot;</span><span class="p">&gt;</span> Ampliación del Contenido en Pantalla<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Ubicado en la barra de navegación superior derecha.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;boton&quot;</span><span class="p">&gt;</span>Botón +:<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> Aumenta el zoom de la página.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;boton&quot;</span><span class="p">&gt;</span>Botón -:<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> Reduce el zoom de la página.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>También puedes usar <span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Ctrl + rueda del ratón<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> para ajustar el zoom.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Si deseas restablecer los cambios, usa el botón <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;icono&quot;</span><span class="p">&gt;</span>⭯<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;volver&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span><span class="p">&gt;</span>⬆️ Volver al índice<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\js\cargaDatosTabla.js</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">/////////////////////////////////// CREO UNA FUNCIÓN PARA CARGAR DINÁMICAMENTE TABLAS /////////////////////////////////////////////</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">cargaDatosTabla</span><span class="p">(</span><span class="nx">tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">/////////////////////////////////// COMPROBAMOS SI TENEMOS APLICACIONES /////////////////////////////////////////////</span>
<span class="w">    </span><span class="nx">listaaplicaciones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Cargando datos para la tabla:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tabla</span><span class="p">);</span>

<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Aplicaciones disponibles:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">aplicaciones</span><span class="p">);</span>
<span class="w">        </span><span class="nx">aplicaciones</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">aplicacion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">aplicacion</span><span class="p">.</span><span class="nx">entidad</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Aplicaciones encontradas:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">aplicacion</span><span class="p">.</span><span class="nx">aplicaciones</span><span class="p">);</span>
<span class="w">                </span><span class="nx">listaaplicaciones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">aplicacion</span><span class="p">.</span><span class="nx">aplicaciones</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar las aplicaciones:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">campoclave</span><span class="p">;</span>
<span class="w">    </span><span class="c1">/////////////////////////////////// LISTADO DE COLUMNAS DE TABLA /////////////////////////////////////////////</span>

<span class="w">    </span><span class="c1">// Mostrar la tabla si está oculta</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tablaElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">tablaElement</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;ERROR: La tabla no existe en el DOM.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="nx">tablaElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;table&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Mostrar la tabla y ocultar los documentos si estaban visibles</span>
<span class="w">    </span><span class="nx">tablaElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;table&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">docsContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#docsContainer&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">docsContainer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">docsContainer</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span><span class="w"> </span><span class="c1">// Eliminar documentos cuando se vuelve a mostrar la tabla</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Hacer la petición al servidor para obtener las columnas de la tabla</span>

<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=columnastabla&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Datos de la tabla recibidos:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Comprobación: si la respuesta contiene un error, se detiene</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error en la respuesta:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">            </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span><span class="w"> </span><span class="c1">// Detener la ejecución</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">// Comprobación: si la respuesta no es un array, se detiene</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">datos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;La respuesta no es un array:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Ahora sí, se puede recorrer el array</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">columnas_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">tipos_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">claves_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">campos_busqueda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">thead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tablaElement</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;thead&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">thead</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">thead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;thead&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">tablaElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">thead</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">cabeceras_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">thead</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">cabeceras_tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">cabeceras_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">thead</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">cabeceras_tabla</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">cabeceras_tabla</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>

<span class="w">        </span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">elemento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">columnas_tabla</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">]);</span>
<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span>

<span class="w">            </span><span class="c1">// Crear input de búsqueda para cada columna</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">inputBusqueda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">inputBusqueda</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">]);</span>
<span class="w">            </span><span class="nx">inputBusqueda</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">convierteTipoDato</span><span class="p">(</span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]));</span>

<span class="w">            </span><span class="nx">campos_busqueda</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">inputBusqueda</span><span class="p">);</span>
<span class="w">            </span><span class="nx">claves_tabla</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]);</span>
<span class="w">            </span><span class="nx">tipos_tabla</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">convierteTipoDato</span><span class="p">(</span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Type&quot;</span><span class="p">]));</span>

<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">inputBusqueda</span><span class="p">);</span>
<span class="w">            </span><span class="nx">cabeceras_tabla</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">elemento</span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Key&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;PRI&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">campoclave</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;Field&quot;</span><span class="p">];</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">            </span><span class="c1">//////////////// AQUI AGREGAMOS LA COLUMNAS DE APLICACIONES //////////////////</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">listaaplicaciones</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">elemento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;APPS&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="nx">cabeceras_tabla</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">elemento</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">////////////////// AQUI AGREGAMOS LA COLUMNA DE BÚSQUEDA //////////////////</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">elemento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;span class=&#39;boton botonlupa&#39;&gt;&lt;img src=&#39;../img/lupa.png&#39;&gt;&lt;/span&gt;&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">cabeceras_tabla</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">elemento</span><span class="p">);</span>

<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">mensaje</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">                </span><span class="nx">campos_busqueda</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">campo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">columna</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">campo</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">valor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">campo</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">valor</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">mensaje</span><span class="p">[</span><span class="nx">columna</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">valor</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">});</span>

<span class="w">                </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=buscarSimilar&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">mensaje</span><span class="p">),</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">                    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">pueblaTabla</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="nx">campoclave</span><span class="p">);</span>
<span class="w">                    </span><span class="p">});</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="c1">/////////////////////////////////// FORMULARIO DE INSERCIÓN /////////////////////////////////////////////</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">coleccioncampos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">contiene_modal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#contienemodal&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">contiene_modal</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;h1&gt;Formulario de inserción: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&lt;/h1&gt;&quot;</span><span class="p">;</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">seccion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">columnas_tabla</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">columna</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenedor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">texto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Inserta un nuevo elemento para: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">columna</span><span class="p">;</span>
<span class="w">                </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">texto</span><span class="p">);</span>

<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">claves_tabla</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;MUL&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">tipos_tabla</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;textarea&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;textarea&quot;</span><span class="p">));</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">));</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="nx">coleccioncampos</span><span class="p">[</span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tipos_tabla</span><span class="p">[</span><span class="nx">index</span><span class="p">]);</span>
<span class="w">                    </span><span class="nx">coleccioncampos</span><span class="p">[</span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">columna</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">coleccioncampos</span><span class="p">[</span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">]);</span>

<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">selectElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">selectElement</span><span class="p">);</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">defaultOption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">defaultOption</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Selecciona una opción:&quot;</span><span class="p">;</span>
<span class="w">                    </span><span class="nx">selectElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">defaultOption</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">fetchOptionsForSelect</span><span class="p">(</span><span class="nx">selectElement</span><span class="p">,</span><span class="w"> </span><span class="nx">columna</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">selectElement</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">columna</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">selectElement</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">selectjv</span><span class="p">(</span><span class="nx">selectElement</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="nx">seccion</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">contenedor</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>

<span class="w">            </span><span class="nx">contiene_modal</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">seccion</span><span class="p">);</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">boton_enviar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">boton_enviar</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Enviar&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">boton_enviar</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Procesando formulario...&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">mensaje</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
<span class="w">                </span><span class="nx">coleccioncampos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">campo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">campo</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;placeholder&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">&quot;Identificador&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">mensaje</span><span class="p">[</span><span class="nx">campo</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;placeholder&#39;</span><span class="p">)]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">campo</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">});</span>

<span class="w">                </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=insertar&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">mensaje</span><span class="p">),</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">                    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">text</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Respuesta del servidor:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>
<span class="w">                        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;aparece&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;desaparece&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">                        </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">                    </span><span class="p">});</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="nx">contiene_modal</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">boton_enviar</span><span class="p">);</span>

<span class="w">            </span><span class="c1">/////////////////////////////////// CARGAR CONTENIDO DE LA TABLA /////////////////////////////////////////////</span>

<span class="w">                </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=tabla&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Datos de la colección recibidos:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error en la respuesta:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">                            </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">                            </span><span class="k">return</span><span class="p">;</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="nx">pueblaTabla</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="nx">campoclave</span><span class="p">,</span><span class="w"> </span><span class="nx">tabla</span><span class="p">,</span><span class="w"> </span><span class="nx">listaaplicaciones</span><span class="p">);</span>
<span class="w">                    </span><span class="p">})</span>
<span class="w">                    </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar los datos de la colección:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">                    </span><span class="p">});</span>
<span class="w">            </span><span class="p">})</span>
<span class="w">            </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar las columnas de la tabla:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>
<span class="p">}</span>


<span class="w">  </span><span class="c1">/////////////////////////////////// CREO UNA FUNCIÓN PARA CARGAR DINÁMICAMENTE TABLAS /////////////////////////////////////////////</span>


<span class="kd">function</span><span class="w"> </span><span class="nx">fetchOptionsForSelect</span><span class="p">(</span><span class="nx">selectElement</span><span class="p">,</span><span class="w"> </span><span class="nx">column</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=tabla&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">column</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mf">0</span><span class="p">])</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Verifica si se devolvió un error</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error en fetchOptionsForSelect:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">                </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">// Verifica que datos sea un array</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">datos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;La respuesta no es un array:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">option</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dato</span><span class="p">[</span><span class="s1">&#39;Identificador&#39;</span><span class="p">];</span>
<span class="w">                </span><span class="nx">option</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Object</span><span class="p">.</span><span class="nx">values</span><span class="p">(</span><span class="nx">dato</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39; - &#39;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">selectElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">option</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar opciones:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\js\cargarDatosColeccion.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">cargarDatosColeccion</span><span class="p">(</span><span class="nx">coleccion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Cargando datos para la colección:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">coleccion</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;table&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//Ocultar la tabla antes de mostrar los documentos</span>
<span class="w">    </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//Obtener la sección donde se mostrarán los documentos</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenedor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//Eliminar contenido previo antes de cargar los nuevos documentos</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">docsContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#docsContainer&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">docsContainer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">docsContainer</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span><span class="w"> </span><span class="c1">// Si ya existe, lo eliminamos para evitar duplicados</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//Crear un nuevo contenedor para los documentos</span>
<span class="w">    </span><span class="nx">docsContainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">docsContainer</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;docsContainer&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// ID para identificarlo fácilmente</span>

<span class="w">    </span><span class="c1">//Agregar el contenedor a la sección principal</span>
<span class="w">    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">docsContainer</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//Realizar la solicitud al servidor para obtener los documentos de la colección</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`../../servidor/?o=listadocumentos&amp;coleccion=</span><span class="si">${</span><span class="nx">coleccion</span><span class="si">}</span><span class="sb">`</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Datos de la colección recibidos:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Si no hay documentos, mostrar un mensaje</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">datos</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">docsContainer</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;p style=&#39;padding: 20px; text-align: center; font-weight: bold;&#39;&gt;No hay documentos en esta colección.&lt;/p&gt;&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="k">return</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Generar las tarjetas de documentos dinámicamente</span>
<span class="w">            </span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">card</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;article&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">card</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;document-card&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Aplica estilos con CSS si es necesario</span>

<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">titulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;h3&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">titulo</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">dato</span><span class="p">[</span><span class="s2">&quot;_id&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s2">&quot;Documento sin ID&quot;</span><span class="p">;</span>

<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">contenido</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">renderJSONToHTML</span><span class="p">(</span><span class="nx">dato</span><span class="p">);</span><span class="w"> </span><span class="c1">//Convertir JSON a HTML</span>



<span class="w">                </span><span class="nx">card</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">titulo</span><span class="p">);</span>
<span class="w">                </span><span class="nx">card</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">contenido</span><span class="p">);</span>
<span class="w">                </span><span class="nx">docsContainer</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">card</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot; Error al cargar los datos de la colección:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>
<span class="p">}</span>
<span class="c1">////////////////////////////////// funcion para elimiar datos /////////////////////////////////</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">eliminarDocumento</span><span class="p">(</span><span class="nx">coleccion</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">confirm</span><span class="p">(</span><span class="s2">&quot;¿Estás seguro de eliminar este documento?&quot;</span><span class="p">))</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="sb">`../../servidor/?o=eliminarDocumento&amp;coleccion=</span><span class="si">${</span><span class="nx">coleccion</span><span class="si">}</span><span class="sb">&amp;id=</span><span class="si">${</span><span class="nx">id</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;DELETE&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">        </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">data</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">alert</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">mensaje</span><span class="p">);</span>
<span class="w">            </span><span class="nx">cargarDatosColeccion</span><span class="p">(</span><span class="nx">coleccion</span><span class="p">);</span><span class="w"> </span><span class="c1">// Recargar datos después de eliminar</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">        </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al eliminar documento:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="p">}</span>
<span class="c1">/////////////////////////////////// FUNCION CONVERTIR JSON EN HTML ///////////////////////////</span>
<span class="c1">// Función recursiva para convertir JSON en HTML</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">renderJSONToHTML</span><span class="p">(</span><span class="nx">json</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="ow">typeof</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s2">&quot;object&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nx">json</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="sb">`&lt;span&gt;</span><span class="si">${</span><span class="nx">json</span><span class="si">}</span><span class="sb">&lt;/span&gt;`</span><span class="p">;</span><span class="w"> </span><span class="c1">// Si es un valor simple, devolverlo como texto.</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">json</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Manejar arrays</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">            &lt;ul style=&quot;list-style-type: square; margin-left: 20px;&quot;&gt;</span>
<span class="sb">                </span><span class="si">${</span><span class="nx">json</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">item</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`&lt;li&gt;</span><span class="si">${</span><span class="nx">renderJSONToHTML</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span><span class="si">}</span><span class="sb">&lt;/li&gt;`</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="sb">            &lt;/ul&gt;</span>
<span class="sb">        `</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Manejar objetos</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">        &lt;div style=&quot;margin-left: 10px;&quot;&gt;</span>
<span class="sb">            </span><span class="si">${</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">json</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">clave</span><span class="p">,</span><span class="w"> </span><span class="nx">valor</span><span class="p">])</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="sb">`</span>
<span class="sb">                &lt;div style=&quot;margin-bottom: 8px;&quot;&gt;</span>
<span class="sb">                    &lt;strong style=&quot;color: #333;&quot;&gt;</span><span class="si">${</span><span class="nx">clave</span><span class="si">}</span><span class="sb">:&lt;/strong&gt; </span><span class="si">${</span><span class="nx">renderJSONToHTML</span><span class="p">(</span><span class="nx">valor</span><span class="p">)</span><span class="si">}</span>
<span class="sb">                &lt;/div&gt;</span>
<span class="sb">            `</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="si">}</span>
<span class="sb">        &lt;/div&gt;</span>
<span class="sb">    `</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\js\convierteTipoDato.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">convierteTipoDato</span><span class="p">(</span><span class="nx">tipo</span><span class="p">){</span>

<span class="w">    </span><span class="c1">//------------------------- CONFIGURACIÓN DINAMICA  --------------------------//</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tipodevuelto</span>
<span class="w">    </span><span class="c1">//aqui estamos haciendo que en cada casilla contyenga el datos que le corresponde </span>
<span class="w">    </span><span class="c1">//si la columna es varchar, el input sera del tipo text</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">tipo</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;varchar&quot;</span><span class="p">)){</span>
<span class="w">        </span><span class="nx">tipodevuelto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="nx">tipo</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">)){</span>
<span class="w">        </span><span class="nx">tipodevuelto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;textarea&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//si es date, sera un selector de fecha </span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="nx">tipo</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)){</span>
<span class="w">        </span><span class="nx">tipodevuelto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//si es date, sera un selector de fecha </span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="nx">tipo</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)){</span>
<span class="w">        </span><span class="nx">tipodevuelto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;date&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="nx">tipo</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;decimal&quot;</span><span class="p">)){</span>
<span class="w">        </span><span class="nx">tipodevuelto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="p">(</span><span class="nx">tipo</span><span class="p">.</span><span class="nx">includes</span><span class="p">(</span><span class="s2">&quot;blob&quot;</span><span class="p">)){</span>
<span class="w">        </span><span class="nx">tipodevuelto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;file&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">tipodevuelto</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\js\crearMenuTablas.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">crearMenuTablas</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="nx">tipoentidad</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">menu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;nav ul&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//////////////////////////////////////////////////////////////////////////////////////////////</span>
<span class="w">    </span><span class="c1">//para evitar duplicados </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;busquedasMenu&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">busquedas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">busquedas</span><span class="p">.</span><span class="nx">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;busquedasMenu&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">busquedas</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;span class=&#39;boton botondocumento&#39;&gt;&lt;img src=&#39;../supercontrolador/img/iconoconsola.png&#39;&gt;&lt;/span&gt; Búsquedas&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">busquedas</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Ver resultados de búsqueda en análisis&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="nx">busquedas</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">marco</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;iframe&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">marco</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;../analisis/&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">marco</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;100%&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">marco</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;600px&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">marco</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nx">menu</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">busquedas</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//////////////////////////////////////////////////////////////////////////////////////////////</span>
<span class="w">    </span><span class="c1">// Verificamos si &#39;datos&#39; es un array antes de iterar</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">datos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">nombre_de_la_tabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tabla</span><span class="p">[</span><span class="s1">&#39;Tables_in_crismon1&#39;</span><span class="p">];</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">elemento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">icono</span><span class="p">;</span>

<span class="w">            </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">tipoentidad</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;tabla&quot;</span><span class="o">:</span>
<span class="w">                    </span><span class="nx">icono</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;span class=&#39;boton botontabla&#39;&gt;&lt;img src=&#39;../img/icnotabla.png&#39;&gt;&lt;/span&gt;&quot;</span><span class="p">;</span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span>
<span class="w">                </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;coleccion&quot;</span><span class="o">:</span>
<span class="w">                    </span><span class="nx">icono</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;span class=&#39;boton botondocumento&#39;&gt;&lt;img src=&#39;../img/documento.png&#39;&gt;&lt;/span&gt;&quot;</span><span class="p">;</span>
<span class="w">                    </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">icono</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">nombre_de_la_tabla</span><span class="p">;</span>
<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;destino&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">nombre_de_la_tabla</span><span class="p">);</span>
<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Haz click para cargar la información de la tabla &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">nombre_de_la_tabla</span><span class="p">);</span>
<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;comentario&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tabla</span><span class="p">[</span><span class="s1">&#39;Comentario&#39;</span><span class="p">]);</span>

<span class="w">            </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">texto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;destino&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="nx">tipoentidad</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;tabla&quot;</span><span class="o">:</span>
<span class="w">                        </span><span class="nx">cargaDatosTabla</span><span class="p">(</span><span class="nx">texto</span><span class="p">);</span>
<span class="w">                        </span><span class="k">break</span><span class="p">;</span>
<span class="w">                    </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;coleccion&quot;</span><span class="o">:</span>
<span class="w">                        </span><span class="nx">cargarDatosColeccion</span><span class="p">(</span><span class="nx">texto</span><span class="p">);</span>
<span class="w">                        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;ok coleccion&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">break</span><span class="p">;</span>
<span class="w">                </span><span class="p">}</span>

<span class="w">                </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.titulotabla h5&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
<span class="w">                </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.titulotabla p&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;comentario&quot;</span><span class="p">);</span>

<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">elementosmenu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;nav ul li&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">elementosmenu</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">elemento</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;menuseleccionado&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="p">});</span>

<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;menuseleccionado&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="nx">menu</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">elemento</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Se esperaba un array, pero se recibió:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\js\funciones.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">renderizarTabla</span><span class="p">(</span><span class="nx">arrayAsociado</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="sb">`&lt;table class=&#39;vistaTabla&#39;&gt;`</span><span class="p">;</span>
<span class="w">    </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Clave&lt;/th&gt;&lt;th&gt;Valor&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;`</span><span class="p">;</span>
<span class="w">    </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`&lt;tbody&gt;`</span><span class="p">;</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">clave</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">arrayAsociado</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`&lt;tr&gt;&lt;td&gt;</span><span class="si">${</span><span class="nx">clave</span><span class="si">}</span><span class="sb">&lt;/td&gt;&lt;td&gt;</span><span class="si">${</span><span class="nx">arrayAsociado</span><span class="p">[</span><span class="nx">clave</span><span class="p">]</span><span class="si">}</span><span class="sb">&lt;/td&gt;&lt;/tr&gt;`</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="sb">`&lt;/tbody&gt;&lt;/table&gt;`</span><span class="p">;</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">tabla</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\js\pueblaTabla.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">pueblaTabla</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="nx">campoclave</span><span class="p">,</span><span class="w"> </span><span class="nx">tabla</span><span class="p">,</span><span class="w"> </span><span class="nx">listaaplicaciones</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//console.log(&quot;Datos recibidos en pueblaTabla:&quot;, datos);</span>
<span class="w">     </span><span class="c1">// Comprueba si la respuesta contiene un error</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error en pueblaTabla:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Error: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">datos</span><span class="p">.</span><span class="nx">error</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// Verifica que datos sea un array</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">Array</span><span class="p">.</span><span class="nx">isArray</span><span class="p">(</span><span class="nx">datos</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;pueblaTabla: La respuesta no es un array:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Datos recibidos en pueblaTabla:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">datos</span><span class="p">);</span>


<span class="w">    </span><span class="c1">// Obtener la tabla y su &lt;tbody&gt;</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tablaElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section table&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenidotabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tablaElement</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">contenidotabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">contenidotabla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">tablaElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">contenidotabla</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Limpiar el contenido previo del tbody</span>
<span class="w">    </span><span class="nx">contenidotabla</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Recorrer los datos y crear una fila para cada registro</span>
<span class="w">    </span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">registro</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">nuevafila</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Recorrer cada propiedad del registro para crear sus celdas</span>
<span class="w">        </span><span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">registro</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">clave</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">clave</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">campoclave</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">clave_primaria</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">registro</span><span class="p">[</span><span class="nx">clave</span><span class="p">];</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">nuevacolumna</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">nuevacolumna</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">registro</span><span class="p">[</span><span class="nx">clave</span><span class="p">];</span>
<span class="w">            </span><span class="nx">nuevacolumna</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;tabla&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tabla</span><span class="p">);</span>
<span class="w">            </span><span class="nx">nuevacolumna</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;columna&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">clave</span><span class="p">);</span>
<span class="w">            </span><span class="nx">nuevacolumna</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;Identificador&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Hacer la celda editable al doble clic</span>
<span class="w">            </span><span class="nx">nuevacolumna</span><span class="p">.</span><span class="nx">ondblclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Click en celda editable.&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;contenteditable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="c1">// Al perder el foco, desactivar la edición y enviar la actualización al servidor</span>
<span class="w">            </span><span class="nx">nuevacolumna</span><span class="p">.</span><span class="nx">onblur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">this</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;contenteditable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;false&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">mensaje</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="s2">&quot;tabla&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;tabla&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="s2">&quot;columna&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;columna&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="s2">&quot;Identificador&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;Identificador&quot;</span><span class="p">),</span>
<span class="w">                    </span><span class="s2">&quot;valor&quot;</span><span class="o">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">textContent</span>
<span class="w">                </span><span class="p">};</span>
<span class="w">                </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=actualizar&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;application/json&#39;</span><span class="p">,</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">mensaje</span><span class="p">),</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">datos</span><span class="p">));</span>

<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Datos enviados al servidor:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">mensaje</span><span class="p">);</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="nx">nuevafila</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">nuevacolumna</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="c1">// Agregar columna de aplicaciones si la lista no está vacía</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">listaaplicaciones</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">columnaApps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">opcionInicial</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">opcionInicial</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Selecciona una opción&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">selector</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">opcionInicial</span><span class="p">);</span>

<span class="w">            </span><span class="nx">listaaplicaciones</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">aplicacion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">opcion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">aplicacion</span><span class="p">;</span>
<span class="w">                </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">aplicacion</span><span class="p">;</span>
<span class="w">                </span><span class="nx">selector</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">opcion</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>

<span class="w">            </span><span class="nx">selector</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Cargando aplicación:&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">seccion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">seccion</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;iframe src=&#39;../supercontrolador/apps/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;/index.html?entidad=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&amp;id=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&#39;&gt;&lt;/iframe&gt;&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Ruta del iframe:&quot;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;supercontrolador/apps/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/index.html?entidad=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&amp;id=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">);</span>
<span class="w">            </span><span class="p">};</span>

<span class="w">            </span><span class="nx">columnaApps</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>
<span class="w">            </span><span class="nx">nuevafila</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">columnaApps</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// GENERAMOS BOTÓN ELIMINAR</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">columnaEliminar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">columnaEliminar</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;span class=&#39;boton botoneliminar&#39;&gt;&lt;img src=&#39;../img/eliminar.png&#39;&gt;&lt;/span&gt;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">columnaEliminar</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;claveprimaria&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">);</span>

<span class="w">        </span><span class="nx">columnaEliminar</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Eliminando registro con ID:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">);</span>
<span class="w">            </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=eliminar&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&amp;id=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">(()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">        </span><span class="nx">nuevafila</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">columnaEliminar</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// GENERAMOS BOTÓN INFORME</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">columnaInforme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">columnaInforme</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="s2">&quot;&lt;span class=&#39;boton botoneliminar&#39;&gt;&lt;img src=&#39;../img/informe.png&#39;&gt;&lt;/span&gt;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// Se asigna el atributo &#39;claveprimaria&#39; para identificar el registro</span>
<span class="w">        </span><span class="nx">columnaInforme</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;claveprimaria&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">clave_primaria</span><span class="p">);</span>
<span class="w">        </span><span class="nx">nuevafila</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">columnaInforme</span><span class="p">);</span>

<span class="w">        </span><span class="nx">columnaInforme</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Quiero un informe&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">identificador</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;claveprimaria&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Quiero un informe&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tabla</span><span class="p">,</span><span class="w"> </span><span class="nx">identificador</span><span class="p">);</span>
<span class="w">            </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=informe&amp;tabla=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">tabla</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&amp;id=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">identificador</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">json</span><span class="p">();</span>
<span class="w">                </span><span class="p">})</span>
<span class="w">                </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">datos</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">datos</span><span class="p">);</span>
<span class="w">                    </span><span class="c1">// Limpiar el contenido de la sección y renderizar la nueva tabla con la función &#39;renderizarTabla&#39;</span>
<span class="w">                    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">                    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">renderizarTabla</span><span class="p">(</span><span class="nx">datos</span><span class="p">[</span><span class="mf">0</span><span class="p">]);</span>
<span class="w">                </span><span class="p">});</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="c1">// Agregar la fila completa al tbody de la tabla</span>
<span class="w">        </span><span class="nx">contenidotabla</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">nuevafila</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\ampliador\ampliador.css</h2>
<div class="codehilite"><pre><span></span><code><span class="w">  </span><span class="c">/* Estilo de la Página General */</span>
<span class="w">  </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>


<span class="c">/* Estilo General del Contenedor */</span>
<span class="p">.</span><span class="nc">ampliador</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Esquinas redondeadas */</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">fixed</span><span class="p">;</span>
<span class="w">    </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">right</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="c">/* Asegura que siempre esté encima */</span>
<span class="w">    </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c">/* Estilo de los Botones */</span>
<span class="w">  </span><span class="p">.</span><span class="nc">ampliador</span><span class="w"> </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI Emoji&#39;</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span><span class="c">/* Forma circular */</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Botones más pequeños */</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Anchura fija */</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Altura fija */</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto ajustado */</span>
<span class="w">    </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">relative</span><span class="p">;</span>
<span class="w">    </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">;</span>
<span class="w">    </span><span class="k">pointer-events</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="p">.</span><span class="nc">ampliador</span><span class="w"> </span><span class="nt">button</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c">/* Botón Activo */</span>
<span class="w">  </span><span class="p">.</span><span class="nc">ampliador</span><span class="w"> </span><span class="nt">button</span><span class="p">:</span><span class="nd">active</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c">/* Restablecer escala al hacer clic */</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#3C6F81</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\ampliador\ampliador.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">tamanio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">cantidadcontraste</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">contenedor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="nx">contenedor</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;ampliador&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">invertido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="c1">///////////////////////////////// FUENTE ///////////////////////////////</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">fuentes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Tahoma&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Geneva&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Verdana&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;sans-serif&#39;</span><span class="p">];</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">contador</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">fuente</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="nx">fuente</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;F&quot;</span><span class="p">;</span>
<span class="nx">fuente</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;aria-label&quot;</span><span class="p">,</span><span class="s2">&quot;Cambiar de funete&quot;</span><span class="p">)</span>
<span class="nx">fuente</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Cambiar de fuente&quot;</span><span class="p">);</span>

<span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">fuente</span><span class="p">)</span>

<span class="nx">fuente</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuentes</span><span class="p">[</span><span class="nx">contador</span><span class="p">];</span>
<span class="w">    </span><span class="nx">contador</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">contador</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">4</span><span class="p">){</span><span class="nx">contador</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;}</span>
<span class="p">}</span>

<span class="c1">///////////////////////////////// AUMENTAR ///////////////////////////////</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">aumentar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="nx">aumentar</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;+&quot;</span><span class="p">;</span>
<span class="nx">aumentar</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;aria-label&quot;</span><span class="p">,</span><span class="s2">&quot;Ampliar&quot;</span><span class="p">)</span>
<span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">aumentar</span><span class="p">)</span>
<span class="c1">///para añadir el efecto de disminuir cuando le damos al bioton de +</span>
<span class="nx">aumentar</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">tamanio</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">1.1</span><span class="p">;</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tamanio</span><span class="o">+</span><span class="s2">&quot;em&quot;</span>

<span class="p">}</span>

<span class="c1">///////////////////////////////// CONTRATSE ///////////////////////////////</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">contraste</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="nx">contraste</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;☼&quot;</span><span class="p">;</span>
<span class="nx">contraste</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;aria-label&quot;</span><span class="p">,</span><span class="s2">&quot;Cambiar contraste&quot;</span><span class="p">)</span>
<span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">contraste</span><span class="p">)</span>
<span class="nx">contraste</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">cantidadcontraste</span><span class="w"> </span><span class="o">=</span><span class="mf">3</span><span class="p">;</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">filter</span><span class="o">=</span><span class="s2">&quot;contrast(&quot;</span><span class="o">+</span><span class="nx">cantidadcontraste</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">///////////////////////////////// INVERTIR CONTRATSE ///////////////////////////////</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">invertir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="nx">invertir</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;🔾&quot;</span><span class="p">;</span>
<span class="nx">invertir</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;aria-label&quot;</span><span class="p">,</span><span class="s2">&quot;Invertir contraste&quot;</span><span class="p">)</span>
<span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">invertir</span><span class="p">)</span>

<span class="nx">invertir</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">invertido</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">false</span><span class="p">){</span>
<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;invert(1) hue-rotate(180deg)&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">invertido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">    </span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;invert(0) hue-rotate(0deg)&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">invertido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">///////////////////////////////// DISMINUIR ///////////////////////////////</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">disminuir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="nx">disminuir</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
<span class="nx">disminuir</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;aria-label&quot;</span><span class="p">,</span><span class="s2">&quot;Disminuir contenido pagina&quot;</span><span class="p">)</span>
<span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">disminuir</span><span class="p">);</span>
<span class="c1">///para añadir el efecto de disminuir cuando le damos al bioton de -</span>
<span class="nx">disminuir</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">tamanio</span><span class="w"> </span><span class="o">*=</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tamanio</span><span class="o">+</span><span class="s2">&quot;em&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>


<span class="c1">///////////////////////////////// RESTABLECER ///////////////////////////////</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">restablecer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="nx">restablecer</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;⭯&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="nx">restablecer</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;aria-label&quot;</span><span class="p">,</span><span class="s2">&quot;Volver a pagina original&quot;</span><span class="p">)</span>
<span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">restablecer</span><span class="p">);</span>
<span class="nx">restablecer</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">tamanio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cantidadcontraste</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>
<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">transform</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;scale(1)&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">///////////////////////////////// AÑADIR AL DOCUMENTO ///////////////////////////////</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">contenedor</span><span class="p">);</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\graficos\graficos.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * # Generador de Gráficos Dinámicos</span>
<span class="cm"> * </span>
<span class="cm"> * ## Descripción:</span>
<span class="cm"> * Esta clase permite generar gráficos de pastel y de barras de manera dinámica utilizando</span>
<span class="cm"> * el elemento `&lt;canvas&gt;`. Se pueden personalizar los colores, el título y el contenedor</span>
<span class="cm"> * donde se insertará el gráfico.</span>
<span class="cm"> * </span>
<span class="cm"> * ## Funcionalidades principales:</span>
<span class="cm"> * - Creación de gráficos circulares (tipo pastel).</span>
<span class="cm"> * - Creación de gráficos de barras.</span>
<span class="cm"> * - Soporte para personalización de colores y títulos.</span>
<span class="cm"> * - Conversión de colores de formato hexadecimal a RGB.</span>
<span class="cm"> * - Distribución automática de etiquetas en los gráficos.</span>
<span class="cm"> */</span>

<span class="kd">class</span><span class="w"> </span><span class="nx">GeneradorGrafica</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kr">constructor</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="nx">color</span><span class="p">,</span><span class="w"> </span><span class="nx">selector</span><span class="p">,</span><span class="w"> </span><span class="nx">titulo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">datos</span><span class="p">;</span><span class="w">     </span><span class="c1">// Los datos del gráfico</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">;</span><span class="w">     </span><span class="c1">// Color base para el gráfico</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">selector</span><span class="p">;</span><span class="w"> </span><span class="c1">// El selector del contenedor donde se mostrará el gráfico</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">titulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">titulo</span><span class="p">;</span><span class="w">   </span><span class="c1">// Título opcional del gráfico</span>
<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="nx">creargrafica</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">anchura</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">512</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">512</span><span class="p">;</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">lienzo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">anchura</span><span class="p">;</span>
<span class="w">        </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">altura</span><span class="p">;</span>
<span class="w">        </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;1px solid silver&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">contexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">variaciones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">100</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">micolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">convertirHex</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">supercolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">supertitulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">titulo</span><span class="p">;</span>

<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">lienzo</span><span class="p">);</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span><span class="w"> </span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">inicioangulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>

<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">micolor</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">variaciones</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">micolor</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">variaciones</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">micolor</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">variaciones</span><span class="p">);</span>

<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">finalangulo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">total</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`rgb(</span><span class="si">${</span><span class="nx">r</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">g</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">b</span><span class="si">}</span><span class="sb">)`</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Dibujar la porción del gráfico</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">moveTo</span><span class="p">(</span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">50</span><span class="p">,</span><span class="w"> </span><span class="nx">inicioangulo</span><span class="p">,</span><span class="w"> </span><span class="nx">inicioangulo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">finalangulo</span><span class="p">);</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">lineTo</span><span class="p">(</span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Calcular el ángulo medio para posicionar el texto</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">angulotexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">inicioangulo</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">finalangulo</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Calcular la posición del texto</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">radioTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span><span class="w"> </span><span class="c1">// Radio más pequeño para centrar el texto</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">xTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">cos</span><span class="p">(</span><span class="nx">angulotexto</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">radioTexto</span><span class="p">;</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">yTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">sin</span><span class="p">(</span><span class="nx">angulotexto</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">radioTexto</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Guardar el estado del contexto antes de rotar</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">save</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Trasladar y rotar el contexto</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="nx">xTexto</span><span class="p">,</span><span class="w"> </span><span class="nx">yTexto</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">rotacion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">angulotexto</span><span class="p">;</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">angulotexto</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">rotacion</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="p">;</span><span class="w"> </span><span class="c1">// Invertir el texto si está en la mitad inferior</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">rotate</span><span class="p">(</span><span class="nx">rotacion</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Dibujar el texto principal (nombre del dato)</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;black&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Color del texto</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;10px Arial&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Tamaño y fuente del texto</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;center&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">textBaseline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;middle&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">dato</span><span class="p">.</span><span class="nx">texto</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">8</span><span class="p">);</span><span class="w"> </span><span class="c1">// Texto principal, ligeramente más arriba</span>

<span class="w">            </span><span class="c1">// Dibujar el porcentaje debajo del texto principal</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;9px Arial&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Fuente ligeramente más pequeña</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="p">((</span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">total</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">100</span><span class="p">).</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">1</span><span class="p">)</span><span class="si">}</span><span class="sb">%`</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">4</span><span class="p">);</span><span class="w"> </span><span class="c1">// Porcentaje debajo del texto</span>

<span class="w">            </span><span class="c1">// Restaurar el estado original del contexto</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">restore</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// Actualizar el ángulo de inicio para la siguiente porción</span>
<span class="w">            </span><span class="nx">inicioangulo</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">finalangulo</span><span class="p">;</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="c1">// Dibujar el círculo central</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;white&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">beginPath</span><span class="p">();</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">arc</span><span class="p">(</span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2</span><span class="p">);</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fill</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// Dibujar el título</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;center&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">supercolor</span><span class="p">;</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;bold 20px Arial&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">supertitulo</span><span class="p">,</span><span class="w"> </span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="mf">30</span><span class="p">);</span><span class="w"> </span><span class="c1">// Solo se dibuja una vez en la parte superior</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Método para generar un gráfico de barras</span>
<span class="w">    </span><span class="nx">creargraficabarras</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Dimensiones del gráfico</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">anchura</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">512</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">512</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Crear el lienzo</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">lienzo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;canvas&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">anchura</span><span class="p">;</span>
<span class="w">        </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">altura</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Obtener el contexto 2D</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">contexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">lienzo</span><span class="p">.</span><span class="nx">getContext</span><span class="p">(</span><span class="s2">&quot;2d&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Añadir el lienzo al contenedor</span>
<span class="w">        </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">lienzo</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Calcular valores de referencia</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">acc</span><span class="p">,</span><span class="w"> </span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">acc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span><span class="w"> </span><span class="c1">// Total de valores</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">anchoBarra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">anchura</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10</span><span class="p">;</span><span class="w"> </span><span class="c1">// Ancho de cada barra</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">maxValor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(...</span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">dato</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="p">));</span><span class="w"> </span><span class="c1">// Valor máximo</span>

<span class="w">        </span><span class="c1">// Dibujar cada barra</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">datos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">dato</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Altura proporcional de la barra</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">alturaBarra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">maxValor</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">altura</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Posición de la barra</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">anchoBarra</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nx">alturaBarra</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Colores aleatorios para cada barra</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">micolor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">convertirHex</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">color</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">micolor</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">micolor</span><span class="p">[</span><span class="mf">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">micolor</span><span class="p">[</span><span class="mf">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">50</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Dibujar barra</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`rgb(</span><span class="si">${</span><span class="nx">r</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">g</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">b</span><span class="si">}</span><span class="sb">)`</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillRect</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">anchoBarra</span><span class="p">,</span><span class="w"> </span><span class="nx">alturaBarra</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Dibujar etiquetas</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;black&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;center&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="nx">dato</span><span class="p">.</span><span class="nx">texto</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">anchoBarra</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">altura</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">10</span><span class="p">);</span><span class="w"> </span><span class="c1">// Etiqueta del texto</span>
<span class="w">            </span><span class="nx">contexto</span><span class="p">.</span><span class="nx">fillText</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">dato</span><span class="p">.</span><span class="nx">valor</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">anchoBarra</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">5</span><span class="p">);</span><span class="w"> </span><span class="c1">// Etiqueta del valor</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Método para convertir un color hexadecimal a RGB</span>
<span class="w">    </span><span class="nx">convertirHex</span><span class="p">(</span><span class="nx">codigohexadecimal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">codigohexadecimal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">codigohexadecimal</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^#/</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">numerohex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseInt</span><span class="p">(</span><span class="nx">codigohexadecimal</span><span class="p">,</span><span class="w"> </span><span class="mf">16</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">rojo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">numerohex</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mf">16</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mf">255</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">verde</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">numerohex</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="mf">8</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mf">255</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">azul</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">numerohex</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mf">255</span><span class="p">;</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">[</span><span class="nx">rojo</span><span class="p">,</span><span class="w"> </span><span class="nx">verde</span><span class="p">,</span><span class="w"> </span><span class="nx">azul</span><span class="p">];</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\selectjv\selectjv.css</h2>
<div class="codehilite"><pre><span></span><code><span class="p">.</span><span class="nc">selectjv</span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-family</span><span class="p">:</span><span class="kc">sans-serif</span><span class="p">;</span>

<span class="p">}</span>
<span class="p">.</span><span class="nc">selectjv</span><span class="w"> </span><span class="p">.</span><span class="nc">caja</span><span class="p">{</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">grey</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="kc">inline-block</span><span class="p">;</span>
<span class="w">  </span><span class="k">min-width</span><span class="p">:</span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.3</span><span class="p">);</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">resultados</span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="kc">inline-block</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">lightgrey</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">min-width</span><span class="p">:</span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">max-height</span><span class="p">:</span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="c">/*box-shadow:0px 2px 4px rgba(0,0,0,0.3) inset;*/</span>
<span class="w">  </span><span class="k">overflow-y</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">radio2</span><span class="p">{</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">selectjv</span><span class="w"> </span><span class="nt">select</span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\selectjv\selectjv.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">function</span><span class="w"> </span><span class="nx">selectjv</span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Definir contenedores correctamente</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenedores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w">  </span><span class="c1">// Se agregó `let` para evitar que `contenedores` sea global.</span>

<span class="w">    </span><span class="c1">//////////////////// CREACION DEL CONTENEDOR PARA EL SELECT ///////////////</span>
<span class="w">    </span><span class="c1">// Creo un div</span>
<span class="w">    </span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="c1">// Le asigno la clase</span>
<span class="w">    </span><span class="nx">contenedores</span><span class="p">[</span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;selectjv&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Esta funcion se ejecuta cuando se hace click dentro del contenedor, evita que se propague a otros elementos padres</span>
<span class="w">    </span><span class="c1">// Útil para manejar la visibilidad de los elementos relacionados como una lista de resultados</span>
<span class="w">    </span><span class="nx">contenedores</span><span class="p">[</span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Reemplazo el select original con el nuevo div</span>
<span class="w">    </span><span class="c1">// El select ahora será parte del nuevo contenedor</span>
<span class="w">    </span><span class="nx">selector</span><span class="p">.</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">contenedores</span><span class="p">[</span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">]);</span>

<span class="w">    </span><span class="c1">//////////////////////// VISUALIZACION DE LAS OPCIONES ////////////////////</span>
<span class="w">    </span><span class="c1">// Creo una nueva caja</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">caja</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">caja</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;caja&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Le asigno como texto, el de la primera opción</span>
<span class="w">    </span><span class="nx">caja</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">selector</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;option:first-child&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Agrego el div.caja y el select al contenedor original</span>
<span class="w">    </span><span class="nx">contenedores</span><span class="p">[</span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">caja</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedores</span><span class="p">[</span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">1</span><span class="p">].</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Al hacer click en la caja</span>
<span class="w">    </span><span class="nx">caja</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">        </span><span class="nx">caja</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;radio2&quot;</span><span class="p">);</span><span class="w">  </span><span class="c1">// Cambia la clase del radio</span>

<span class="w">        </span><span class="c1">//----------------- CREACION DE LAS OPTION DEL SELECT -------------//</span>
<span class="w">        </span><span class="c1">// Creo un nuevo contenedor para los resultados</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">resultados</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">resultados</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;resultados&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">resultados</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Creo un campo de búsqueda</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">buscador</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">buscador</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;search&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">buscador</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;placeholder&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;busca...&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">resultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">buscador</span><span class="p">);</span>

<span class="w">        </span><span class="nx">buscador</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="c1">//------------------ FILTRADO DE LAS OPCIONES -------------//</span>
<span class="w">        </span><span class="c1">// Creo un contenedor intermedio para las opciones filtradas</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">contieneresultados</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">contieneresultados</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">e</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">        </span><span class="p">};</span>

<span class="w">        </span><span class="c1">// Selecciono todas las opciones del select original</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">opciones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">selector</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Recorro todas las opciones y las agrego a los resultados</span>
<span class="w">        </span><span class="nx">opciones</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">texto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
<span class="w">            </span><span class="nx">contieneresultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">texto</span><span class="p">);</span>

<span class="w">            </span><span class="nx">texto</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Has hecho clic en una opción: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="p">);</span>
<span class="w">                </span><span class="nx">resultados</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span><span class="w">  </span><span class="c1">// Elimino la lista de resultados</span>
<span class="w">                </span><span class="nx">caja</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span><span class="w">  </span><span class="c1">// Actualizo el texto de la caja</span>

<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">opciones2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">selector</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">opciones2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion2</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">opcion2</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;selected&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">opcion2</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;selected&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                </span><span class="p">});</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="nx">resultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">contieneresultados</span><span class="p">);</span>

<span class="w">        </span><span class="c1">//------------------------- FILTRAMOS LAS OPCIONES ---------------------------//</span>
<span class="w">        </span><span class="c1">// Se ejecutará cada vez que el usuario escriba algo en el campo de búsqueda</span>
<span class="w">        </span><span class="nx">buscador</span><span class="p">.</span><span class="nx">onkeyup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Cojo el valor escrito</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">busca</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="w">            </span><span class="c1">// Vacío el contenedor de resultados antes de agregar las nuevas opciones</span>
<span class="w">            </span><span class="nx">contieneresultados</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>

<span class="w">            </span><span class="nx">opciones</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Si el texto de la opción coincide con lo que se está buscando (sin importar mayúsculas/minúsculas)</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">busca</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">texto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>
<span class="w">                    </span><span class="nx">contieneresultados</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">texto</span><span class="p">);</span>

<span class="w">                    </span><span class="c1">// Al hacer click en una opción filtrada</span>
<span class="w">                    </span><span class="nx">texto</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Has hecho clic en una opción: &quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="p">);</span>
<span class="w">                        </span><span class="nx">resultados</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
<span class="w">                        </span><span class="nx">caja</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="p">;</span>

<span class="w">                        </span><span class="kd">let</span><span class="w"> </span><span class="nx">opciones2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">selector</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="nx">opciones2</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">opcion2</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nx">texto</span><span class="p">.</span><span class="nx">textContent</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nx">opcion2</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;selected&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">                            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nx">opcion2</span><span class="p">.</span><span class="nx">removeAttribute</span><span class="p">(</span><span class="s2">&quot;selected&quot;</span><span class="p">);</span>
<span class="w">                            </span><span class="p">}</span>
<span class="w">                        </span><span class="p">});</span>
<span class="w">                    </span><span class="p">};</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">//----------------- CERRAR LA LISTA DE OPCIONES --------------//</span>
<span class="w">    </span><span class="c1">// Cuando hago click en cualquier parte del documento</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;ok body&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">contenedores</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">contenedor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">// Elimino la lista de opciones y la clase radio de la caja</span>
<span class="w">                </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.resultados&quot;</span><span class="p">).</span><span class="nx">remove</span><span class="p">();</span>
<span class="w">                </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;.caja&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;radio2&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;error pero no pasa nada&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\textEditor\TextEditor.css</h2>
<div class="codehilite"><pre><span></span><code><span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">textarea_nuevo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#FBFBFB</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo gris muy claro, casi blanco */</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c">/* Borde sutil con baja opacidad */</span>
<span class="w">    </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">border-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">textarea_nuevo</span><span class="p">:</span><span class="nd">focus</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#A0A0A0</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">outline</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span><span class="c">/* Elimina el contorno por defecto */</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#F8F8F8</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo gris muy suave, casi blanco */</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c">/* Borde sutil con baja opacidad */</span>
<span class="w">    </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">start</span><span class="p">;</span><span class="w"> </span><span class="c">/* Alinear los botones horizontalmente */</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Bordes redondeados para un diseño más suave */</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">button</span><span class="o">,</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">select</span><span class="o">,</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span><span class="w"> </span><span class="c">/* Flexbox para centrar el contenido */</span>
<span class="w">    </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span><span class="c">/* Centrar horizontalmente */</span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span><span class="c">/* Centrar verticalmente */</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#E0E0E0</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado entre elementos */</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333333</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">button</span><span class="p">:</span><span class="nd">hover</span><span class="o">,</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">select</span><span class="p">:</span><span class="nd">hover</span><span class="o">,</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="o">]</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#C5C5C5</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo más oscuro al pasar el cursor */</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">select</span><span class="o">,</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">barra_botones</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;color&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#F0F0F0</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo gris muy claro */</span>

<span class="p">}</span>

<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">textarea_nuevo</span><span class="w"> </span><span class="nt">b</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">textarea_nuevo</span><span class="w"> </span><span class="nt">i</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-style</span><span class="p">:</span><span class="w"> </span><span class="kc">italic</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">textocontenedor</span><span class="w"> </span><span class="p">.</span><span class="nc">textarea_nuevo</span><span class="w"> </span><span class="nt">u</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">underline</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\textEditor\TextEditor.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * # Editor de Texto Enriquecido</span>
<span class="cm"> * </span>
<span class="cm"> * ## Descripción:</span>
<span class="cm"> * Este script convierte los elementos `&lt;textarea&gt;` en editores de texto enriquecido,</span>
<span class="cm"> * permitiendo aplicar estilos como negrita, cursiva, subrayado, alineaciones, colores,</span>
<span class="cm"> * tamaños de fuente y listas ordenadas/desordenadas.</span>
<span class="cm"> * </span>
<span class="cm"> * ## Funcionalidades principales:</span>
<span class="cm"> * - Reemplaza los `&lt;textarea&gt;` con una versión editable (`div[contenteditable]`).</span>
<span class="cm"> * - Agrega una barra de herramientas para modificar el texto.</span>
<span class="cm"> * - Permite cambiar estilos de texto como negrita, cursiva, subrayado, color y tamaño.</span>
<span class="cm"> * - Agrega funcionalidades de alineación y listas.</span>
<span class="cm"> * - Mantiene sincronización entre el editor visual y el textarea original.</span>
<span class="cm"> */</span>



<span class="c1">// Enumeramos los elementos textarea</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">textos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;textarea&quot;</span><span class="p">);</span>

<span class="c1">// Indicamos cuántos tenemos</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;tengo&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">textos</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;textarea&quot;</span><span class="p">);</span>

<span class="nx">textos</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">textarea</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Creamos un contenedor para los textos</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenedor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;class&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;textocontenedor&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">textarea</span><span class="p">.</span><span class="nx">replaceWith</span><span class="p">(</span><span class="nx">contenedor</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">textarea</span><span class="p">);</span>
<span class="w">    </span><span class="nx">textarea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//////////////////// Creamos un div que va a ser el contenedor de los botones /////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">barra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;barra_botones&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">barra</span><span class="p">);</span>

<span class="w">    </span><span class="c1">////////////////// Botón de negrita ///////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">negrita</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">negrita</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;b&gt;B&lt;/b&gt;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">negrita</span><span class="p">);</span>
<span class="w">    </span><span class="nx">negrita</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">reemplaza</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">////////////////// Botón de cursiva ///////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">cursiva</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">cursiva</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;i&gt;I&lt;/i&gt;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">cursiva</span><span class="p">);</span>
<span class="w">    </span><span class="nx">cursiva</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">reemplaza</span><span class="p">(</span><span class="s2">&quot;i&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">////////////////// Botón de subrayado ///////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">subrayado</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">subrayado</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&lt;u&gt;U&lt;/u&gt;&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">subrayado</span><span class="p">);</span>
<span class="w">    </span><span class="nx">subrayado</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">reemplaza</span><span class="p">(</span><span class="s2">&quot;u&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">////////////////// Botón para color ///////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;input&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">color</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;color&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">color</span><span class="p">);</span>
<span class="w">    </span><span class="nx">color</span><span class="p">.</span><span class="nx">oninput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">reemplaza</span><span class="p">(</span><span class="s2">&quot;color&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">////////////////// Botón Pra el Tamaño de la fuente  ///////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tamanioFuente</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">tamanios</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="mf">11</span><span class="p">,</span><span class="mf">12</span><span class="p">,</span><span class="mf">13</span><span class="p">,</span><span class="mf">14</span><span class="p">,</span><span class="mf">15</span><span class="p">,</span><span class="mf">16</span><span class="p">,</span><span class="mf">17</span><span class="p">,</span><span class="mf">18</span><span class="p">,</span><span class="mf">19</span><span class="p">,</span><span class="mf">20</span><span class="p">];</span>
<span class="w">    </span><span class="nx">tamanios</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">tamanio</span><span class="p">){</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">opcion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span><span class="w"> </span>
<span class="w">        </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tamanio</span><span class="p">;</span>
<span class="w">        </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tamanio</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;px&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">tamanioFuente</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">opcion</span><span class="p">);</span>
<span class="w">    </span><span class="p">})</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tamanioFuente</span><span class="p">);</span>
<span class="w">    </span><span class="nx">tamanioFuente</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">reemplaza</span><span class="p">(</span><span class="s2">&quot;font-size&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">tamanioFuente</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="w"> </span><span class="p">};</span>

<span class="w">    </span><span class="c1">//////////////////// Selector de Fuente /////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">formatoFuente</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">fuentes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Arial&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Courier&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Georgia&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Times New Roman&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Verdana&quot;</span><span class="p">];</span>
<span class="w">    </span><span class="nx">fuentes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">fuente</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">opcion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuente</span><span class="p">;</span>
<span class="w">        </span><span class="nx">opcion</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fuente</span><span class="p">;</span>
<span class="w">        </span><span class="nx">formatoFuente</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">opcion</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">formatoFuente</span><span class="p">);</span>
<span class="w">    </span><span class="nx">formatoFuente</span><span class="p">.</span><span class="nx">onchange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">reemplaza</span><span class="p">(</span><span class="s2">&quot;font-family&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">formatoFuente</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="w"> </span><span class="p">};</span>

<span class="w">    </span><span class="c1">//////////////////////// PARA HACER LISTAS  //////////////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">listaOrdenada</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">listaOrdenada</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;i class=&quot;fas fa-list-ol&quot;&gt;&lt;/i&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">listaOrdenada</span><span class="p">);</span>
<span class="w">    </span><span class="nx">listaOrdenada</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">        </span><span class="nx">insertarLista</span><span class="p">(</span><span class="s2">&quot;ol&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">listaDesordenada</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">listaDesordenada</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;i class=&quot;fas fa-list-ul&quot;&gt;&lt;/i&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">listaDesordenada</span><span class="p">);</span>
<span class="w">    </span><span class="nx">listaDesordenada</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">        </span><span class="nx">insertarLista</span><span class="p">(</span><span class="s2">&quot;ul&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">//////////////////// ALINEACION DE TEXTO ////////////////////////////</span>
<span class="w">    </span><span class="c1">// Botón de alineación a la izquierda</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">alinearIzquierda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">alinearIzquierda</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;i class=&quot;fas fa-align-left&quot;&gt;&lt;/i&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">alinearIzquierda</span><span class="p">);</span>
<span class="w">    </span><span class="nx">alinearIzquierda</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">aplicarAlineacion</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Botón de alineación al centro</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">alinearCentro</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">alinearCentro</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;i class=&quot;fas fa-align-center&quot;&gt;&lt;/i&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">alinearCentro</span><span class="p">);</span>
<span class="w">    </span><span class="nx">alinearCentro</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">aplicarAlineacion</span><span class="p">(</span><span class="s2">&quot;center&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">// Botón de alineación a la derecha</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">alinearDerecha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">alinearDerecha</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;i class=&quot;fas fa-align-right&quot;&gt;&lt;/i&gt;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">barra</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">alinearDerecha</span><span class="p">);</span>
<span class="w">    </span><span class="nx">alinearDerecha</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">aplicarAlineacion</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="c1">/////////////////// Creamos el &quot;textarea&quot; editable ///////////////////</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">mitextarea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">mitextarea</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;textarea_nuevo&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">contenedor</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">mitextarea</span><span class="p">);</span>
<span class="w">    </span><span class="nx">mitextarea</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;contenteditable&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">mitextarea</span><span class="p">.</span><span class="nx">onkeypress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span><span class="nx">actualizaTextarea</span><span class="p">()}</span>


<span class="w">    </span><span class="c1">//////////////////// PARA HACER LISTAS  /////////////////</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">insertarLista</span><span class="p">(</span><span class="nx">tipo</span><span class="p">){</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">lista</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">tipo</span><span class="p">);</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;li&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">item</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Elemenyo de la lista&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">lista</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">item</span><span class="p">)</span>

<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">rango</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">getSelection</span><span class="p">().</span><span class="nx">getRangeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="w">        </span><span class="nx">rango</span><span class="p">.</span><span class="nx">deleteContents</span><span class="p">();</span>
<span class="w">        </span><span class="nx">rango</span><span class="p">.</span><span class="nx">insertNode</span><span class="p">(</span><span class="nx">lista</span><span class="p">);</span>

<span class="w">        </span><span class="nx">actualizaTextarea</span><span class="p">();</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">///////////////// Función para aplicar la alineación de texto////////////</span>

<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">aplicarAlineacion</span><span class="p">(</span><span class="nx">alineacion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mitextarea</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">alineacion</span><span class="p">;</span>
<span class="w">        </span><span class="nx">actualizaTextarea</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//////////////////// Funcion actualizar //////////////////////</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">actualizaTextarea</span><span class="p">(){</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mitextarea</span><span class="p">.</span><span class="nx">innerHTML</span><span class="p">;</span>
<span class="w">        </span><span class="nx">textarea</span><span class="p">.</span><span class="nx">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">contenido</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//////////////////// Función para reemplazar con etiquetas ////////////////////////</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">reemplaza</span><span class="p">(</span><span class="nx">etiqueta</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">textoseleccion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">getSelection</span><span class="p">().</span><span class="nx">toString</span><span class="p">();</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">textoseleccion</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">rango</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">getSelection</span><span class="p">().</span><span class="nx">getRangeAt</span><span class="p">(</span><span class="mf">0</span><span class="p">);</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">estiloTexto</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Si el argumento es &quot;color&quot;, aplica el color seleccionado</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">etiqueta</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;color&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">color</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="c1">// Si el argumento es &quot;font-size&quot;, aplica el tamaño de la fuente</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">etiqueta</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;font-size&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span>
<span class="w">            </span><span class="c1">// Si el argumento es &quot;font-family&quot;, aplica la fuente seleccionada</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">etiqueta</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s2">&quot;font-family&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;span&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">value</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="c1">// Si no es un color ni tamaño, aplica el estilo de la etiqueta correspondiente (b, i, u)</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">estiloTexto</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">etiqueta</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nx">estiloTexto</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">textoseleccion</span><span class="p">;</span>
<span class="w">            </span><span class="nx">rango</span><span class="p">.</span><span class="nx">deleteContents</span><span class="p">();</span>
<span class="w">            </span><span class="nx">rango</span><span class="p">.</span><span class="nx">insertNode</span><span class="p">(</span><span class="nx">estiloTexto</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="nx">actualizaTextarea</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\tooltip\tooltip.css</h2>
<div class="codehilite"><pre><span></span><code><span class="p">.</span><span class="nc">tooltip</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="kc">cornflowerblue</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">);</span>
<span class="w">    </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span><span class="w"> </span><span class="c">/* Asegúrate de tener esto */</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Opcional: para darle un poco de espacio interno */</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Opcional: para bordes redondeados */</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\tooltip\tooltip.js</h2>
<div class="codehilite"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">tooltip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;div&quot;</span><span class="p">);</span>
<span class="nx">tooltip</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">);</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;body&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">tooltip</span><span class="p">);</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;mousemove&quot;</span><span class="p">,</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Actualizamos la posición del tooltip</span>
<span class="w">    </span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">left</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">pageX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;px&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">top</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">pageY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;px&quot;</span><span class="p">;</span>


<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">elemento</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">elemento</span><span class="p">.</span><span class="nx">hasAttribute</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;tooltip&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">tooltip</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\vistaTabla\vistaTabla.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/**</span>
<span class="c"> * # Estilos de Tablas Dinámicas</span>
<span class="c"> *</span>
<span class="c"> * ## Descripción:</span>
<span class="c"> * Define los estilos visuales para mejorar la apariencia de las tablas.</span>
<span class="c"> *</span>
<span class="c"> * ## Funcionalidades principales:</span>
<span class="c"> * - Aplicar colores y formatos a cabeceras, filas y celdas.</span>
<span class="c"> * - Alternar colores para mejorar la legibilidad.</span>
<span class="c"> * - Resaltar filas al pasar el cursor sobre ellas.</span>
<span class="c"> */</span>

<span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="n">Arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#f0f0f0</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nt">table</span><span class="w"> </span><span class="nt">caption</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">caption-side</span><span class="p">:</span><span class="w"> </span><span class="kc">top</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#fff</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nt">table</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-collapse</span><span class="p">:</span><span class="w"> </span><span class="kc">collapse</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c">/* Cabecera con el color más intenso de la paleta */</span>
<span class="w">  </span><span class="nt">thead</span><span class="w"> </span><span class="nt">th</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#81A8B8</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">left</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#C2CBCE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c">/* Filas del cuerpo */</span>
<span class="w">  </span><span class="nt">tbody</span><span class="w"> </span><span class="nt">td</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#C2CBCE</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c">/* Filas alternas para mejorar la legibilidad */</span>
<span class="w">  </span><span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">nth-child</span><span class="o">(</span><span class="nt">odd</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#E8F3F8</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">nth-child</span><span class="o">(</span><span class="nt">even</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#DBE6EC</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c">/* Efecto hover para resaltar la fila */</span>
<span class="w">  </span><span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#A4BCC2</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\lib\vistaTabla\vistaTabla.js</h2>
<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * # Configuración Dinámica de Tablas</span>
<span class="cm"> *</span>
<span class="cm"> * ## Descripción:</span>
<span class="cm"> * Este script configura la estructura de una tabla, permitiendo:</span>
<span class="cm"> * - Extraer los datos dinámicamente desde el contenido actual.</span>
<span class="cm"> * - Ordenar las columnas al hacer clic en los encabezados.</span>
<span class="cm"> * - Agregar un contador de filas.</span>
<span class="cm"> * - Actualizar los datos de la tabla después de cada ordenación.</span>
<span class="cm"> * - Detectar nuevas tablas agregadas dinámicamente al DOM y configurarlas automáticamente.</span>
<span class="cm"> *</span>
<span class="cm"> * ## Funcionalidades principales:</span>
<span class="cm"> * - `configurarTabla(tabla)`: Configura una tabla para que sea interactiva y ordenable.</span>
<span class="cm"> * - `datosTabla()`: Pobla la tabla con los datos extraídos y ordenados.</span>
<span class="cm"> * - `MutationObserver()`: Detecta y configura nuevas tablas añadidas al DOM.</span>
<span class="cm"> */</span>

<span class="c1">// Función que configura la tabla, la ordena y la actualiza</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">configurarTabla</span><span class="p">(</span><span class="nx">tabla</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">contenido</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"> </span><span class="c1">// Superarray vacío</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">indices</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"> </span><span class="c1">// Lista de índices</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">cabeceras</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;thead tr th&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Cargar las cabeceras</span>

<span class="w">    </span><span class="c1">// Recorremos las cabeceras y asignamos los eventos de ordenación</span>
<span class="w">    </span><span class="nx">cabeceras</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">cabecera</span><span class="p">,</span><span class="w"> </span><span class="nx">colIndex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">indices</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">cabecera</span><span class="p">.</span><span class="nx">textContent</span><span class="p">.</span><span class="nx">trim</span><span class="p">());</span><span class="w"> </span><span class="c1">// Añadir cabeceras a los índices</span>

<span class="w">        </span><span class="c1">// Evento click para ordenar</span>
<span class="w">        </span><span class="nx">cabecera</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Vamos a ordenar según la columna: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">cabecera</span><span class="p">.</span><span class="nx">textContent</span><span class="p">);</span>
<span class="w">            </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vaciar el cuerpo de la tabla</span>

<span class="w">            </span><span class="c1">// Ordenamos el contenido</span>
<span class="w">            </span><span class="nx">contenido</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">valA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">colIndex</span><span class="p">]].</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">valB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">colIndex</span><span class="p">]].</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">valA</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">valB</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="nx">valA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">valA</span><span class="p">);</span>
<span class="w">                    </span><span class="nx">valB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">valB</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="nx">valA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">valB</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">valA</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">valB</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">            </span><span class="p">});</span>

<span class="w">            </span><span class="nx">datosTabla</span><span class="p">();</span><span class="w"> </span><span class="c1">// Repoblar la tabla con los datos ordenados</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// Extraemos el contenido de la tabla y lo almacenamos en `contenido`</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">registros</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;tbody tr&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">registros</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">registro</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">linea</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span><span class="w"> </span><span class="c1">// Objeto vacío por fila</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">celdas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">registro</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">celdas</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">celda</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">linea</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">index</span><span class="p">]]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">celda</span><span class="p">.</span><span class="nx">textContent</span><span class="p">.</span><span class="nx">trim</span><span class="p">();</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">        </span><span class="nx">contenido</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">linea</span><span class="p">);</span><span class="w"> </span><span class="c1">// Añade la fila al superarray</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">contenido</span><span class="p">);</span><span class="w"> </span><span class="c1">// Para depurar</span>
<span class="w">    </span><span class="nx">datosTabla</span><span class="p">();</span><span class="w"> </span><span class="c1">// Inicializamos la tabla con los datos</span>

<span class="w">    </span><span class="c1">// Función para poblar la tabla con los datos almacenados</span>
<span class="w">    </span><span class="kd">function</span><span class="w"> </span><span class="nx">datosTabla</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;thead tr&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Limpiar cabeceras</span>

<span class="w">        </span><span class="c1">// Añadimos la columna &quot;N°&quot; como contador</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">cabezal1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">cabezal1</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;N°&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;thead tr&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">cabezal1</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Añadimos las cabeceras originales</span>
<span class="w">        </span><span class="nx">indices</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">campo</span><span class="p">,</span><span class="w"> </span><span class="nx">colIndex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">cabezal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;th&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">cabezal</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">campo</span><span class="p">;</span>
<span class="w">            </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;thead tr&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">cabezal</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Evento click para reordenar</span>
<span class="w">            </span><span class="nx">cabezal</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Vamos a ordenar según la columna: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">cabezal</span><span class="p">.</span><span class="nx">textContent</span><span class="p">);</span>
<span class="w">                </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vaciar el cuerpo</span>

<span class="w">                </span><span class="c1">// Ordenamos el contenido de nuevo</span>
<span class="w">                </span><span class="nx">contenido</span><span class="p">.</span><span class="nx">sort</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">valA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">a</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">colIndex</span><span class="p">]].</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">                    </span><span class="kd">let</span><span class="w"> </span><span class="nx">valB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">b</span><span class="p">[</span><span class="nx">indices</span><span class="p">[</span><span class="nx">colIndex</span><span class="p">]].</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">valA</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nb">isNaN</span><span class="p">(</span><span class="nx">valB</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nx">valA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">valA</span><span class="p">);</span>
<span class="w">                        </span><span class="nx">valB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">parseFloat</span><span class="p">(</span><span class="nx">valB</span><span class="p">);</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="k">return</span><span class="w"> </span><span class="nx">valA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="nx">valB</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">valA</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="nx">valB</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mf">1</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span>
<span class="w">                </span><span class="p">});</span>

<span class="w">                </span><span class="nx">datosTabla</span><span class="p">();</span><span class="w"> </span><span class="c1">// Repoblar la tabla con los datos ordenados</span>
<span class="w">            </span><span class="p">};</span>
<span class="w">        </span><span class="p">});</span>

<span class="w">        </span><span class="c1">// Limpiar el cuerpo de la tabla antes de repoblar</span>
<span class="w">        </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">contador</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Recorremos los datos y reconstruimos las filas de la tabla</span>
<span class="w">        </span><span class="nx">contenido</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">linea</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">fila</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;tr&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Añadimos la celda de &quot;Contador&quot; con el número de fila</span>
<span class="w">            </span><span class="kd">let</span><span class="w"> </span><span class="nx">celda1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="nx">celda1</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">contador</span><span class="p">;</span>
<span class="w">            </span><span class="nx">fila</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">celda1</span><span class="p">);</span>
<span class="w">            </span><span class="nx">contador</span><span class="o">++</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// Añadimos las celdas de los datos</span>
<span class="w">            </span><span class="nx">indices</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">campo</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">let</span><span class="w"> </span><span class="nx">celda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;td&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="nx">celda</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">linea</span><span class="p">[</span><span class="nx">campo</span><span class="p">];</span>
<span class="w">                </span><span class="nx">fila</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">celda</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>

<span class="w">            </span><span class="c1">// Añadimos la fila al cuerpo de la tabla</span>
<span class="w">            </span><span class="nx">tabla</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;tbody&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">fila</span><span class="p">);</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Inicializamos las tablas con el ID &quot;vistaTabla&quot;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;#vistaTabla&quot;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">configurarTabla</span><span class="p">);</span>

<span class="c1">// Observamos nuevos elementos en el DOM</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">observer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">MutationObserver</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">mutations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">mutations</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">mutation</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">mutation</span><span class="p">.</span><span class="nx">addedNodes</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">node</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="s2">&quot;vistaTabla&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nx">configurarTabla</span><span class="p">(</span><span class="nx">node</span><span class="p">);</span><span class="w"> </span><span class="c1">// Configura la nueva tabla añadida</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>

<span class="c1">// Observamos todo el cuerpo para agregar nuevas tablas dinámicamente</span>
<span class="nx">observer</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">childList</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">subtree</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="p">});</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\cabecera\cabecera.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* Estilo del header */</span>
<span class="nt">header</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span><span class="c">/* Verde azulado medio */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto en azul claro */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">2.5</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Línea azul oscuro */</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra sutil */</span>
<span class="p">}</span>


<span class="c">/* Posicionar el contenedor en la esquina superior izquierda */</span>
<span class="p">#</span><span class="nn">contenedor-usuario</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espacio desde la parte superior */</span>
<span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espacio desde la parte izquierda */</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado entre los elementos */</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">flex-start</span><span class="p">;</span><span class="w"> </span><span class="c">/* Alinear los elementos a la izquierda */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado dentro del contenedor */</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Bordes redondeados */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto en azul oscuro */</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del nombre del usuario */</span>
<span class="p">#</span><span class="nn">nombre-usuario</span><span class="p">{</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo de los botones */</span>
<span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="kc">transparent</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="nt">button</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo al pasar el cursor */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color de texto al pasar el cursor */</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.05</span><span class="p">);</span><span class="w"> </span><span class="c">/* Efecto de ampliación */</span>
<span class="p">}</span>


<span class="p">#</span><span class="nn">correo-iframe</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/** ESTILO CON MEDIA PRINT ***/</span>
<span class="p">@</span><span class="k">media</span><span class="w"> </span><span class="nt">print</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c">/* Ocultamos elementos innecesarios */</span>
<span class="w">  </span><span class="nt">header</span><span class="o">,</span><span class="w"> </span><span class="nt">nav</span><span class="o">,</span><span class="w"> </span><span class="p">.</span><span class="nc">ampliador</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nt">iframe</span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kc">auto</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">    </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">visible</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="c">/* Asegurar que el main section ocupe todo el espacio */</span>
<span class="w">  </span><span class="nt">main</span><span class="w"> </span><span class="nt">section</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="kc">auto</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">visible</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c">/* Evitamos que el contenido tenga scroll o se recorte */</span>
<span class="w">  </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">zoom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c">/* Ajuste de imágenes para evitar que se recorten */</span>
<span class="w">  </span><span class="nt">img</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">      </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="kc">auto</span><span class="w"> </span><span class="cp">!important</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c">/* Asegurar que toda la página use el tamaño adecuado */</span>
<span class="w">  </span><span class="p">@</span><span class="k">page</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">size</span><span class="o">:</span><span class="w"> </span><span class="nt">A4</span><span class="o">;</span>
<span class="w">      </span><span class="nt">margin</span><span class="o">:</span><span class="w"> </span><span class="nt">15mm</span><span class="o">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="c">/******************* Estilos para el modal de ayuda  ********************************/</span>
<span class="p">.</span><span class="nc">modal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">fixed</span><span class="p">;</span>
<span class="w">  </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>
<span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span><span class="w"> </span>
<span class="p">}</span>

<span class="c">/* Estilos para el contenido del modal */</span>
<span class="p">.</span><span class="nc">modal-contenido</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">700</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">%</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.3</span><span class="p">);</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">relative</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilos para el botón &quot;X&quot; */</span>
<span class="p">.</span><span class="nc">cerrar</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">right</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="kc">red</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Efecto hover para el botón &quot;X&quot; */</span>
<span class="p">.</span><span class="nc">cerrar</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="kc">darkred</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.1</span><span class="p">);</span>
<span class="p">}</span>

<span class="c">/* Ajustar el iframe dentro del modal */</span>
<span class="p">#</span><span class="nn">iframe-ayuda</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\cabecera\cabecera.js</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// Función para mostrar el nombre de usuario guardado en localStorage</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">mostrarUsuario</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">nombreUsuario</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;nombre_usuario&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">nombreUsuario</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">usuarioElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;nombre-usuario&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">usuarioElement</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">usuarioElement</span><span class="p">.</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">nombreUsuario</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Función para cerrar sesión</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">logout</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#logout&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;nombre_usuario&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">localStorage</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;crismon1_usuario&#39;</span><span class="p">);</span>
<span class="w">      </span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;../index.html&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Función para abrir el correo electrónico en un iframe</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">abrirCorreo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#correo&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">section</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">section</span><span class="p">.</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">section</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="kd">let</span><span class="w"> </span><span class="nx">marco</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;iframe&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">marco</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;http://localhost:5000/&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">marco</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;correo-iframe&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="nx">section</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">marco</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Función para imprimir la sección (si existe un iframe se intenta imprimir su contenido)</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">imprimir</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#imprimir&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">var</span><span class="w"> </span><span class="nx">iframe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;section iframe&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">iframe</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>
<span class="w">          </span><span class="nx">iframe</span><span class="p">.</span><span class="nx">contentWindow</span><span class="p">.</span><span class="nx">print</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nb">window</span><span class="p">.</span><span class="nx">print</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nb">window</span><span class="p">.</span><span class="nx">print</span><span class="p">();</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">};</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\cabecera\cabecera.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;header&gt;</span>
<span class="x">  supercontrolador</span>
<span class="x">  &lt;div id=&quot;contenedor-usuario&quot;&gt;</span>
<span class="x">    &lt;div id=&quot;nombre-usuario&quot;&gt;&lt;/div&gt;</span>
<span class="x">    &lt;div class=&quot;boton email&quot;&gt;</span>
<span class="x">      &lt;button id=&quot;correo&quot; tooltip=&quot;Entrar en el correo&quot;&gt;🖂&lt;/button&gt;</span>
<span class="x">      &lt;button id=&quot;ayuda&quot; tooltip=&quot;Consultar ayuda&quot;&gt;❔&lt;/button&gt;</span>
<span class="x">      &lt;button id=&quot;imprimir&quot; tooltip=&quot;Imprimir sección&quot;&gt;🖨️&lt;/button&gt; </span>
<span class="x">      &lt;button id=&quot;logout&quot; tooltip=&quot;Salir de la Aplicación&quot;&gt;Salir&lt;/button&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">  &lt;/div&gt;</span>
<span class="x">&lt;/header&gt;</span>

<span class="x">&lt;script&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/cabecera/cabecera.js&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/script&gt;</span>
<span class="x">&lt;style&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/cabecera/cabecera.css&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/style&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\cierre\cierre.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* Estilo del footer */</span>

<span class="nt">footer</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-top</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">-4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\cierre\cierre.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;footer&gt;</span>
<span class="x">  (c)Crismon</span>
<span class="x">&lt;/footer&gt;</span>
<span class="x">&lt;/body&gt;</span>


<span class="x">&lt;/html&gt;</span>

<span class="x">&lt;style&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/cierre/cierre.css&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/style&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\librerias\librerias.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;!-- Estilos de las librerías --&gt;</span>
<span class="x">&lt;link rel=&quot;stylesheet&quot; href=&quot;lib/selectjv/selectjv.css&quot;&gt;</span>
<span class="x">&lt;link rel=&quot;stylesheet&quot; href=&quot;lib/ampliador/ampliador.css&quot;&gt;</span>
<span class="x">&lt;link rel=&quot;stylesheet&quot; href=&quot;lib/texteditor/TextEditor.css&quot;&gt;</span>
<span class="x">&lt;link rel=&quot;stylesheet&quot; href=&quot;lib/tooltip/tooltip.css&quot;&gt;</span>
<span class="x">&lt;link rel=&quot;stylesheet&quot; href=&quot;lib/vistaTabla/vistaTabla.css&quot;&gt;</span>

<span class="x">&lt;!-- Scripts de las librerías --&gt;</span>
<span class="x">&lt;script src=&quot;js/convierteTipoDato.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;js/crearMenuTablas.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;js/funciones.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;lib/texteditor/TextEditor.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;js/cargaDatosTabla.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;js/pueblaTabla.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;comportamiento.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;js/cargarDatosColeccion.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;lib/selectjv/selectjv.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;lib/ampliador/ampliador.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;lib/tooltip/tooltip.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;lib/graficos/graficos.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">&lt;script src=&quot;lib/vistaTabla/vistaTabla.js&quot;&gt;&lt;/script&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\modal\modal.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/******************* ESTILO VENTANA EMERGENTE ************************/</span>

<span class="c">/* Modal */</span>
<span class="p">#</span><span class="nn">modal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">fixed</span><span class="p">;</span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">);</span>
<span class="w">  </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilos para las animaciones de aparición y desaparición */</span>
<span class="p">.</span><span class="nc">aparece</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">animation</span><span class="p">:</span><span class="w"> </span><span class="n">animaparece</span><span class="w"> </span><span class="mi">1</span><span class="kt">s</span><span class="w"> </span><span class="kc">forwards</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="k">keyframes</span><span class="w"> </span><span class="nt">animaparece</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">0</span><span class="o">%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nt">100</span><span class="o">%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">desaparece</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">animation</span><span class="p">:</span><span class="w"> </span><span class="n">animdesaparece</span><span class="w"> </span><span class="mi">1</span><span class="kt">s</span><span class="w"> </span><span class="kc">forwards</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">@</span><span class="k">keyframes</span><span class="w"> </span><span class="nt">animdesaparece</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nt">0</span><span class="o">%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nt">100</span><span class="o">%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c">/* Contenido del Modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">80</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">fixed</span><span class="p">;</span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">left</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translate</span><span class="p">(</span><span class="mi">-50</span><span class="kt">%</span><span class="p">,</span><span class="w"> </span><span class="mi">-50</span><span class="kt">%</span><span class="p">);</span>
<span class="p">}</span>

<span class="c">/* Título dentro del Modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">h1</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Section dentro del Modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">section</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">column-count</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="k">column-gap</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">left</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Divs dentro del Section del Modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">div</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">break-inside</span><span class="p">:</span><span class="w"> </span><span class="kc">avoid-column</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Contenedores de Inputs en Modal */</span>
<span class="p">.</span><span class="nc">input-container</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="nb">calc</span><span class="p">(</span><span class="mi">50</span><span class="kt">%</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">);</span>
<span class="w">  </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Párrafos dentro del Modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Inputs dentro del Modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">input</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">outline</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">border-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">input</span><span class="p">:</span><span class="nd">focus</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">border-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span><span class="w"> </span><span class="mi">169</span><span class="p">,</span><span class="w"> </span><span class="mi">169</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#F0F8FF</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Botón Enviar en el modal */</span>
<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">button</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">contienemodal</span><span class="w"> </span><span class="nt">button</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.05</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\modal\modal.js</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// --- Ventana modal para INSERTAR REGISTROS ---</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#insertar&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;desaparece&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;aparece&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;aparece&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;desaparece&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="mf">1000</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#contienemodal&quot;</span><span class="p">).</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">event</span><span class="p">.</span><span class="nx">stopPropagation</span><span class="p">();</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// --- Ventana modal para AYUDA ---</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">ayudaBtn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#ayuda&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">modalAyuda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#modal-ayuda&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">iframeAyuda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#iframe-ayuda&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="kd">let</span><span class="w"> </span><span class="nx">cerrarAyuda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s2">&quot;#cerrar-ayuda&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="nx">ayudaBtn</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">modalAyuda</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;block&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">iframeAyuda</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ayuda/&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nx">cerrarAyuda</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">modalAyuda</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="nx">iframeAyuda</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="nb">window</span><span class="p">.</span><span class="nx">onclick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">modalAyuda</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">modalAyuda</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">      </span><span class="nx">iframeAyuda</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">};</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\modal\modal.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;div id=&quot;modal&quot;&gt;</span>
<span class="x">      &lt;div id=&quot;contienemodal&quot;&gt;&lt;/div&gt;</span>
<span class="x">    &lt;/div&gt; </span>

<span class="x">    &lt;!-- Modal para la ventana flotante de ayuda --&gt;</span>
<span class="x">    &lt;div id=&quot;modal-ayuda&quot; class=&quot;modal&quot;&gt;</span>
<span class="x">      &lt;div class=&quot;modal-contenido&quot;&gt;</span>
<span class="x">          &lt;button class=&quot;cerrar&quot; id=&quot;cerrar-ayuda&quot;&gt;❌&lt;/button&gt;</span>
<span class="x">          &lt;iframe id=&quot;iframe-ayuda&quot; src=&quot;&quot; style=&quot;width: 100%; height: 500px; border: none;&quot;&gt;&lt;/iframe&gt;</span>
<span class="x">      &lt;/div&gt;</span>
<span class="x">  &lt;/div&gt;</span>

<span class="x">&lt;script&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/modal/modal.js&quot;</span><span class="p">);</span><span class="cp">?&gt;</span><span class="x">&lt;/script&gt;</span>
<span class="x">&lt;style&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/modal/modal.css&quot;</span><span class="p">);</span><span class="cp">?&gt;</span><span class="x">&lt;/style&gt;</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\principal\principal.css</h2>
<div class="codehilite"><pre><span></span><code><span class="nt">main</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="k">grid</span><span class="p">;</span>
<span class="w">  </span><span class="k">grid-template-columns</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="kt">px</span><span class="w"> </span><span class="mi">1</span><span class="n">fr</span><span class="p">;</span><span class="w"> </span><span class="c">/* Barra lateral y contenido */</span>
<span class="w">  </span><span class="n">grid-gap</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del nav (barra lateral) */</span>
<span class="nt">main</span><span class="w"> </span><span class="nt">nav</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">250</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo azul muy claro */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra suave */</span>
<span class="p">}</span>

<span class="c">/* Estilo de los items de la lista */</span>
<span class="nt">nav</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">nav</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="nt">li</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">list-style</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">;</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">,</span><span class="w"> </span><span class="k">opacity</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">  </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="p">;</span><span class="w"> </span>

<span class="p">}</span>

<span class="nt">nav</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="nt">li</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">opacity</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.05</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>

<span class="p">}</span>


<span class="c">/* Estilo para el icono dentro de los elementos de la lista */</span>
<span class="nt">nav</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="nt">li</span><span class="w"> </span><span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="nt">img</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">toggleConsola</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="kc">transparent</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* Estilo para la sección principal */</span>
<span class="nt">main</span><span class="w"> </span><span class="nt">section</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo azul claro */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra suave */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Texto azul oscuro */</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>

<span class="w">  </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Título de la sección */</span>
<span class="nt">section</span><span class="w"> </span><span class="nt">h2</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>


<span class="c">/* Estilos para la tabla */</span>
<span class="nt">table</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span><span class="c">/* Ancho completo */</span>
<span class="w">  </span><span class="k">border-collapse</span><span class="p">:</span><span class="w"> </span><span class="kc">collapse</span><span class="p">;</span><span class="w"> </span><span class="c">/* Colapsar bordes */</span>
<span class="w">  </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espacio superior */</span>
<span class="p">}</span>

<span class="c">/* Estilo para el encabezado de la tabla */</span>
<span class="nt">table</span><span class="w"> </span><span class="nt">thead</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo para encabezados */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color de texto en encabezados */</span>
<span class="p">}</span>

<span class="nt">table</span><span class="w"> </span><span class="nt">th</span><span class="p">{</span>
<span class="w">  </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">table</span><span class="w"> </span><span class="nt">th</span><span class="o">,</span><span class="w"> </span><span class="nt">table</span><span class="w"> </span><span class="nt">td</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Aumentar el espaciado interno */</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">left</span><span class="p">;</span><span class="w"> </span><span class="c">/* Alinear texto a la izquierda */</span>
<span class="w">  </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Línea debajo de cada celda */</span>
<span class="w">  </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.05</span><span class="kt">rem</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado entre letras */</span>
<span class="p">}</span>

<span class="nt">table</span><span class="w"> </span><span class="nt">tr</span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* Estilo para filas del cuerpo */</span>
<span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color de fondo al hacer hover en filas */</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color de texto al hacer hover */</span>
<span class="p">}</span>

<span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">nth-child</span><span class="o">(</span><span class="nt">even</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo alternativo para filas */</span>
<span class="p">}</span>


<span class="c">/********************** ESTILO TITULO TABLA *******************/</span>

<span class="p">.</span><span class="nc">titulotabla</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">relative</span><span class="p">;</span><span class="w">  </span>


<span class="p">}</span>

<span class="p">.</span><span class="nc">titulotabla</span><span class="w"> </span><span class="nt">h5</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.8</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="w">  </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.05</span><span class="kt">rem</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">titulotabla</span><span class="w"> </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton</span><span class="p">{</span>

<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>

<span class="p">}</span>
<span class="p">.</span><span class="nc">botoneliminar</span><span class="p">{</span>
<span class="w">  </span><span class="k">background</span><span class="p">:</span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="p">}</span>


<span class="nt">li</span><span class="w"> </span><span class="p">.</span><span class="nc">botontabla</span><span class="p">{</span><span class="w"> </span>
<span class="w">  </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="c">/*background:#4D869C; */</span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">botonlupa</span><span class="p">{</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">);</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="p">.</span><span class="nc">botndocumento</span><span class="p">{</span>
<span class="w">  </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="c">/*background:#4D869C; */</span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="nt">img</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Ajusta el tamaño del ícono */</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-right</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espacio entre ícono y texto */</span>
<span class="p">}</span>


<span class="nt">article</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">border-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span><span class="w"> </span><span class="mi">169</span><span class="p">,</span><span class="w"> </span><span class="mi">169</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#F0F8FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">);</span>
<span class="p">}</span>
<span class="nt">table</span><span class="w"> </span><span class="nt">article</span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="mi">200</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">grey</span><span class="p">;</span>
<span class="w">    </span><span class="k">background</span><span class="p">:</span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.4</span><span class="p">);</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="kc">inline-block</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">correo-iframe</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>


<span class="c">/******************************* BOTÓN INSERTAR *******************/</span>

<span class="p">#</span><span class="nn">insertar</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">height</span><span class="p">:</span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">absolute</span><span class="p">;</span>
<span class="w">  </span><span class="k">right</span><span class="p">:</span><span class="w"> </span><span class="mi">96</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="k">top</span><span class="p">:</span><span class="mi">40</span><span class="kt">%</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">#</span><span class="nn">insertar</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.1</span><span class="p">);</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.2</span><span class="p">);</span>
<span class="p">}</span>


<span class="c">/**************************** ESTILO PARA CARTA MONGO ************/</span>

<span class="c">/* Contenedor de las tarjetas */</span>
<span class="p">#</span><span class="nn">docsContainer</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span><span class="w">  </span><span class="c">/* Asegura que los elementos se alineen en fila */</span>
<span class="w">  </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">row</span><span class="p">;</span><span class="w"> </span><span class="c">/* Alineación horizontal */</span>
<span class="w">  </span><span class="k">flex-wrap</span><span class="p">:</span><span class="w"> </span><span class="kc">wrap</span><span class="p">;</span><span class="w"> </span><span class="c">/* Permite que las tarjetas pasen a la siguiente línea si no caben */</span>
<span class="w">  </span><span class="k">gap</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Espaciado entre tarjetas */</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span><span class="c">/* Centra las tarjetas en el contenedor */</span>
<span class="p">}</span>

<span class="c">/* Estilos de las tarjetas */</span>
<span class="p">.</span><span class="nc">document-card</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#ffffff</span><span class="p">;</span>
<span class="w">  </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#ddd</span><span class="p">;</span>
<span class="w">  </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Tamaño fijo para mantener consistencia */</span>
<span class="w">  </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">transform</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease-in-out</span><span class="p">,</span><span class="w"> </span><span class="k">box-shadow</span><span class="w"> </span><span class="mf">0.2</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease-in-out</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">document-card</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">translateY</span><span class="p">(</span><span class="mi">-5</span><span class="kt">px</span><span class="p">);</span>
<span class="w">  </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="w"> </span><span class="mi">6</span><span class="kt">px</span><span class="w"> </span><span class="mi">12</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.15</span><span class="p">);</span>
<span class="p">}</span>

<span class="c">/* Título de cada tarjeta */</span>
<span class="p">.</span><span class="nc">document-card</span><span class="w"> </span><span class="nt">h3</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">em</span><span class="p">;</span>
<span class="w">  </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#333</span><span class="p">;</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Contenido dentro de la tarjeta */</span>
<span class="p">.</span><span class="nc">document-card</span><span class="w"> </span><span class="nt">div</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="kt">em</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#555</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Listas dentro del contenido JSON */</span>
<span class="p">.</span><span class="nc">document-card</span><span class="w"> </span><span class="nt">ul</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="kc">square</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding-left</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Claves dentro del JSON */</span>
<span class="p">.</span><span class="nc">document-card</span><span class="w"> </span><span class="nt">strong</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#007BFF</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilos para el mensaje de &quot;No hay documentos&quot; */</span>
<span class="p">#</span><span class="nn">docsContainer</span><span class="w"> </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
<span class="w">  </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1</span><span class="kt">em</span><span class="p">;</span>
<span class="w">  </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#666</span><span class="p">;</span>
<span class="w">  </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\principal\principal.js</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// Función para listar las tablas según la aplicación seleccionada</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">listadoTablas</span><span class="p">(</span><span class="nx">aplicacion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=listatablasaplicacion&amp;aplicacion=&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">aplicacion</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">datos</span><span class="p">);</span>
<span class="w">        </span><span class="c1">// Se asume que la función crearMenuTablas está definida en otro módulo o archivo</span>
<span class="w">        </span><span class="nx">crearMenuTablas</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;tabla&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar tablas:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Función para listar las colecciones de MongoDB</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">listadoDocumentos</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=listacolecciones&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">&quot;Vamos con las colecciones&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">datos</span><span class="p">);</span>
<span class="w">        </span><span class="nx">crearMenuTablas</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;coleccion&quot;</span><span class="p">);</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar colecciones:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Función para cargar la gráfica</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">cargaGraficas</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;../../servidor/?o=datosgrafica&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">result</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">result</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">graficoPastel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">GeneradorGrafica</span><span class="p">(</span><span class="nx">datos</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#20B2AA&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;table tbody&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;AQUI VA EL TITULO DE LA GRÁFICA&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="nx">graficoPastel</span><span class="p">.</span><span class="nx">creargrafica</span><span class="p">();</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar gráfica:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="c1">// Función para cargar las aplicaciones desde el JSON</span>
<span class="w">  </span><span class="kd">function</span><span class="w"> </span><span class="nx">cargoAplicaciones</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;apps/apps.json&quot;</span><span class="p">)</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">response</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="w">      </span><span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">datos</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">datos</span><span class="p">);</span>
<span class="w">        </span><span class="nx">aplicaciones</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">datos</span><span class="p">;</span>
<span class="w">      </span><span class="p">})</span>
<span class="w">      </span><span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">error</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s2">&quot;Error al cargar aplicaciones:&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">));</span>
<span class="w">  </span><span class="p">}</span>
</code></pre></div>

<h2>cliente\supercontrolador\modulos\principal\principal.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;main&gt;</span>
<span class="x">  &lt;nav&gt;</span>
<span class="x">    &lt;ul&gt;</span>
<span class="x">      &lt;!-- Aquí se irán creando los elementos de navegación mediante JavaScript --&gt;</span>
<span class="x">    &lt;/ul&gt;</span>
<span class="x">  &lt;/nav&gt;</span>

<span class="x">  &lt;section&gt;</span>

<span class="x">    &lt;div class=&quot;titulotabla&quot;&gt;</span>
<span class="x">      &lt;button id=&quot;insertar&quot; tooltip=&quot;Insertar nuevo registro&quot;&gt;+&lt;/button&gt;</span>
<span class="x">      &lt;h5&gt;Clientes&lt;/h5&gt;</span>
<span class="x">      &lt;p&gt;Aquí podremos ver los registros e ingresar nuevos&lt;/p&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">    &lt;table&gt;</span>
<span class="x">      &lt;thead&gt;</span>
<span class="x">        &lt;tr&gt;&lt;/tr&gt;</span>
<span class="x">      &lt;/thead&gt;</span>
<span class="x">      &lt;tbody&gt;&lt;/tbody&gt;</span>
<span class="x">    &lt;/table&gt;</span>
<span class="x">  &lt;/section&gt;</span>
<span class="x">&lt;/main&gt;</span>
<span class="x">&lt;script&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/principal/principal.js&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/script&gt;</span>
<span class="x">&lt;style&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;modulos/principal/principal.css&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/style&gt;</span>
</code></pre></div>

<h2>formularios\descargar.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * ##  Funcionalidad:</span>
<span class="sd"> * - Permite descargar un documento JSON almacenado en `documentos/`.</span>
<span class="sd"> */</span>

<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;archivo&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nv">$archivo</span> <span class="o">=</span> <span class="s1">&#39;documentos/&#39;</span> <span class="o">.</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;archivo&#39;</span><span class="p">]);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">))</span> <span class="p">{</span>
        <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">);</span>
        <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition: attachment; filename=&quot;&#39;</span> <span class="o">.</span> <span class="nb">basename</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">);</span>
        <span class="nb">readfile</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s2">&quot;Error: Archivo no encontrado.&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">echo</span> <span class="s2">&quot;Error: No se especificó ningún archivo.&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>formularios\documentos.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * ## Funcionalidad:</span>
<span class="sd"> * - Muestra los documentos generados en `documentos/{formulario}/`.</span>
<span class="sd"> * - Lista los archivos JSON guardados para cada formulario.</span>
<span class="sd"> * - Permite visualizar y descargar los archivos JSON generados.</span>
<span class="sd"> */</span>

<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span>

<span class="cp">?&gt;</span>

<span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="x">&lt;head&gt;</span>
<span class="x">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="x">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="x">    &lt;title&gt;Documentos - </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;formulario&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;formulario&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="s1">&#39;No especificado&#39;</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&lt;/title&gt;</span>
<span class="x">    &lt;link rel=&quot;stylesheet&quot; href=&quot;/formularios/estilo.css&quot;&gt;</span>
<span class="x">    &lt;style&gt;</span>
<span class="x">        /* Estilo general */</span>
<span class="x">        body {</span>
<span class="x">            font-family: &#39;Segoe UI&#39;, Tahoma, Geneva, Verdana, sans-serif;</span>
<span class="x">            background-color: #CDE8E5;</span>
<span class="x">            color: #4D869C;</span>
<span class="x">            text-align: center;</span>
<span class="x">            margin: 0;</span>
<span class="x">            padding: 0;</span>
<span class="x">        }</span>

<span class="x">        .contenedor {</span>
<span class="x">            max-width: 800px;</span>
<span class="x">            margin: 30px auto;</span>
<span class="x">            background: white;</span>
<span class="x">            padding: 20px;</span>
<span class="x">            border-radius: 8px;</span>
<span class="x">            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);</span>
<span class="x">        }</span>

<span class="x">        h1 {</span>
<span class="x">            color: #4D869C;</span>
<span class="x">            font-size: 2rem;</span>
<span class="x">        }</span>

<span class="x">        .mensaje {</span>
<span class="x">            font-size: 1rem;</span>
<span class="x">            padding: 10px;</span>
<span class="x">            border-radius: 5px;</span>
<span class="x">            margin-bottom: 15px;</span>
<span class="x">            text-align: center;</span>
<span class="x">        }</span>

<span class="x">        .error {</span>
<span class="x">            background-color: #f8d7da;</span>
<span class="x">            color: #721c24;</span>
<span class="x">            border: 1px solid #f5c6cb;</span>
<span class="x">        }</span>

<span class="x">        .info {</span>
<span class="x">            background-color: #d1ecf1;</span>
<span class="x">            color: #0c5460;</span>
<span class="x">            border: 1px solid #bee5eb;</span>
<span class="x">        }</span>

<span class="x">        .warning {</span>
<span class="x">            background-color: #fff3cd;</span>
<span class="x">            color: #856404;</span>
<span class="x">            border: 1px solid #ffeeba;</span>
<span class="x">        }</span>

<span class="x">        table {</span>
<span class="x">            width: 100%;</span>
<span class="x">            border-collapse: collapse;</span>
<span class="x">            margin-top: 20px;</span>
<span class="x">        }</span>

<span class="x">        th, td {</span>
<span class="x">            padding: 12px;</span>
<span class="x">            border: 1px solid #ddd;</span>
<span class="x">            text-align: left;</span>
<span class="x">        }</span>

<span class="x">        th {</span>
<span class="x">            background-color: #7AB2B2;</span>
<span class="x">            color: white;</span>
<span class="x">        }</span>

<span class="x">        td a {</span>
<span class="x">            text-decoration: none;</span>
<span class="x">            color: #007bff;</span>
<span class="x">            padding: 8px 12px;</span>
<span class="x">            border-radius: 4px;</span>
<span class="x">            transition: background 0.3s ease;</span>
<span class="x">        }</span>

<span class="x">        td a:hover {</span>
<span class="x">            text-decoration: underline;</span>
<span class="x">        }</span>

<span class="x">        .boton-volver {</span>
<span class="x">            display: inline-block;</span>
<span class="x">            margin-top: 20px;</span>
<span class="x">            background-color: #7AB2B2;</span>
<span class="x">            color: white;</span>
<span class="x">            padding: 10px 15px;</span>
<span class="x">            border-radius: 5px;</span>
<span class="x">            text-decoration: none;</span>
<span class="x">            transition: background 0.3s ease;</span>
<span class="x">        }</span>

<span class="x">        .boton-volver:hover {</span>
<span class="x">            background-color: #4D869C;</span>
<span class="x">        }</span>
<span class="x">    &lt;/style&gt;</span>
<span class="x">&lt;/head&gt;</span>
<span class="x">&lt;body&gt;</span>

<span class="x">&lt;div class=&quot;contenedor&quot;&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span>
    <span class="c1">// Obtener el nombre del formulario desde la URL</span>
    <span class="nv">$formulario</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;formulario&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[^a-zA-Z0-9_-]/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;formulario&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="k">null</span><span class="p">;</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$formulario</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&lt;p class=&quot;mensaje error&quot;&gt; Error: No se especificó un formulario en la URL.&lt;/p&gt;&#39;</span><span class="p">;</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">echo</span> <span class="s2">&quot;&lt;h1&gt;Documentos Generados para &lt;span style=&#39;color: #7AB2B2;&#39;&gt;&quot;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$formulario</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&lt;/span&gt;&lt;/h1&gt;&quot;</span><span class="p">;</span>

    <span class="c1">// Definir la carpeta específica de documentos para el formulario</span>
    <span class="nv">$carpeta_documentos</span> <span class="o">=</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/documentos/</span><span class="si">{</span><span class="nv">$formulario</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">;</span>

    <span class="c1">// Verificar si la carpeta del formulario existe</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$carpeta_documentos</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$archivos</span> <span class="o">=</span> <span class="nb">array_diff</span><span class="p">(</span><span class="nb">scandir</span><span class="p">(</span><span class="nv">$carpeta_documentos</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">));</span> <span class="c1">// Obtener archivos</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">count</span><span class="p">(</span><span class="nv">$archivos</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&lt;table&gt;&#39;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s1">&#39;&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Nombre del Documento&lt;/th&gt;&lt;th&gt;Acciones&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&#39;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s1">&#39;&lt;tbody&gt;&#39;</span><span class="p">;</span>

            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$archivos</span> <span class="k">as</span> <span class="nv">$documento</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$documento</span><span class="p">,</span> <span class="nx">PATHINFO_EXTENSION</span><span class="p">)</span> <span class="o">===</span> <span class="s1">&#39;json&#39;</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$documento</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;a href=&quot;vista.php?archivo=&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$formulario</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$documento</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot; class=&quot;boton-ver&quot;&gt;Ver&lt;/a&gt; &#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;a href=&quot;descargar.php?archivo=&#39;</span> <span class="o">.</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nv">$formulario</span> <span class="o">.</span> <span class="s1">&#39;/&#39;</span> <span class="o">.</span> <span class="nv">$documento</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot; class=&quot;boton-descargar&quot;&gt;Descargar&lt;/a&gt;&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">echo</span> <span class="s1">&#39;&lt;/tbody&gt;&#39;</span><span class="p">;</span>
            <span class="k">echo</span> <span class="s1">&#39;&lt;/table&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">echo</span> <span class="s1">&#39;&lt;p class=&quot;mensaje warning&quot;&gt;No se encontraron documentos para este formulario.&lt;/p&gt;&#39;</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="s1">&#39;&lt;p class=&quot;mensaje error&quot;&gt;No se encontró la carpeta de documentos para este formulario.&lt;/p&gt;&#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="cp">?&gt;</span>

<span class="x">    &lt;a href=&quot;panel.php&quot; class=&quot;boton-volver&quot;&gt;Volver al Panel&lt;/a&gt;</span>
<span class="x">&lt;/div&gt;</span>

<span class="x">&lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</code></pre></div>

<h2>formularios\envia.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="cm">/*</span>
<span class="cm">*    Recibe los datos enviados desde index.php.</span>
<span class="cm">*    Valida los datos según las reglas definidas en el JSON del formulario.</span>
<span class="cm">*    Guarda la información en un archivo JSON dentro de documentos/{formulario}/.</span>
<span class="cm">*</span>
<span class="cm">*/</span>

<span class="c1">// Habilitar la visualización de errores para depuración</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span>

<span class="c1">// Obtener los datos enviados por el formulario</span>
<span class="nv">$datosenviados</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">;</span>

<span class="c1">// Verificar si el formulario fue enviado</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;formulario&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error: No se recibió el nombre del formulario.&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Sanitizar el nombre del formulario para evitar problemas con rutas</span>
<span class="nv">$formulario</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[^a-zA-Z0-9_-]/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;formulario&#39;</span><span class="p">]);</span>

<span class="c1">// Definir la carpeta de destino dentro de `documentos/`</span>
<span class="nv">$carpeta_destino</span> <span class="o">=</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/documentos/</span><span class="si">{</span><span class="nv">$formulario</span><span class="si">}</span><span class="s2">/&quot;</span><span class="p">;</span>

<span class="c1">// **Si la carpeta no existe, crearla**</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$carpeta_destino</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">mkdir</span><span class="p">(</span><span class="nv">$carpeta_destino</span><span class="p">,</span> <span class="mo">0777</span><span class="p">,</span> <span class="k">true</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error: No se pudo crear la carpeta &#39;</span><span class="si">{</span><span class="nv">$carpeta_destino</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Generar un nombre de archivo único basado en la fecha y hora actual</span>
<span class="nv">$nombre_archivo</span> <span class="o">=</span> <span class="nv">$carpeta_destino</span> <span class="o">.</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Ymd_His&#39;</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;.json&quot;</span><span class="p">;</span>

<span class="c1">// Guardar los datos en el archivo JSON dentro de la carpeta del formulario</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$nombre_archivo</span><span class="p">,</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$datosenviados</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">))</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error: No se pudo guardar el archivo &#39;</span><span class="si">{</span><span class="nv">$nombre_archivo</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// **Redirección automática al panel con mensaje de éxito**</span>
<span class="nb">header</span><span class="p">(</span><span class="s2">&quot;Location: panel.php?mensaje=Formulario enviado correctamente&quot;</span><span class="p">);</span>
<span class="k">exit</span><span class="p">;</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>formularios\estilo.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* Estilo general del formulario */</span>
<span class="nt">form</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="w">    </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">600</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del título del formulario */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">h1</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del contenedor de cada artículo (input, textarea, select) */</span>
<span class="nt">article</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para los textos dentro de cada artículo (títulos y descripciones) */</span>
<span class="p">.</span><span class="nc">texto</span><span class="w"> </span><span class="nt">h3</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">texto</span><span class="w"> </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>

<span class="p">}</span>
<span class="c">/* Estilo para los labels (si los hubiera) */</span>
<span class="p">.</span><span class="nc">texto</span><span class="w"> </span><span class="nt">strong</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para los campos de entrada (input, textarea, select) */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;text&quot;</span><span class="o">],</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="o">],</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;email&quot;</span><span class="o">],</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;tel&quot;</span><span class="o">],</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;number&quot;</span><span class="o">],</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">select</span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;textarea&quot;</span><span class="o">]</span><span class="p">{</span>
<span class="w">    </span><span class="k">resize</span><span class="p">:</span><span class="w"> </span><span class="kc">vertical</span><span class="p">;</span><span class="w"> </span><span class="c">/* Permite cambiar el tamaño del textarea solo en vertical */</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-sizing</span><span class="p">:</span><span class="w"> </span><span class="kc">border-box</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">min-height</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">max-height</span><span class="p">:</span><span class="w"> </span><span class="mi">300</span><span class="kt">px</span><span class="p">;</span><span class="w"> </span><span class="c">/* Limitar altura máxima para el textarea */</span>
<span class="w">    </span><span class="k">scroll-behavior</span><span class="p">:</span><span class="w"> </span><span class="kc">smooth</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/* Foco en los campos de entrada */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="p">:</span><span class="nd">focus</span><span class="o">,</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">select</span><span class="p">:</span><span class="nd">focus</span><span class="o">,</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">textarea</span><span class="p">:</span><span class="nd">focus</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">outline</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color de borde cuando está enfocado */</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span><span class="w"> </span><span class="mi">178</span><span class="p">,</span><span class="w"> </span><span class="mi">178</span><span class="p">,</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span><span class="w"> </span><span class="c">/* Sombra */</span>
<span class="p">}</span>

<span class="c">/* Placeholder */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="p">::</span><span class="nd">placeholder</span><span class="o">,</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">textarea</span><span class="p">::</span><span class="nd">placeholder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#A1B5C0</span><span class="p">;</span><span class="w"> </span><span class="c">/* Color gris claro */</span>
<span class="w">    </span><span class="k">font-style</span><span class="p">:</span><span class="w"> </span><span class="kc">italic</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo del botón de envío */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="o">]</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="w"> </span><span class="mi">25</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background-color</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Hover del botón de envío */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">input</span><span class="o">[</span><span class="nt">type</span><span class="o">=</span><span class="s2">&quot;submit&quot;</span><span class="o">]</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">transform</span><span class="p">:</span><span class="w"> </span><span class="nb">scale</span><span class="p">(</span><span class="mf">1.05</span><span class="p">);</span>
<span class="p">}</span>

<span class="c">/* Estilos para los errores de validación */</span>
<span class="nt">form</span><span class="w"> </span><span class="p">.</span><span class="nc">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#D9534F</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para los mensajes o placeholders */</span>
<span class="nt">form</span><span class="w"> </span><span class="p">.</span><span class="nc">mensaje</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">0.9</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/* Estilo para los selects */</span>
<span class="nt">form</span><span class="w"> </span><span class="nt">select</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#F9F9F9</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo gris claro */</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/**** ESTILOS PANEL *****/</span>

<span class="nt">html</span><span class="o">,</span><span class="w"> </span><span class="nt">body</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-family</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;Segoe UI&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">Tahoma</span><span class="p">,</span><span class="w"> </span><span class="n">Geneva</span><span class="p">,</span><span class="w"> </span><span class="n">Verdana</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">main</span><span class="w"> </span><span class="nt">section</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">900</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">table</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-collapse</span><span class="p">:</span><span class="w"> </span><span class="kc">collapse</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">table</span><span class="w"> </span><span class="nt">thead</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">table</span><span class="w"> </span><span class="nt">th</span><span class="o">,</span><span class="w"> </span><span class="nt">table</span><span class="w"> </span><span class="nt">td</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">left</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.05</span><span class="kt">rem</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">tbody</span><span class="w"> </span><span class="nt">tr</span><span class="p">:</span><span class="nd">nth-child</span><span class="o">(</span><span class="nt">even</span><span class="o">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#CDE8E5</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">titulotabla</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">flex</span><span class="p">;</span>
<span class="w">    </span><span class="k">align-items</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">justify-content</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">flex-direction</span><span class="p">:</span><span class="w"> </span><span class="kc">column</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">titulotabla</span><span class="w"> </span><span class="nt">h5</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.8</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-transform</span><span class="p">:</span><span class="w"> </span><span class="kc">uppercase</span><span class="p">;</span>
<span class="w">    </span><span class="k">letter-spacing</span><span class="p">:</span><span class="w"> </span><span class="mf">0.05</span><span class="kt">rem</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">titulotabla</span><span class="w"> </span><span class="nt">p</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-bottom</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>

<span class="c">/********** vista documentos ***********/</span>
<span class="c">/********** vista documentos ***********/</span>
<span class="p">.</span><span class="nc">contenedor-vista</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">margin-top</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">box-shadow</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.1</span><span class="p">);</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="w">    </span><span class="k">font-size</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="kt">rem</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin-left</span><span class="p">:</span><span class="w"> </span><span class="mi">40</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">max-width</span><span class="p">:</span><span class="w"> </span><span class="mi">900</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">contenedor-vista</span><span class="w"> </span><span class="nt">pre</span><span class="o">,</span><span class="w"> </span><span class="nt">h1</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton-vista</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="mh">#7AB2B2</span><span class="p">;</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="mh">#EEF7FF</span><span class="p">;</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="w"> </span><span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">border-radius</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
<span class="w">    </span><span class="k">transition</span><span class="p">:</span><span class="w"> </span><span class="k">background</span><span class="w"> </span><span class="mf">0.3</span><span class="kt">s</span><span class="w"> </span><span class="kc">ease</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-align</span><span class="p">:</span><span class="w"> </span><span class="kc">center</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">inline-block</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="kt">px</span><span class="w"> </span><span class="kc">auto</span><span class="p">;</span><span class="w"> </span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">boton-vista</span><span class="w"> </span><span class="nt">a</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">boton-vista</span><span class="p">:</span><span class="nd">hover</span><span class="p">{</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#4D869C</span><span class="p">;</span>
<span class="p">}</span>
<span class="c">/*Para que el enlace dentro del botón se vea correctamente */</span>
<span class="p">.</span><span class="nc">boton-vista</span><span class="w"> </span><span class="nt">a</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="kc">white</span><span class="p">;</span>
<span class="w">    </span><span class="k">text-decoration</span><span class="p">:</span><span class="w"> </span><span class="kc">none</span><span class="p">;</span>
<span class="w">    </span><span class="k">display</span><span class="p">:</span><span class="w"> </span><span class="kc">block</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<h2>formularios\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;!-- </span>
<span class="x">    Actúa como la interfaz principal del sistema de formularios.</span>
<span class="x">    Carga dinámicamente los campos del formulario según el JSON correspondiente.</span>
<span class="x">    Tambien tineen un validador de campos para el proceso de rellenar el formualrio</span>
<span class="x">    Permite el envío de datos a envia.php.</span>
<span class="x">    - Recibe el nombre del formulario desde $_GET[&#39;f&#39;].</span>
<span class="x">    - Busca el archivo JSON en la carpeta forms/ </span>
<span class="x">    - Genera los campos del formulario dinámicamente según la estructura del JSON.</span>
<span class="x">--&gt;</span>


<span class="x">&lt;!doctype html&gt;</span>
<span class="x">&lt;html&gt;</span>
<span class="x">    &lt;head&gt;</span>
<span class="x">        &lt;link rel=&quot;stylesheet&quot; href=&quot;estilo.css&quot;&gt;</span>
<span class="x">    &lt;/head&gt;</span>
<span class="x">    &lt;body&gt;</span>
<span class="x">        &lt;form method=&quot;POST&quot; action=&quot;envia.php&quot;&gt;</span>
<span class="x">        &lt;h1&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/h1&gt;</span>
<span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">));</span><span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">            &lt;input type=&quot;hidden&quot; name=&quot;formulario&quot; value=&quot;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">];</span><span class="cp">?&gt;</span><span class="x">&quot;&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span>
                <span class="c1">// Ruta del archivo JSON</span>
                <span class="nv">$archivo</span> <span class="o">=</span> <span class="s1">&#39;forms/&#39;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;f&#39;</span><span class="p">]</span><span class="o">.</span><span class="s1">&#39;.json&#39;</span><span class="p">;</span>

                <span class="c1">// Verificar si el archivo existe</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">))</span> <span class="p">{</span>
                    <span class="c1">// Leer el archivo</span>
                    <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">);</span>
                    <span class="c1">// Decodificar el JSON</span>
                    <span class="nv">$coleccion</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$datos</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

                    <span class="c1">// Comprobar si la decodificación fue exitosa</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$coleccion</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// Verificar si la clave &#39;campos&#39; existe en la estructura</span>
                        <span class="nv">$campos</span> <span class="o">=</span> <span class="nb">isset</span><span class="p">(</span><span class="nv">$coleccion</span><span class="p">[</span><span class="s1">&#39;campos&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$coleccion</span><span class="p">[</span><span class="s1">&#39;campos&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="nv">$coleccion</span><span class="p">;</span>

                        <span class="c1">// Recorrer los campos del formulario (ya sea dentro de &#39;campos&#39; o directamente el array)</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$campos</span> <span class="k">as</span> <span class="nv">$campo</span><span class="p">)</span> <span class="p">{</span>
                            <span class="c1">// Verificar que cada campo tiene lo necesario</span>
                            <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;tipo&#39;</span><span class="p">],</span> <span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">],</span> <span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">],</span> <span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;descripcion&#39;</span><span class="p">]))</span> <span class="p">{</span>
                                <span class="k">echo</span> <span class="s2">&quot;&lt;article&gt;&quot;</span><span class="p">;</span>
                                <span class="k">echo</span> <span class="s2">&quot;&lt;div class=&#39;texto&#39;&gt;&quot;</span><span class="p">;</span>
                                <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;&lt;strong&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;titulo&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/strong&gt;&lt;/p&gt;&quot;</span><span class="p">;</span>
                                <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;descripcion&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&lt;/p&gt;&quot;</span><span class="p">;</span>
                                <span class="k">echo</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span><span class="p">;</span>

                                <span class="c1">// Si el campo es un &#39;select&#39;, manejar las opciones</span>
                                <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;opciones&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nb">is_array</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;opciones&#39;</span><span class="p">]))</span> <span class="p">{</span>
                                    <span class="k">echo</span> <span class="s2">&quot;&lt;select name=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;&quot;</span><span class="p">;</span>
                                    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;opciones&#39;</span><span class="p">]</span> <span class="k">as</span> <span class="nv">$opcion</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="k">echo</span> <span class="s2">&quot;&lt;option value=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$opcion</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&gt;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$opcion</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&lt;/option&gt;&quot;</span><span class="p">;</span>
                                    <span class="p">}</span>
                                    <span class="k">echo</span> <span class="s2">&quot;&lt;/select&gt;&quot;</span><span class="p">;</span>
                                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                                    <span class="c1">// Si no es un select, generar el input normal</span>
                                    <span class="k">echo</span> <span class="s2">&quot;&lt;input </span>
<span class="s2">                                            type=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;tipo&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39; </span>
<span class="s2">                                            name=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;nombre&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39; </span>
<span class="s2">                                            placeholder=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;valorejemplo&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;valorejemplo&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; </span>
<span class="s2">                                            minlength=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;min&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; </span>
<span class="s2">                                            maxlength=&#39;&quot;</span><span class="o">.</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="o">?</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">])</span> <span class="o">:</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>

                                    <span class="c1">// Agregar validadores si existen</span>
                                    <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;validadorForm&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;validadorForm&#39;</span><span class="p">]))</span> <span class="p">{</span>
                                        <span class="k">echo</span> <span class="s2">&quot; validadorForm=&#39;&quot;</span><span class="o">.</span><span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$campo</span><span class="p">[</span><span class="s1">&#39;validadorForm&#39;</span><span class="p">])</span><span class="o">.</span><span class="s2">&quot;&#39;&quot;</span><span class="p">;</span>
                                    <span class="p">}</span>
                                    <span class="k">echo</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">echo</span> <span class="s2">&quot;&lt;/article&gt;&quot;</span><span class="p">;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;Error al leer los datos del archivo JSON.&lt;/p&gt;&quot;</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">echo</span> <span class="s2">&quot;&lt;p&gt;El archivo JSON no existe.&lt;/p&gt;&quot;</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="cp">?&gt;</span>

<span class="x">            &lt;input type=&quot;submit&quot; value=&quot;Enviar&quot;&gt;</span>
<span class="x">        &lt;/form&gt;</span>

<span class="x">        &lt;script src=&quot;lib/validadorForm/validadorForm.js&quot;&gt;&lt;/script&gt;</span>
<span class="x">        &lt;link rel=&quot;stylesheet&quot; href=&quot;lib/validadorForm/validadorForm.css&quot;&gt;</span>

<span class="x">    &lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</code></pre></div>

<h2>formularios\panel.php</h2>
<div class="codehilite"><pre><span></span><code><span class="x">&lt;!-- </span>
<span class="x">    LISTA LOS FORMULARIOS DISPONIBLES</span>
<span class="x">    - Muestra una lista de todos los formularios disponibles en forms/.</span>
<span class="x">    - Permite acceder a cada formulario (index.php?f=nombre_formulario).</span>
<span class="x">    - Permite ver los documentos generados (documentos.php?formulario=nombre_formulario).</span>

<span class="x">--&gt;</span>



<span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="x">&lt;head&gt;</span>
<span class="x">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="x">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="x">    &lt;title&gt;Lista de Formularios&lt;/title&gt;</span>
<span class="x">    &lt;link rel=&quot;stylesheet&quot; href=&quot;estilo.css&quot;&gt;</span>
<span class="x">&lt;/head&gt;</span>
<span class="x">&lt;body&gt;</span>
<span class="x">    &lt;main&gt;</span>
<span class="x">        &lt;section&gt;</span>
<span class="x">            &lt;div class=&quot;titulotabla&quot;&gt;</span>
<span class="x">                &lt;h5&gt;Lista de Formularios&lt;/h5&gt;</span>
<span class="x">                &lt;p&gt;Administra tus formularios de manera eficiente&lt;/p&gt;</span>
<span class="x">            &lt;/div&gt;</span>

<span class="x">            &lt;table&gt;</span>
<span class="x">                &lt;thead&gt;</span>
<span class="x">                    &lt;tr&gt;</span>
<span class="x">                        &lt;th&gt;Nombre del Formulario&lt;/th&gt;</span>
<span class="x">                        &lt;th&gt;Acciones&lt;/th&gt;</span>
<span class="x">                    &lt;/tr&gt;</span>
<span class="x">                &lt;/thead&gt;</span>
<span class="x">                &lt;tbody&gt;</span>

<span class="x">                </span><span class="cp">&lt;?php</span>
                <span class="nv">$carpeta</span> <span class="o">=</span> <span class="s1">&#39;forms&#39;</span><span class="p">;</span> <span class="c1">// Carpeta que contiene los archivos JSON</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">is_dir</span><span class="p">(</span><span class="nv">$carpeta</span><span class="p">))</span> <span class="p">{</span>
                    <span class="nv">$archivos</span> <span class="o">=</span> <span class="nb">array_diff</span><span class="p">(</span><span class="nb">scandir</span><span class="p">(</span><span class="nv">$carpeta</span><span class="p">),</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">));</span> <span class="c1">// Obtener archivos en la carpeta</span>
                    <span class="k">foreach</span> <span class="p">(</span><span class="nv">$archivos</span> <span class="k">as</span> <span class="nv">$archivo</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// Comprobar si el archivo es un JSON</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">,</span> <span class="nx">PATHINFO_EXTENSION</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">)</span> <span class="p">{</span>
                            <span class="nv">$nombreFormulario</span> <span class="o">=</span> <span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">,</span> <span class="nx">PATHINFO_FILENAME</span><span class="p">);</span>
                            <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&#39;</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&lt;td&gt;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&lt;td class=&quot;botones-accion&quot;&gt;&#39;</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&lt;form action=&quot;index.php&quot; method=&quot;get&quot; class=&quot;formulario-en-linea&quot;&gt;</span>
<span class="s1">                                    &lt;input type=&quot;hidden&quot; name=&quot;f&quot; value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">,</span> <span class="nx">PATHINFO_FILENAME</span><span class="p">))</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;</span>
<span class="s1">                                    &lt;button type=&quot;submit&quot; class=&quot;boton boton-ver&quot;&gt;Ver Formulario&lt;/button&gt;</span>
<span class="s1">                                &lt;/form&gt;&#39;</span><span class="p">;</span>

                            <span class="k">echo</span> <span class="s1">&#39;&lt;form action=&quot;documentos.php&quot; method=&quot;get&quot; class=&quot;formulario-en-linea&quot;&gt;</span>
<span class="s1">                                    &lt;input type=&quot;hidden&quot; name=&quot;formulario&quot; value=&quot;&#39;</span> <span class="o">.</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nv">$nombreFormulario</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39;&quot;&gt;</span>
<span class="s1">                                    &lt;button type=&quot;submit&quot; class=&quot;boton boton-accion&quot;&gt;Ver Documentos&lt;/button&gt;</span>
<span class="s1">                                &lt;/form&gt;&#39;</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&lt;/td&gt;&#39;</span><span class="p">;</span>
                            <span class="k">echo</span> <span class="s1">&#39;&lt;/tr&gt;&#39;</span><span class="p">;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">echo</span> <span class="s1">&#39;&lt;tr&gt;&lt;td colspan=&quot;2&quot;&gt;No se encontraron archivos&lt;/td&gt;&lt;/tr&gt;&#39;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="cp">?&gt;</span>
<span class="x">                &lt;/tbody&gt;</span>
<span class="x">            &lt;/table&gt;</span>
<span class="x">        &lt;/section&gt;</span>
<span class="x">    &lt;/main&gt;</span>
<span class="x">&lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</code></pre></div>

<h2>formularios\vista.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * Funcionalidad:</span>
<span class="sd"> * Permite visualizar el contenido de un documento JSON en una página amigable.</span>
<span class="sd"> * Recibe el archivo a visualizar desde $_GET[&#39;archivo&#39;].</span>
<span class="sd"> * La Carga el contenido del archivo JSON y lo formatea con json_encode().</span>
<span class="sd"> * Incluye un botón &quot;Volver&quot; para regresar a documentos.php.</span>
<span class="sd"> */</span>


<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span>

<span class="c1">// Verificar que se haya recibido un archivo en la URL</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;archivo&#39;</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;h1&gt;Error: No se especificó un archivo.&lt;/h1&gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Sanitizar el nombre del archivo para evitar accesos no autorizados</span>
<span class="nv">$archivo</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="s1">&#39;/[^a-zA-Z0-9_\/.-]/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;archivo&#39;</span><span class="p">]);</span>
<span class="nv">$ruta_archivo</span> <span class="o">=</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/documentos/&quot;</span> <span class="o">.</span> <span class="nv">$archivo</span><span class="p">;</span>

<span class="c1">// **Verificar si el archivo existe**</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">file_exists</span><span class="p">(</span><span class="nv">$ruta_archivo</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s2">&quot;&lt;h1&gt;Error: El archivo no existe.&lt;/h1&gt;&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Obtener el contenido del archivo</span>
<span class="nv">$contenido</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$ruta_archivo</span><span class="p">);</span>
<span class="nv">$contenido_json</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$contenido</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

<span class="cp">?&gt;</span>

<span class="x">&lt;!DOCTYPE html&gt;</span>
<span class="x">&lt;html lang=&quot;es&quot;&gt;</span>
<span class="x">&lt;head&gt;</span>
<span class="x">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span>
<span class="x">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span>
<span class="x">    &lt;title&gt;Vista del Documento&lt;/title&gt;</span>
<span class="x">    &lt;link rel=&quot;stylesheet&quot; href=&quot;estilo.css&quot;&gt;</span>
<span class="x">&lt;/head&gt;</span>
<span class="x">&lt;body&gt;</span>
<span class="x">    &lt;div class=&quot;contenedor-vista&quot;&gt;</span>
<span class="x">        &lt;h1&gt;Documento: </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">htmlspecialchars</span><span class="p">(</span><span class="nb">basename</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&lt;/h1&gt;</span>
<span class="x">        &lt;pre&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$contenido_json</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span> <span class="o">|</span> <span class="nx">JSON_UNESCAPED_UNICODE</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/pre&gt;</span>
<span class="x">        &lt;button class=&quot;boton-vista&quot;&gt;&lt;a href=&quot;documentos.php?formulario=</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">urlencode</span><span class="p">(</span><span class="nb">dirname</span><span class="p">(</span><span class="nv">$archivo</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;Volver&lt;/a&gt;&lt;button&gt;</span>
<span class="x">    &lt;/div&gt;</span>
<span class="x">&lt;/body&gt;</span>
<span class="x">&lt;/html&gt;</span>
</code></pre></div>

<h2>formularios\lib\validadorForm\validadorForm.css</h2>
<div class="codehilite"><pre><span></span><code><span class="c">/* Clase para campos inválidos (error) */</span>
<span class="p">.</span><span class="nc">ko</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">red</span><span class="p">;</span><span class="w"> </span><span class="c">/* Borde rojo para error */</span>
<span class="w">    </span><span class="k">background</span><span class="p">:</span><span class="w"> </span><span class="mh">#eb6060</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo rojo claro */</span>
<span class="p">}</span>

<span class="c">/* Clase para campos válidos (éxito) */</span>
<span class="nt">input</span><span class="p">.</span><span class="nc">ok</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">border</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="w"> </span><span class="kc">solid</span><span class="w"> </span><span class="kc">green</span><span class="p">;</span><span class="w"> </span><span class="c">/* Borde verde para éxito */</span>
<span class="w">    </span><span class="k">background-color</span><span class="p">:</span><span class="w"> </span><span class="mh">#6ff16f</span><span class="p">;</span><span class="w"> </span><span class="c">/* Fondo verde claro */</span>
<span class="p">}</span>
</code></pre></div>

<h2>formularios\lib\validadorForm\validadorForm.js</h2>
<div class="codehilite"><pre><span></span><code><span class="c1">// Seleccionamos todos los elementos &lt;input&gt; del documento</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">entradas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">);</span>

<span class="c1">// Filtramos los inputs que tienen el atributo &#39;validadorForm&#39;, ya que solo esos necesitan validación</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">validadores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nx">entradas</span><span class="p">).</span><span class="nx">filter</span><span class="p">(</span><span class="nx">input</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">input</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;validadorForm&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>
<span class="nx">validadores</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">validador</span><span class="p">){</span>
<span class="w">    </span><span class="nx">validador</span><span class="p">.</span><span class="nx">onblur</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kd">function</span><span class="p">(){</span>
<span class="w">        </span><span class="k">switch</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s1">&#39;validadorForm&#39;</span><span class="p">)){</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;dni&quot;</span><span class="o">:</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^[0-9]{8}[A-Z]$/</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;iban&quot;</span><span class="o">:</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^ES\d{22}$/</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;cp&quot;</span><span class="o">:</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^\d{5}$/</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;tarjetacredito&quot;</span><span class="o">:</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^\d{13,19}$/</span><span class="p">,</span><span class="k">this</span><span class="p">,</span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;tel&quot;</span><span class="o">:</span><span class="w"> </span><span class="c1">// Aquí es donde añadimos el validador de teléfono</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^\+?[0-9]{10,15}$/</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="w"> </span><span class="c1">// Expresión regular para teléfono</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;email&quot;</span><span class="o">:</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="w"> </span><span class="c1">// Expresión regular para email</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;texto&quot;</span><span class="o">:</span>
<span class="w">                </span><span class="nx">validar</span><span class="p">(</span><span class="sr">/^.{2,}$/</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span><span class="w"> </span><span class="c1">// Expresión regular para cualquier texto</span>
<span class="w">                </span><span class="k">break</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>

<span class="c1">// Función que verifica si el valor del input cumple con la expresión regular</span>
<span class="kd">function</span><span class="w"> </span><span class="nx">validar</span><span class="p">(</span><span class="nx">miregex</span><span class="p">,</span><span class="w"> </span><span class="nx">elemento</span><span class="p">,</span><span class="w"> </span><span class="nx">valor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">regex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">miregex</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">regex</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">valor</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Si el valor coincide con la expresión regular</span>
<span class="w">        </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;ko&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Quitamos la clase &#39;ko&#39; (indicador de error)</span>
<span class="w">        </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;ok&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Agregamos la clase &#39;ok&#39; (indicador de éxito)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// Si el valor no es válido</span>
<span class="w">        </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&quot;ok&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Quitamos la clase &#39;ok&#39;</span>
<span class="w">        </span><span class="nx">elemento</span><span class="p">.</span><span class="nx">classList</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">&quot;ko&quot;</span><span class="p">);</span><span class="w"> </span><span class="c1">// Agregamos la clase &#39;ko&#39;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

<h2>public\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ##  Descripción:</span>
<span class="sd"> * Este script proporciona una **API pública REST** para recuperar información de productos desde la base de datos.</span>
<span class="sd"> * Es un **endpoint que devuelve un JSON** con la lista de productos, incluyendo imágenes si están disponibles.</span>
<span class="sd"> *</span>
<span class="sd"> *</span>
<span class="sd"> * ##  Funcionalidades:</span>
<span class="sd"> * - **Habilita CORS** para permitir solicitudes desde cualquier origen (`*`).</span>
<span class="sd"> * - **Obtiene la lista de productos desde MySQL**.</span>
<span class="sd"> * - **Modifica la URL de las imágenes** para que sean accesibles desde un servidor externo.</span>
<span class="sd"> * - **Devuelve los resultados en formato JSON**.</span>
<span class="sd"> *</span>
<span class="sd"> */</span>

<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span>

<span class="c1">// Habilitar CORS para permitir el acceso desde cualquier dominio</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Origin: *&#39;</span><span class="p">);</span>                               <span class="c1">// Permitir solicitudes desde cualquier origen</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Methods: GET, POST, OPTIONS&#39;</span><span class="p">);</span>             <span class="c1">// Métodos permitidos</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Access-Control-Allow-Headers: Content-Type, Authorization&#39;</span><span class="p">);</span>    <span class="c1">// Encabezados permitidos</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">);</span>                               <span class="c1">// Tipo de contenido</span>


<span class="nv">$conexion</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>

<span class="c1">//Consulta SQL para obtener la lista de productos</span>
<span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM productos&quot;</span><span class="p">;</span>
<span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conexion</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>

<span class="nv">$json</span> <span class="o">=</span> <span class="p">[];</span>
<span class="c1">// Recorrer los resultados y estructurar la salida JSON</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;fotografia&#39;</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;fotografia&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;http://10.0.2.2/img/&quot;</span> <span class="o">.</span> <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;fotografia&#39;</span><span class="p">];</span> 
    <span class="p">}</span>
    <span class="nv">$json</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
<span class="p">}</span>

<span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\ConectorMongoDB.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo implementa una **clase para la gestión de bases de datos en MongoDB** dentro del sistema.</span>
<span class="sd"> * Permite la conexión, consulta, inserción y eliminación de documentos en una base de datos **NoSQL**.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Funcionalidades:</span>
<span class="sd"> * - `listar($coleccion)`: Devuelve todos los documentos de una colección en formato JSON.</span>
<span class="sd"> * - `listarColeccion()`: Lista todas las colecciones disponibles en la base de datos.</span>
<span class="sd"> * - `insertar($coleccion, $datos)`: Inserta un nuevo documento en la colección especificada.</span>
<span class="sd"> * - `eliminar($coleccion, $id)`: Elimina un documento específico según su `_id`.</span>
<span class="sd"> *</span>
<span class="sd"> */</span>




<span class="k">class</span> <span class="nc">ConectorMongoDB</span> <span class="p">{</span>
    <span class="k">private</span> <span class="nv">$servidor</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$basededatos</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$conexion</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">servidor</span> <span class="o">=</span> <span class="s2">&quot;mongodb://localhost:27017&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Manager</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">servidor</span><span class="p">);</span>  
    <span class="p">}</span>

    <span class="c1">/////////////////////////////// FUNCION PARA SELECCIONAR ////////////////////</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">listar</span><span class="p">(</span><span class="nv">$coleccion</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Consulta vacía para obtener todos los documentos</span>
        <span class="nv">$peticion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">([]);</span>  
        <span class="nv">$namespace</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span> <span class="o">.</span> <span class="s2">&quot;.&quot;</span> <span class="o">.</span> <span class="nv">$coleccion</span><span class="p">;</span> 

        <span class="c1">// Usar la conexión correctamente</span>
        <span class="nv">$cursor</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="nv">$namespace</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span> 

        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$cursor</span> <span class="k">as</span> <span class="nv">$documento</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$documento</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Convertir el resultado a JSON y devolverlo</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">/////////////////////////////// FUNCION PARA SELECCIONAR ////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">listarColeccion</span><span class="p">(){</span>
        <span class="nv">$peticion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Command</span><span class="p">([</span><span class="s2">&quot;listCollections&quot;</span>  <span class="o">=&gt;</span> <span class="mi">1</span><span class="p">]);</span>
        <span class="nv">$cursor</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="o">-&gt;</span><span class="na">executeCommand</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>

        <span class="nv">$colecciones</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="nv">$nombreClave</span> <span class="o">=</span> <span class="s2">&quot;Tables_in_&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="p">;</span>

        <span class="k">foreach</span><span class="p">(</span><span class="nv">$cursor</span> <span class="k">as</span> <span class="nv">$coleccion</span><span class="p">){</span>
            <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[</span>
                <span class="nv">$nombreClave</span> <span class="o">=&gt;</span> <span class="nv">$coleccion</span><span class="o">-&gt;</span><span class="na">name</span><span class="p">,</span>
                <span class="s2">&quot;Comentario&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;&quot;</span>
            <span class="p">];</span>

            <span class="nv">$colecciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$json</span> <span class="o">=</span>  <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$colecciones</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">/////////////////////////////// FUNCION PARA INSERTAR ////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">insertar</span><span class="p">(</span><span class="nv">$coleccion</span><span class="p">,</span> <span class="nv">$datos</span><span class="p">){</span>
        <span class="nv">$namespace</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="o">.</span><span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="nv">$coleccion</span><span class="p">;</span>
        <span class="nv">$bulk</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\BulkWrite</span><span class="p">;</span>
        <span class="nv">$bulk</span><span class="o">-&gt;</span><span class="na">insert</span><span class="p">(</span><span class="nv">$datos</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="o">-&gt;</span><span class="na">executeBulkWrite</span><span class="p">(</span><span class="nv">$namespace</span><span class="p">,</span> <span class="nv">$bulk</span><span class="p">);</span>
        <span class="nv">$peticion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\Query</span><span class="p">([]);</span>
        <span class="nv">$cursor</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="o">-&gt;</span><span class="na">executeQuery</span><span class="p">(</span><span class="nv">$namespace</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/////////////////////////// FUNCION ELIMIAR DOCUMENTOS //////////////////////</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">eliminar</span><span class="p">(</span><span class="nv">$coleccion</span><span class="p">,</span> <span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$namespace</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span> <span class="o">.</span> <span class="s2">&quot;.&quot;</span> <span class="o">.</span> <span class="nv">$coleccion</span><span class="p">;</span>
        <span class="nv">$bulk</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MongoDB\Driver\BulkWrite</span><span class="p">;</span>

        <span class="c1">// Crear un filtro para encontrar el documento por su _id</span>
        <span class="nv">$bulk</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">([</span><span class="s1">&#39;_id&#39;</span> <span class="o">=&gt;</span> <span class="k">new</span> <span class="nx">MongoDB\BSON\ObjectId</span><span class="p">(</span><span class="nv">$id</span><span class="p">)]);</span>

        <span class="c1">// Ejecutar la eliminación</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="o">-&gt;</span><span class="na">executeBulkWrite</span><span class="p">(</span><span class="nv">$namespace</span><span class="p">,</span> <span class="nv">$bulk</span><span class="p">);</span>

        <span class="k">return</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;mensaje&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Documento eliminado correctamente&quot;</span><span class="p">]);</span>
    <span class="p">}</span>


<span class="p">}</span>


<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\conexionDB.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * </span>
<span class="sd"> *## Descripción:</span>
<span class="sd"> * Este archivo define la clase `conexionDB`, que maneja la conexión a la base de datos MySQL y </span>
<span class="sd"> * proporciona diversas funciones para interactuar con ella, incluyendo:</span>
<span class="sd"> * - Conexión y gestión de la base de datos `crismon1`.</span>
<span class="sd"> * - Métodos para buscar, insertar, actualizar y eliminar registros en las tablas.</span>
<span class="sd"> * - Métodos para obtener información sobre la estructura de la base de datos.</span>
<span class="sd"> * - Implementación de seguridad mediante saneamiento de datos.</span>
<span class="sd"> * - Generación de datos para gráficas basadas en la cantidad de registros en las tablas.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Notas:</span>
<span class="sd"> * - **Seguridad:** Se implementa saneamiento de datos con `mysqli_real_escape_string()` y `sanear()`.</span>
<span class="sd"> * - **Optimización:** Se han agregado métodos reutilizables para mejorar el rendimiento.</span>
<span class="sd"> * - **Uso:** Este archivo debe ser incluido en otros scripts que necesiten acceso a la base de datos.</span>
<span class="sd"> */</span>


<span class="k">include_once</span> <span class="s2">&quot;lib/sanear.php&quot;</span><span class="p">;</span> 

<span class="k">class</span> <span class="nc">conexionDB</span><span class="p">{</span>
    <span class="c1">// Propiedades para la conexión a la base de datos</span>
    <span class="k">private</span> <span class="nv">$servidor</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$usuario</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$contrasena</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$basededatos</span><span class="p">;</span>
    <span class="k">private</span> <span class="nv">$conexion</span><span class="p">;</span>

    <span class="c1">// Constructor que inicializa las propiedades y establece la conexión</span>
    <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">//INICIA LAS PROPIEDADES DE CONEXION</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">servidor</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">usuario</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contrasena</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>

        <span class="c1">// Establecer la conexión a la base de datos</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">servidor</span><span class="p">,</span> 
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">usuario</span><span class="p">,</span> 
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">contrasena</span><span class="p">,</span> 
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span>
        <span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">/////////////////////////////////////////// FUNCION PARA ACCEDER DESDE OTROS ARCHIVOS A LA CONEXION  ////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">getConexion</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/////////////////////////////////////////// FUNCION BUSCAR SELECCIONADO ////////////////////////////////////////////</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">buscarSeleccion</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span> <span class="nv">$datos</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Verificar si los campos seleccionados están presentes</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;campos&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Faltan los campos seleccionados.&quot;</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="nv">$camposSeleccionados</span> <span class="o">=</span> <span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;campos&#39;</span><span class="p">];</span> <span class="c1">// Array de los campos seleccionados</span>

        <span class="c1">// Verificar que al menos un campo haya sido seleccionado</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$camposSeleccionados</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;No se han seleccionado campos para la búsqueda.&quot;</span><span class="p">]);</span>
        <span class="p">}</span>

        <span class="c1">// Sanitizar los nombres de los campos para prevenir inyecciones SQL</span>
        <span class="nv">$camposSanitizados</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$campo</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">mysqli_real_escape_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$campo</span><span class="p">);</span>
        <span class="p">},</span> <span class="nv">$camposSeleccionados</span><span class="p">);</span>

        <span class="c1">// Construir la parte de la consulta SELECT con los campos seleccionados</span>
        <span class="nv">$campos</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="nv">$camposSanitizados</span><span class="p">);</span> <span class="c1">// Une los campos seleccionados en una cadena</span>

        <span class="c1">// Iniciar la consulta SQL</span>
        <span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;SELECT </span><span class="si">$campos</span><span class="s2"> FROM &quot;</span> <span class="o">.</span> <span class="nx">mysqli_real_escape_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$tabla</span><span class="p">);</span>

        <span class="c1">// Verificar si se proporcionaron valores de búsqueda</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;valores&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;valores&#39;</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$valoresBusqueda</span> <span class="o">=</span> <span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;valores&#39;</span><span class="p">];</span> <span class="c1">// Los valores que se están buscando en esos campos</span>

            <span class="c1">// Sanitizar los valores de búsqueda</span>
            <span class="nv">$valoresSanitizados</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="nx">mysqli_real_escape_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$valor</span><span class="p">);</span>
            <span class="p">},</span> <span class="nv">$valoresBusqueda</span><span class="p">);</span>

            <span class="c1">// Construir la parte de la consulta WHERE con los valores de búsqueda</span>
            <span class="nv">$condiciones</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$valoresSanitizados</span> <span class="k">as</span> <span class="nv">$clave</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$condiciones</span><span class="p">[]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">$clave</span><span class="s2"> LIKE &#39;%</span><span class="si">$valor</span><span class="s2">%&#39;&quot;</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$where</span> <span class="o">=</span> <span class="nb">implode</span><span class="p">(</span><span class="s2">&quot; AND &quot;</span><span class="p">,</span> <span class="nv">$condiciones</span><span class="p">);</span>

            <span class="c1">// Añadir la cláusula WHERE a la consulta</span>
            <span class="nv">$peticion</span> <span class="o">.=</span> <span class="s2">&quot; WHERE </span><span class="si">$where</span><span class="s2">&quot;</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nv">$peticion</span> <span class="o">.=</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span> <span class="c1">// Terminar la consulta</span>

        <span class="c1">// Ejecutar la consulta SQL</span>
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$resultado</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Error en la consulta SQL: &quot;</span> <span class="o">.</span> <span class="nx">mysqli_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">)]);</span>
        <span class="p">}</span>

        <span class="nv">$retorno</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="c1">// Recoger los resultados de la consulta</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$retorno</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Devolver los resultados como JSON</span>
        <span class="k">return</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$retorno</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">////////////////////////////////////////////   FUNCION DE BUSCAR     ////////////////////////////////////////////////</span>


    <span class="k">public</span> <span class="k">function</span> <span class="nf">buscar</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span> <span class="nv">$datos</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Sanitizamos los datos antes de construir la consulta</span>
        <span class="nx">sanear</span><span class="p">(</span><span class="nv">$datos</span><span class="p">);</span>

        <span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">.</span> <span class="nx">mysqli_real_escape_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$tabla</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot; WHERE &quot;</span><span class="p">;</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$datos</span> <span class="k">as</span> <span class="nv">$clave</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$peticion</span> <span class="o">.=</span> <span class="nx">mysqli_real_escape_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$clave</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;=&#39;&quot;</span> <span class="o">.</span> <span class="nx">mysqli_real_escape_string</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$valor</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&quot;&#39; AND &quot;</span><span class="p">;</span> 
        <span class="p">}</span>
        <span class="nv">$peticion</span> <span class="o">.=</span> <span class="s2">&quot; 1;&quot;</span><span class="p">;</span>

        <span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>
        <span class="nv">$retorno</span> <span class="o">=</span> <span class="p">[];</span>

        <span class="k">while</span> <span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">))</span> <span class="p">{</span>    
            <span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">));</span>                                
            <span class="nv">$retorno</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>                                                                            
        <span class="p">}</span>
        <span class="k">return</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$retorno</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">/////////////////////////////////////////////////////////////////////////////////////////////////////////////////</span>



    <span class="c1">//////////////////////////////////////// BUSCAR SIMILARES EN EL SELECTOR //////////////////////////////////////</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">buscarSimilar</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span><span class="nv">$datos</span><span class="p">){</span>
        <span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot; WHERE &quot;</span><span class="p">;</span>
        <span class="k">foreach</span><span class="p">(</span><span class="nv">$datos</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>
            <span class="nv">$peticion</span> <span class="o">.=</span> <span class="nv">$clave</span><span class="o">.</span><span class="s2">&quot; LIKE &#39;%&quot;</span><span class="o">.</span><span class="nv">$valor</span><span class="o">.</span><span class="s2">&quot;%&#39; AND &quot;</span><span class="p">;</span> 
        <span class="p">}</span>
        <span class="nv">$peticion</span> <span class="o">.=</span> <span class="s2">&quot; 1;&quot;</span><span class="p">;</span>



        <span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>
        <span class="nv">$retorno</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">))</span> <span class="p">{</span>                                        
            <span class="nv">$retorno</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>                                                                         
        <span class="p">}</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$retorno</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>                           
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>   
    <span class="p">}</span>

    <span class="c1">//////////////////////////////////////////// SELECCIONAR TABLA ///////////////////////////////////////</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">seleccionaTabla</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">){</span>                                                
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT </span>
<span class="s2">                        *</span>
<span class="s2">                FROM </span>
<span class="s2">                        information_schema.key_column_usage</span>
<span class="s2">                WHERE </span>
<span class="s2">                        table_name = &#39;&quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">                        AND</span>
<span class="s2">                        REFERENCED_TABLE_NAME IS NOT NULL</span>
<span class="s2">                ;&quot;</span><span class="p">;</span>                                         

        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                               
        <span class="nv">$restricciones</span> <span class="o">=</span> <span class="p">[];</span>                                                                                        
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                                        
            <span class="nv">$restricciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>                                                                            
        <span class="p">}</span>



        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span>                                                       
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                               
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>                                                                                                
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                                        


                <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[];</span>                                                                                                 
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>                                                    
                    <span class="nv">$identificador</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                    <span class="nv">$pasas</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>                                                                                      
                    <span class="k">foreach</span><span class="p">(</span><span class="nv">$restricciones</span> <span class="k">as</span> <span class="nv">$restriccion</span><span class="p">){</span>                                    
                        <span class="k">if</span><span class="p">(</span><span class="nv">$clave</span> <span class="o">==</span> <span class="s2">&quot;Identificador&quot;</span><span class="p">){</span>
                            <span class="nv">$identificador</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$clave</span> <span class="o">==</span> <span class="nv">$restriccion</span><span class="p">[</span><span class="s2">&quot;COLUMN_NAME&quot;</span><span class="p">]){</span>                          

                            <span class="nv">$query2</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">                                SELECT * </span>
<span class="s2">                                FROM &quot;</span><span class="o">.</span><span class="nv">$restriccion</span><span class="p">[</span><span class="s2">&quot;REFERENCED_TABLE_NAME&quot;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">                                WHERE Identificador = &quot;</span><span class="o">.</span><span class="nv">$identificador</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">                            ;&quot;</span><span class="p">;</span>
                            <span class="nv">$result2</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query2</span><span class="p">);</span>
                            <span class="nv">$cadena</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
                            <span class="k">while</span> <span class="p">(</span><span class="nv">$row2</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result2</span><span class="p">))</span> <span class="p">{</span>
                                <span class="k">foreach</span><span class="p">(</span><span class="nv">$row2</span> <span class="k">as</span> <span class="nv">$campo</span><span class="p">){</span>
                                    <span class="nv">$cadena</span> <span class="o">.=</span> <span class="nv">$campo</span><span class="o">.</span><span class="s2">&quot;-&quot;</span><span class="p">;</span>
                                <span class="p">}</span>
                            <span class="p">}</span>

                            <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$cadena</span><span class="p">;</span>                                                            
                            <span class="nv">$pasas</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>                                                                             
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$pasas</span> <span class="o">==</span> <span class="k">true</span><span class="p">){</span>                                                                                 
                    <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>                                                                     
                <span class="p">}</span>
                <span class="p">}</span>
                <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>       
        <span class="p">}</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>                     
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>                                                                                                   
    <span class="p">}</span>
    <span class="c1">///////////////////////////////////////// SACAR EL LISTADO DE TABLAS /////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">listadoAplicacionesUsuario</span><span class="p">(</span><span class="nv">$usuario</span><span class="p">){</span>
        <span class="c1">// La consulta SQL</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">            SELECT</span>
<span class="s2">            aplicaciones.nombre</span>
<span class="s2">            FROM usuarios</span>

<span class="s2">            LEFT JOIN departamentos</span>
<span class="s2">            ON usuarios.departamentos_nombre = departamentos.Identificador</span>

<span class="s2">            LEFT JOIN departamentosapp</span>
<span class="s2">            ON departamentosapp.departamento_nombre = departamentos.Identificador</span>

<span class="s2">            LEFT JOIN aplicaciones</span>
<span class="s2">            ON departamentosapp.aplicaciones_nombre = aplicaciones.Identificador</span>

<span class="s2">            WHERE usuarios.usuario = &#39;&quot;</span><span class="o">.</span><span class="nv">$usuario</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">        &quot;</span><span class="p">;</span>      
        <span class="c1">//echo $query;</span>
        <span class="c1">// Ejecutamos la consulta</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>   
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>    <span class="c1">// Arreglo donde almacenaremos los resultados</span>

        <span class="c1">// Recorremos los resultados de la consulta</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// Almacenamos cada fila en el arreglo resultado</span>
            <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>
                <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Enviar la respuesta como JSON</span>
        <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">);</span>  <span class="c1">// Asegúrate de enviar el tipo de contenido correcto</span>
        <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span> <span class="c1">// Devuelves el resultado como JSON</span>
    <span class="p">}</span>

    <span class="c1">///////////////////////////////////////// SACAR EL LISTADO DE TABLAS /////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">listadoTablasAplicacion</span><span class="p">(</span><span class="nv">$aplicacion</span><span class="p">){</span>
        <span class="c1">// La consulta SQL</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">            SELECT </span>
<span class="s2">                ist.table_name AS &#39;Tables_in_&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                ist.table_comment AS &#39;Comentario&#39;,</span>
<span class="s2">                ta.tabla AS &#39;Tabla_de_Aplicación&#39;</span>
<span class="s2">            FROM </span>
<span class="s2">                information_schema.tables AS ist</span>
<span class="s2">            LEFT JOIN </span>
<span class="s2">                tablasaplicaciones AS ta</span>
<span class="s2">            ON </span>
<span class="s2">                ist.table_name = ta.tabla</span>
<span class="s2">            LEFT JOIN </span>
<span class="s2">                aplicaciones AS ap</span>
<span class="s2">            ON </span>
<span class="s2">                ta.aplicaciones_nombre = ap.Identificador</span>
<span class="s2">            WHERE </span>
<span class="s2">                ist.table_schema = &#39;&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">                AND ap.nombre = &#39;&quot;</span><span class="o">.</span><span class="nv">$aplicacion</span><span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">        &quot;</span><span class="p">;</span>      

        <span class="c1">// Ejecutamos la consulta</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>   
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>    <span class="c1">// Arreglo donde almacenaremos los resultados</span>

        <span class="c1">// Recorremos los resultados de la consulta</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// Almacenamos cada fila en el arreglo resultado</span>
            <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>
                <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Enviar la respuesta como JSON</span>
        <span class="nb">header</span><span class="p">(</span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">);</span>  <span class="c1">// Asegúrate de enviar el tipo de contenido correcto</span>
        <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span> <span class="c1">// Devuelves el resultado como JSON</span>
    <span class="p">}</span>
    <span class="c1">///////////////////////////////////////// SACAR EL LISTADO DE TABLAS /////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">listadoTablas</span><span class="p">(){</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">            SELECT </span>
<span class="s2">                    table_name AS &#39;Tables_in_&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="o">.</span><span class="s2">&quot;&#39;, </span>
<span class="s2">                    table_comment AS &#39;Comentario&#39;</span>
<span class="s2">            FROM </span>
<span class="s2">                    information_schema.tables</span>
<span class="s2">            WHERE </span>
<span class="s2">                    table_schema = &#39;&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">        &quot;</span><span class="p">;</span>                                                                          

        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                               
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>                                                                                        
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                                        

                <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>
                    <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>                         
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>                                                                                                       
    <span class="p">}</span>

    <span class="c1">////////////////////////////////////////////// PARA SACRA TODAS LAS COLUMNAS DE LA TABLA /////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">columnasTabla</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">){</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SHOW COLUMNS FROM &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot;;&quot;</span><span class="p">;</span>                                                                               
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                               
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>                                                                                                
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                                        

                <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[];</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>
                    <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>                     
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>                                                                                                       
    <span class="p">}</span>

    <span class="c1">///////////////////////////////////////////// INSERTAR EN LA TABLA /////////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">insertaTabla</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span><span class="nv">$valores</span><span class="p">){</span>                                      
            <span class="nv">$campos</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>                                                                                                   
            <span class="nv">$datos</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>                                                                                                    
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$valores</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>                                                
                <span class="nv">$campos</span> <span class="o">.=</span> <span class="nv">$clave</span><span class="o">.</span><span class="s2">&quot;,&quot;</span><span class="p">;</span>                                                                          
                <span class="nv">$datos</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nv">$valor</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>                                                              
            <span class="p">}</span>
            <span class="nv">$campos</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$campos</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>                                                           
            <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$datos</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>                                                             
            <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">                INSERT INTO &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot; </span>
<span class="s2">                (&quot;</span><span class="o">.</span><span class="nv">$campos</span><span class="o">.</span><span class="s2">&quot;) </span>
<span class="s2">                VALUES (&quot;</span><span class="o">.</span><span class="nv">$datos</span><span class="o">.</span><span class="s2">&quot;);</span>
<span class="s2">                &quot;</span><span class="p">;</span>  
                <span class="k">echo</span> <span class="nv">$query</span><span class="p">;</span>
            <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                           
            <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>                                                                                                   
    <span class="p">}</span>

    <span class="c1">///////////////////////////////////////// FUNCION DE ACTUALIZAR TABLA ////////////////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">actualizaTabla</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span><span class="nv">$valores</span><span class="p">,</span><span class="nv">$id</span><span class="p">){</span>
            <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">                UPDATE &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot; </span>
<span class="s2">                SET</span>
<span class="s2">                &quot;</span><span class="p">;</span>                                                                                                              
            <span class="k">foreach</span><span class="p">(</span><span class="nv">$valores</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>                                                
                <span class="nv">$query</span> <span class="o">.=</span> <span class="nv">$clave</span><span class="o">.</span><span class="s2">&quot;=&#39;&quot;</span><span class="o">.</span><span class="nv">$valor</span><span class="o">.</span><span class="s2">&quot;&#39;, &quot;</span><span class="p">;</span>                                                 
            <span class="p">}</span>
            <span class="nv">$query</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$query</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span>                                                             
                <span class="nv">$query</span> <span class="o">.=</span> <span class="s2">&quot;</span>
<span class="s2">                WHERE Identificador = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&quot;</span>
<span class="s2">                &quot;</span><span class="p">;</span>                                                                                                                  
            <span class="k">echo</span> <span class="nv">$query</span><span class="p">;</span>
            <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                           
            <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>                          
    <span class="p">}</span>

    <span class="c1">/////////////////////////////////////////////// FUNCION PARA OBTENER REGISTRO //////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">registro</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span> <span class="nv">$id</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM &quot;</span> <span class="o">.</span> <span class="nv">$tabla</span> <span class="o">.</span> <span class="s2">&quot; WHERE Identificador = &quot;</span> <span class="o">.</span> <span class="nv">$id</span> <span class="o">.</span> <span class="s2">&quot;;&quot;</span><span class="p">;</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>
        <span class="nv">$resultado</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$fila</span> <span class="o">=</span> <span class="p">[];</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$row</span> <span class="k">as</span> <span class="nv">$clave</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
                <span class="nv">$fila</span><span class="p">[</span><span class="nv">$clave</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="nv">$resultado</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$fila</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/////////////////////////////////////////////// FUNCION PARA ELIMINAR REGISTRO //////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">eliminaTabla</span><span class="p">(</span><span class="nv">$tabla</span><span class="p">,</span><span class="nv">$id</span><span class="p">){</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">                DELETE FROM &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot; </span>
<span class="s2">                WHERE Identificador = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="o">.</span><span class="s2">&quot;;</span>
<span class="s2">                &quot;</span><span class="p">;</span>  
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                           
    <span class="p">}</span>


    <span class="c1">///////////////////////////////////// FUNCIONES DESCODIFICA Y CODIFICAR //////////////////////////////////////////////////</span>

    <span class="k">private</span> <span class="k">function</span> <span class="nf">codifica</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">){</span>
        <span class="k">return</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">function</span> <span class="nf">decodifica</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">){</span>
        <span class="k">return</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="c1">//////////////////////////////////////////////// metemos metodo de datos grafica ////////////////////////////////////////////</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">datosGrafica</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Get the list of tables in the database</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            table_name </span>
<span class="s2">        FROM </span>
<span class="s2">            information_schema.tables</span>
<span class="s2">        WHERE </span>
<span class="s2">            table_schema = &#39;&quot;</span><span class="o">.</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">basededatos</span><span class="o">.</span><span class="s2">&quot;&#39;;</span>
<span class="s2">    &quot;</span><span class="p">;</span>
        <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$result</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error al recuperar las tablas: &quot;</span> <span class="o">.</span> <span class="nx">mysqli_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="c1">// Debug: Verifica si hay resultados</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mysqli_num_rows</span><span class="p">(</span><span class="nv">$result</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="s2">&quot;No se encontraron tablas en la base de datos especificada.&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nv">$datos</span> <span class="o">=</span> <span class="p">[];</span>
        <span class="c1">// Loop through each table and count its rows</span>
        <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>

            <span class="nv">$tabla</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;table_name&#39;</span><span class="p">];</span>
            <span class="nv">$queryCount</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(*) AS total FROM `</span><span class="si">$tabla</span><span class="s2">`;&quot;</span><span class="p">;</span>
            <span class="nv">$resultCount</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">,</span> <span class="nv">$queryCount</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nv">$resultCount</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Error al contar filas en la tabla </span><span class="si">$tabla</span><span class="s2">: &quot;</span> <span class="o">.</span> <span class="nx">mysqli_error</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">conexion</span><span class="p">));</span>
            <span class="p">}</span>

            <span class="nv">$count</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultCount</span><span class="p">)[</span><span class="s1">&#39;total&#39;</span><span class="p">];</span>
            <span class="nv">$datos</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;texto&quot;</span> <span class="o">=&gt;</span> <span class="nv">$tabla</span><span class="p">,</span> <span class="s2">&quot;valor&quot;</span> <span class="o">=&gt;</span> <span class="p">(</span><span class="nx">int</span><span class="p">)</span><span class="nv">$count</span><span class="p">];</span>
        <span class="p">}</span>

        <span class="c1">// Encode the result as a JSON string</span>
        <span class="nv">$json</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$datos</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
        <span class="k">return</span> <span class="nv">$json</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\index.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ## 🔹 Descripción:</span>
<span class="sd"> * Este script actúa como un **controlador de la API**, gestionando solicitudes HTTP (GET y POST) </span>
<span class="sd"> * para interactuar con las bases de datos **MySQL** y **MongoDB**.</span>
<span class="sd"> *</span>
<span class="sd"> *</span>
<span class="sd"> * ##  Funcionalidades:</span>
<span class="sd"> * - **Conexión a bases de datos** (MySQL y MongoDB).</span>
<span class="sd"> * - **Gestión de usuarios y permisos**.</span>
<span class="sd"> * - **Operaciones CRUD** en MySQL y MongoDB.</span>
<span class="sd"> * - **Protección contra ataques**:</span>
<span class="sd"> *   - **Fuerza bruta** (detección y bloqueo de IPs sospechosas).</span>
<span class="sd"> *   - **Saneamiento de entradas** (prevención de inyección SQL).</span>
<span class="sd"> *   - **Cifrado de datos sensibles**.</span>
<span class="sd"> *</span>
<span class="sd"> */</span> 


    <span class="c1">/////////////////////////////////////////// vamos a probar a integrar /////////////////////////////////</span>
    <span class="c1">// Activamos la visualización de errores</span>
    <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>       
    <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>       
    <span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span>

    <span class="c1">// Incluir archivos de conexión y seguridad</span>
    <span class="k">include</span> <span class="s2">&quot;conexionDB.php&quot;</span><span class="p">;</span>
    <span class="k">include</span> <span class="s2">&quot;ConectorMongoDB.php&quot;</span><span class="p">;</span>
    <span class="k">include</span> <span class="s2">&quot;lib/codificador.php&quot;</span><span class="p">;</span>          <span class="c1">// Añadido: Clase de cifrado</span>
    <span class="k">include</span> <span class="s2">&quot;lib/fuerza_bruta.php&quot;</span><span class="p">;</span>         <span class="c1">// Añadido: Protección contra fuerza bruta</span>
    <span class="k">include</span> <span class="s2">&quot;lib/registros.php&quot;</span><span class="p">;</span>            <span class="c1">// Añadido: Registro de actividad</span>
    <span class="k">include_once</span> <span class="s2">&quot;lib/sanear.php&quot;</span><span class="p">;</span>          <span class="c1">// Añadido: Saneamiento de entrada</span>

    <span class="c1">// Instancias de las clases</span>
    <span class="nv">$conexion</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">conexionDB</span><span class="p">();</span>
    <span class="nv">$conexionmongo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ConectorMongoDB</span><span class="p">();</span>
    <span class="nv">$codificador</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Cifrado</span><span class="p">();</span> 



    <span class="c1">///////////////////////////////////////////////////////////////////////////////////////////////////////</span>

    <span class="c1">//verificamos si existe el parametro o                                                                                          </span>
    <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">])){</span>
        <span class="c1">//y dependiendo del valor se realizara una accion diferente </span>
        <span class="k">switch</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">]){</span>
            <span class="c1">//para ir a la aplicaicon que le corresponda al departamento</span>
            <span class="k">case</span> <span class="s2">&quot;compruebatoken&quot;</span><span class="o">:</span>
                <span class="c1">//echo $_GET[&#39;token&#39;];</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">]))){</span>
                    <span class="k">if</span><span class="p">((</span><span class="nb">abs</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;token&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">date</span><span class="p">(</span><span class="s1">&#39;U&#39;</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mi">3600</span><span class="p">)){</span>
                        <span class="k">echo</span> <span class="s1">&#39;{&quot;resultado&quot;:&quot;ok&quot;}&#39;</span><span class="p">;</span>
                    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="k">echo</span> <span class="s1">&#39;{&quot;resultado&quot;:&quot;ko&quot;}&#39;</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="k">echo</span> <span class="s1">&#39;{&quot;resultado&quot;:&quot;ko&quot;}&#39;</span><span class="p">;</span>  
                    <span class="p">}</span>

                <span class="k">break</span><span class="p">;</span> 
            <span class="c1">//si llamamo </span>
            <span class="k">case</span> <span class="s2">&quot;listatablasaplicacion&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">listadoTablasAplicacion</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;aplicacion&#39;</span><span class="p">]);</span>                                                                                       
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">//si llamamos a este metodo, nos devolvera todoas las listas de las tablas </span>
            <span class="k">case</span> <span class="s2">&quot;listatablas&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">listadoTablas</span><span class="p">();</span>                                                                                        
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;listadoaplicacionesusuario&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">listadoAplicacionesUsuario</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;usuario&#39;</span><span class="p">]);</span>                                                                                       
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;datosgrafica&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">datosGrafica</span><span class="p">();</span>                                                                                     
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">/////////////////////////////// OPERACIONES PARA MOONGODB //////////////////////</span>
            <span class="k">case</span> <span class="s2">&quot;listacolecciones&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexionmongo</span><span class="o">-&gt;</span><span class="na">listarColeccion</span><span class="p">();</span>                                                                                     
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;listadocumentos&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexionmongo</span><span class="o">-&gt;</span><span class="na">listar</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;coleccion&#39;</span><span class="p">]);</span>                                                                                        <span class="c1">// Llamo a un metodo</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">///////// REALIZAR LAS BUSQUEDAS EN EL CAMPO DE BUSQUEDA ///////////////////////</span>
            <span class="k">case</span> <span class="s2">&quot;informe&quot;</span><span class="o">:</span>
                <span class="nv">$misdatos</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">registro</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">],</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]);</span>
                <span class="nv">$misdatos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$misdatos</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$misdatos</span><span class="p">))</span> <span class="p">{</span>
                    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;datos no válidos&quot;</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$misdatos</span><span class="p">,</span> <span class="nx">JSON_PRETTY_PRINT</span><span class="p">);</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">//nos seleccionara y devolvera los datos de una tabla especifica</span>
            <span class="k">case</span> <span class="s2">&quot;tabla&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">seleccionaTabla</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">]);</span>                                                                                
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">//nos devolvera todos los nombres de las columanas de una tabla especifica</span>
            <span class="k">case</span> <span class="s2">&quot;columnastabla&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">columnasTabla</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">]);</span>                                                                                      
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">//elimina una fila de una tabla específica, utilizando un identificador único que se pasa</span>
            <span class="k">case</span> <span class="s2">&quot;eliminar&quot;</span><span class="o">:</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">eliminaTabla</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">],</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]);</span>                                                                                       
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">//el script recoje los datos de la solicitud y lo descodifica y luego llama al metodo buscar</span>
            <span class="c1">//pasandole el nomrbe de la tabla y los datos descodificados </span>
            <span class="c1">//y relaimos la busqueda con esos conparametros </span>
            <span class="c1">//de estos casos se espera una solicitud POST</span>
            <span class="k">case</span> <span class="s2">&quot;buscar&quot;</span><span class="o">:</span>
                <span class="nv">$json</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>                                                   
                <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>                                                                                  
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">buscar</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">],</span><span class="nv">$datos</span><span class="p">);</span>                                                                                      
                <span class="k">break</span><span class="p">;</span>
            <span class="c1">/// SE ENCARGA DE HACER LA PETICION A LA BASE DE DATOS DESDE EL BOTON DE BUSQUEDA </span>
            <span class="k">case</span> <span class="s2">&quot;buscarseleccion&quot;</span><span class="o">:</span>
                <span class="nv">$json</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>                    
                <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>

                <span class="k">if</span> <span class="p">(</span><span class="nv">$datos</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">try</span> <span class="p">{</span>
                        <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">buscarSeleccion</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">],</span> <span class="nv">$datos</span><span class="p">);</span>  <span class="c1">// Intenta ejecutar la búsqueda</span>
                    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nv">$e</span><span class="p">)</span> <span class="p">{</span>
                        <span class="c1">// Si hay algún error, devolver un mensaje JSON de error</span>
                        <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Hubo un problema al realizar la búsqueda: &quot;</span> <span class="o">.</span> <span class="nv">$e</span><span class="o">-&gt;</span><span class="na">getMessage</span><span class="p">()]);</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;error&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;Datos de búsqueda inválidos&quot;</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="k">break</span><span class="p">;</span>

            <span class="c1">///para hacer funcionar la barra del buscador </span>
            <span class="k">case</span> <span class="s2">&quot;buscarSimilar&quot;</span><span class="o">:</span>
                <span class="nv">$json</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>                                                   
                <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>                                                                                  
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">buscarSimilar</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">],</span><span class="nv">$datos</span><span class="p">);</span>                                                                                       
                <span class="k">break</span><span class="p">;</span>
            <span class="k">case</span> <span class="s2">&quot;actualizar&quot;</span><span class="o">:</span>
                <span class="nv">$json</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>                                                   
                <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>                                                                                  
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">actualizar</span><span class="p">(</span><span class="nv">$datos</span><span class="p">);</span>                                                                                     
                <span class="k">break</span><span class="p">;</span>

            <span class="c1">//igual que en el de busqueda, esperamos la solicitud POST con cuerpod e JSON</span>
            <span class="c1">//recoge los datos y los descodifica </span>
            <span class="c1">//y inserta un nuevo registor en la tabla especifica</span>
            <span class="k">case</span> <span class="s2">&quot;insertar&quot;</span><span class="o">:</span>
                <span class="nv">$json</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>                                                   
                <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
                <span class="c1">///metemos nuesstra clase de cifrado</span>
                <span class="cm">/*$codificador = new Cifrado();</span>
<span class="cm">                foreach($datos as $clave =&gt; $valor){</span>
<span class="cm">                    if($clave != &quot;Identificador&quot;){</span>
<span class="cm">                        $datos[$clave] = $codificador-&gt;codifica($valor);</span>
<span class="cm">                    }</span>
<span class="cm">                }</span>
<span class="cm">                */</span>
                <span class="k">echo</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">insertaTabla</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">],</span><span class="nv">$datos</span><span class="p">);</span>                                                                                        
                <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\columnas_tabla.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">])){</span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="s2">&quot;clientes&quot;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="nb">mysqli_report</span><span class="p">(</span><span class="nx">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="nx">MYSQLI_REPORT_STRICT</span><span class="p">);</span>                  <span class="c1">// Establezco el nivel de retorno de errores de PHP</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>     <span class="c1">// Me conecto a la base de datos</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SHOW COLUMNS in &quot;</span><span class="o">.</span><span class="nv">$tabla</span> <span class="o">.</span><span class="s2">&quot;;</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                      <span class="c1">// Compruebo si el usuario enviado existe en la base de datos</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                    <span class="c1">// Ejecuto la petición contra la base de datos</span>
    <span class="nv">$aplicaciones</span> <span class="o">=</span> <span class="p">[];</span>                             <span class="c1">// Creo un array vacio</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                    <span class="c1">// en el caso de que exista</span>
        <span class="nv">$aplicaciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>                         <span class="c1">// Añado nueva aplicacioń al array</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$aplicaciones</span><span class="p">);</span>                        


<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\datos_tabla.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">])){</span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="s2">&quot;clientes&quot;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="nb">mysqli_report</span><span class="p">(</span><span class="nx">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="nx">MYSQLI_REPORT_STRICT</span><span class="p">);</span>      
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>      
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SELECT * FROM &quot;</span><span class="o">.</span><span class="nv">$tabla</span> <span class="o">.</span><span class="s2">&quot;;</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                      
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                
    <span class="nv">$aplicaciones</span> <span class="o">=</span> <span class="p">[];</span>                         
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                    
        <span class="nv">$aplicaciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>                         
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$aplicaciones</span><span class="p">);</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\eliminar_dato.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">])){</span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="s2">&quot;clientes&quot;</span><span class="p">;</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="nb">mysqli_report</span><span class="p">(</span><span class="nx">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="nx">MYSQLI_REPORT_STRICT</span><span class="p">);</span>          <span class="c1">// Establezco el nivel de retorno de errores de PHP</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">,</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>      <span class="c1">// Me conecto a la base de datos</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        DELETE FROM &quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;tabla&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot; WHERE Identificador = &quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;;</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                      <span class="c1">// Compruebo si el usuario enviado existe en la base de datos</span>
    <span class="k">echo</span> <span class="nv">$query</span><span class="p">;</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                    <span class="c1">// Ejecuto la petición contra la base de datos</span>
    <span class="nv">$aplicaciones</span> <span class="o">=</span> <span class="p">[];</span>                             <span class="c1">// Creo un array vacio</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                    <span class="c1">// en el caso de que exista</span>
        <span class="nv">$aplicaciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>                         <span class="c1">// Añado nueva aplicacioń al array</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$aplicaciones</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\insertar.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">);</span> 

    <span class="c1">// Atrapo lo que viene de formulario</span>
    <span class="nv">$json</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">&#39;php://input&#39;</span><span class="p">);</span>                                   
    <span class="c1">//lo descodificamos como JSON</span>
    <span class="nv">$data</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$json</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>                                                   
    <span class="c1">//para cada una de lasclaves del objeto</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$data</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>   
        <span class="c1">// Siempre que no sea el identificador                                              </span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$clave</span> <span class="o">==</span> <span class="s1">&#39;tabla&#39;</span><span class="p">){</span>  
        <span class="c1">// Lo encadeno con la petición SQL                                                              </span>
        <span class="nv">$tabla</span> <span class="o">=</span> <span class="nv">$valor</span><span class="p">;</span>                                                                                
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Comienzo a formatear la peticion</span>
    <span class="nv">$peticion</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO &quot;</span><span class="o">.</span><span class="nv">$tabla</span><span class="o">.</span><span class="s2">&quot; VALUES(NULL,&quot;</span><span class="p">;</span>                  
    <span class="c1">// Para cada una de las claves del objeto</span>
    <span class="k">foreach</span><span class="p">(</span><span class="nv">$data</span> <span class="k">as</span> <span class="nv">$clave</span><span class="o">=&gt;</span><span class="nv">$valor</span><span class="p">){</span>           
        <span class="c1">// Siempre que no sea el identificador                                  </span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$clave</span> <span class="o">!=</span> <span class="s2">&quot;Identificador&quot;</span> <span class="o">&amp;&amp;</span> <span class="nv">$clave</span> <span class="o">!=</span> <span class="s1">&#39;tabla&#39;</span><span class="p">){</span> 
        <span class="c1">//lo encadenamos con la peticion SQL                                            </span>
        <span class="nv">$peticion</span> <span class="o">.=</span> <span class="s2">&quot;&#39;&quot;</span><span class="o">.</span><span class="nv">$valor</span><span class="o">.</span><span class="s2">&quot;&#39;,&quot;</span><span class="p">;</span>                                                   
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="c1">// Le quito la última coma</span>
    <span class="nv">$peticion</span> <span class="o">=</span> <span class="nb">substr</span><span class="p">(</span><span class="nv">$peticion</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>                                           
    <span class="c1">// Le encadeno el último paréntesis</span>
    <span class="nv">$peticion</span> <span class="o">.=</span> <span class="s2">&quot;);&quot;</span><span class="p">;</span>      
    <span class="c1">// Lanzo la petición por pantalla                                                                       </span>
    <span class="k">echo</span> <span class="nv">$peticion</span><span class="p">;</span>                                                                                     
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$peticion</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\lista_aplicaciones.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="nb">mysqli_report</span><span class="p">(</span><span class="nx">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="nx">MYSQLI_REPORT_STRICT</span><span class="p">);</span>                  <span class="c1">// Establezco el nivel de retorno de errores de PHP</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>     <span class="c1">// Me conecto a la base de datos</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">            nombre,</span>
<span class="s2">            descripcion,</span>
<span class="s2">            icono</span>
<span class="s2">        FROM aplicaciones </span>
<span class="s2">        WHERE activa = 1</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                      <span class="c1">// Compruebo si el usuario enviado existe en la base de datos</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                    <span class="c1">// Ejecuto la petición contra la base de datos</span>
    <span class="nv">$aplicaciones</span> <span class="o">=</span> <span class="p">[];</span>                             <span class="c1">// Creo un array vacio</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                    <span class="c1">// en el caso de que exista</span>
        <span class="nv">$aplicaciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>                     <span class="c1">// Añado nueva aplicacioń al array</span>
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$aplicaciones</span><span class="p">);</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\lista_tablas.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="nb">mysqli_report</span><span class="p">(</span><span class="nx">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="nx">MYSQLI_REPORT_STRICT</span><span class="p">);</span>                 
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>     
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SHOW TABLES;</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                      
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                
    <span class="nv">$aplicaciones</span> <span class="o">=</span> <span class="p">[];</span>                         
    <span class="k">while</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                    
        <span class="nv">$aplicaciones</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>                         
    <span class="p">}</span>
    <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$aplicaciones</span><span class="p">);</span>                            


<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\antiguo\loginusuario.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

    <span class="nb">mysqli_report</span><span class="p">(</span><span class="nx">MYSQLI_REPORT_ERROR</span> <span class="o">|</span> <span class="nx">MYSQLI_REPORT_STRICT</span><span class="p">);</span>                  <span class="c1">// Establezco el nivel de retorno de errores de PHP</span>
    <span class="nv">$mysqli</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">,</span><span class="s2">&quot;crismon1&quot;</span><span class="p">);</span>     <span class="c1">// Me conecto a la base de datos</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">        usuario</span>
<span class="s2">        FROM usuarios </span>
<span class="s2">        WHERE usuario = &#39;&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;usuario&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39; </span>
<span class="s2">        AND contrasena = &#39;&quot;</span><span class="o">.</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;contrasena&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                      <span class="c1">// Compruebo si el usuario enviado existe en la base de datos</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$mysqli</span><span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>                    <span class="c1">// Ejecuto la petición contra la base de datos</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$row</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$result</span><span class="p">))</span> <span class="p">{</span>                   <span class="c1">// en el caso de que exista</span>
        <span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;resultado&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ok&#39;</span><span class="p">;</span>                       <span class="c1">// Le añado una propiedad resultado y le digo que es ok</span>
        <span class="k">echo</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$row</span><span class="p">);</span>                         <span class="c1">// Le añado además todo lo que viene de la base de datos</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>                                      <span class="c1">// en caso de que no exista</span>
        <span class="k">echo</span> <span class="s1">&#39;{&quot;resultado:&quot;:&quot;ko&quot;}&#39;</span><span class="p">;</span>                         <span class="c1">// Devuelvo al cliente un ko</span>
    <span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\lib\codificador.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * ##  Descripción:</span>
<span class="sd"> * Este archivo define una **clase de cifrado personalizada** que permite codificar y descodificar cadenas de texto. </span>
<span class="sd"> * Se usa para proteger datos sensibles mediante un doble proceso de cifrado:</span>
<span class="sd"> * 1. **Modificación de caracteres ASCII** sumando/restando 5 posiciones en cada carácter.</span>
<span class="sd"> * 2. **Triple codificación Base64** para mayor complejidad.</span>
<span class="sd"> *</span>
<span class="sd"> */</span>

<span class="k">class</span> <span class="nc">Cifrado</span> <span class="p">{</span>

    <span class="c1">// Método para codificar</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">codifica</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$salida</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$salida</span> <span class="o">.=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">+</span> <span class="mi">5</span><span class="p">);</span>  
        <span class="p">}</span>
        <span class="nv">$salida</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nv">$salida</span><span class="p">)));</span>  
        <span class="k">return</span> <span class="nv">$salida</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">// Método para decodificar</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">descodifica</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$entrada</span> <span class="o">=</span> <span class="nb">base64_decode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">)));</span>  
        <span class="nv">$salida</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">);</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Deshacer el cambio en los caracteres</span>
            <span class="nv">$salida</span> <span class="o">.=</span> <span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="nv">$entrada</span><span class="p">[</span><span class="nv">$i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">5</span><span class="p">);</span>  
        <span class="p">}</span>
        <span class="k">return</span> <span class="nv">$salida</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>


<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\lib\fuerza_bruta.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * # Archivo: fuerza_bruta.php</span>
<span class="sd"> *</span>
<span class="sd"> * ##  Descripción:</span>
<span class="sd"> * Este archivo implementa un **sistema de protección contra ataques de fuerza bruta**. Su objetivo es:</span>
<span class="sd"> * - **Monitorear intentos de conexión** en un período de 60 segundos.</span>
<span class="sd"> * - **Bloquear una IP** si supera los 100 intentos en dicho intervalo.</span>
<span class="sd"> * - **Registrar intentos sospechosos** en la base de datos.</span>
<span class="sd"> * - **Enviar una respuesta JSON en caso de detección de ataque**.</span>
<span class="sd"> *</span>
<span class="sd"> *</span>
<span class="sd"> * ##  Notas:</span>
<span class="sd"> * - La verificación se realiza utilizando la tabla `registros`.</span>
<span class="sd"> * - Requiere que la tabla `registros` contenga los campos: `ip`, `epoch`, `user_agent`, `url`, y `motivo`.</span>
<span class="sd"> */</span>

    <span class="c1">// Habilita la visualización de errores para depuración</span>
    <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>                                                                                               
    <span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_startup_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>                                                                               
    <span class="nb">error_reporting</span><span class="p">(</span><span class="k">E_ALL</span><span class="p">);</span> 

    <span class="c1">// INICIA LAS PROPIEDADES DE CONEXION</span>
    <span class="nv">$servidor</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span><span class="p">;</span>
    <span class="nv">$usuario</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
    <span class="nv">$contrasena</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
    <span class="nv">$basededatos</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>

    <span class="c1">// Establece la conexión con la base de datos</span>
    <span class="nv">$conexion</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span>
        <span class="nv">$servidor</span><span class="p">,</span> 
        <span class="nv">$usuario</span><span class="p">,</span> 
        <span class="nv">$contrasena</span><span class="p">,</span> 
        <span class="nv">$basededatos</span>
    <span class="p">);</span>  

    <span class="c1">// Consulta SQL para contar el número de intentos desde una IP específica en los últimos 60 segundos</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;</span>
<span class="s2">        SELECT </span>
<span class="s2">        COUNT(ip) AS numero </span>
<span class="s2">        FROM registros</span>
<span class="s2">        WHERE </span>
<span class="s2">        ip = &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;</span>
<span class="s2">        AND epoch &gt; UNIX_TIMESTAMP()-60;</span>
<span class="s2">    &quot;</span><span class="p">;</span>                                          
    <span class="c1">// echo $query; // Esta línea está comentada, podría usarse para depuración</span>
    <span class="nv">$resultado</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>  

    <span class="c1">// Recorre el resultado de la consulta</span>
    <span class="k">while</span> <span class="p">(</span><span class="nv">$fila</span> <span class="o">=</span> <span class="nx">mysqli_fetch_assoc</span><span class="p">(</span><span class="nv">$resultado</span><span class="p">))</span> <span class="p">{</span>                                        
        <span class="c1">// Verifica si el número de intentos excede 100</span>
        <span class="k">if</span><span class="p">(</span><span class="nv">$fila</span><span class="p">[</span><span class="s1">&#39;numero&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">){</span>
            <span class="c1">// Inserta un registro en la tabla &#39;registros&#39; indicando un bloqueo por fuerza bruta</span>
            <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO registros VALUES</span>
<span class="s2">                (</span>
<span class="s2">                    NULL,</span>
<span class="s2">                    &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                    &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                    &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                    &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                    &#39;BLOQUEO FUERZA BRUTA&#39;</span>
<span class="s2">                );&quot;</span><span class="p">;</span>                                            

            <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>
            <span class="c1">// Detiene la ejecución del script y devuelve un mensaje de error en formato JSON</span>
            <span class="k">die</span><span class="p">(</span><span class="s1">&#39;{&quot;error&quot;:&quot;te has pasado de bruto&quot;}&#39;</span><span class="p">);</span>
        <span class="p">}</span>                                                                           
    <span class="p">}</span>   



<span class="cp">?&gt;</span><span class="x"> </span>
</code></pre></div>

<h2>servidor\lib\ips_control.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo se encarga de **registrar y verificar accesos de usuarios** en la base de datos mediante:</span>
<span class="sd"> * - **Consulta de país de la IP** a través de una API externa.</span>
<span class="sd"> * - **Registro de IPs** en la base de datos (`ips_control`).</span>
<span class="sd"> * - **Actualización de país y navegador** en la base de datos cuando un usuario vuelve a conectarse.</span>
<span class="sd"> * - **Detección del navegador del usuario** para su posterior restricción si es necesario.</span>
<span class="sd"> *</span>
<span class="sd"> * ## Notas:</span>
<span class="sd"> * - Requiere `conexionDB.php` para conectar con la base de datos.</span>
<span class="sd"> * - Requiere `geolocalizacion.php` para verificar la ubicación geográfica de la IP.</span>
<span class="sd"> * - El registro de IPs permite futuras restricciones basadas en listas negras y ubicación.</span>
<span class="sd"> */</span>


<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&quot;/../conexionDB.php&quot;</span><span class="p">;</span>
<span class="k">include_once</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s1">&#39;/../../cliente/inc/geolocalizacion.php&#39;</span><span class="p">;</span>

<span class="k">function</span> <span class="nf">obtenerPaisDesdeAPI</span><span class="p">(</span><span class="nv">$ip</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nv">$ip</span> <span class="o">===</span> <span class="s1">&#39;::1&#39;</span> <span class="o">||</span> <span class="nv">$ip</span> <span class="o">===</span> <span class="s1">&#39;127.0.0.1&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;LOCALHOST&#39;</span><span class="p">;</span> <span class="c1">// Evitar consulta de localhost</span>
    <span class="p">}</span>

    <span class="nv">$url</span> <span class="o">=</span> <span class="s2">&quot;http://ip-api.com/json/</span><span class="si">{</span><span class="nv">$ip</span><span class="si">}</span><span class="s2">?fields=status,countryCode&quot;</span><span class="p">;</span>
    <span class="nv">$respuesta</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$url</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$respuesta</span> <span class="o">===</span> <span class="k">FALSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">&quot;Desconocido&quot;</span><span class="p">;</span> <span class="c1">// Si la API falla, no bloquear por país</span>
    <span class="p">}</span>

    <span class="nv">$datos</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$respuesta</span><span class="p">,</span> <span class="k">true</span><span class="p">);</span>
    <span class="k">return</span> <span class="p">(</span><span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;success&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$datos</span><span class="p">[</span><span class="s1">&#39;countryCode&#39;</span><span class="p">]</span> <span class="o">:</span> <span class="s2">&quot;Desconocido&quot;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">registrarAcceso</span><span class="p">(</span><span class="nv">$ip</span><span class="p">,</span> <span class="nv">$conexion</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$navegador</span> <span class="o">=</span> <span class="nx">detectarNavegador</span><span class="p">();</span> 
    <span class="nv">$url</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">];</span>
    <span class="nv">$lista_negra</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$lista_blanca</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nv">$pais</span> <span class="o">=</span> <span class="nx">obtenerPaisDesdeAPI</span><span class="p">(</span><span class="nv">$ip</span><span class="p">);</span> <span class="c1">// Obtener país desde API</span>
    <span class="nv">$bloqueo_por_pais</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">// Verificar si la IP ya está registrada</span>
    <span class="nv">$query_check</span> <span class="o">=</span> <span class="s2">&quot;SELECT ip FROM ips_control WHERE ip = ?&quot;</span><span class="p">;</span>
    <span class="nv">$stmt_check</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$query_check</span><span class="p">);</span>
    <span class="nv">$stmt_check</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">);</span>
    <span class="nv">$stmt_check</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="nv">$resultado</span> <span class="o">=</span> <span class="nv">$stmt_check</span><span class="o">-&gt;</span><span class="na">get_result</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$resultado</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Insertar nueva IP con país obtenido</span>
        <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO ips_control (ip, navegador, url, lista_negra, lista_blanca, pais, bloqueo_por_pais) </span>
<span class="s2">                  VALUES (?, ?, ?, ?, ?, ?, ?)&quot;</span><span class="p">;</span>
        <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$query</span><span class="p">);</span>
        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;sssissi&quot;</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">,</span> <span class="nv">$navegador</span><span class="p">,</span> <span class="nv">$url</span><span class="p">,</span> <span class="nv">$lista_negra</span><span class="p">,</span> <span class="nv">$lista_blanca</span><span class="p">,</span> <span class="nv">$pais</span><span class="p">,</span> <span class="nv">$bloqueo_por_pais</span><span class="p">);</span>
        <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Actualizar navegador y país si es diferente</span>
        <span class="nv">$query_update</span> <span class="o">=</span> <span class="s2">&quot;UPDATE ips_control SET navegador = ?, pais = ? WHERE ip = ?&quot;</span><span class="p">;</span>
        <span class="nv">$stmt_update</span> <span class="o">=</span> <span class="nv">$conexion</span><span class="o">-&gt;</span><span class="na">getConexion</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">prepare</span><span class="p">(</span><span class="nv">$query_update</span><span class="p">);</span>
        <span class="nv">$stmt_update</span><span class="o">-&gt;</span><span class="na">bind_param</span><span class="p">(</span><span class="s2">&quot;sss&quot;</span><span class="p">,</span> <span class="nv">$navegador</span><span class="p">,</span> <span class="nv">$pais</span><span class="p">,</span> <span class="nv">$ip</span><span class="p">);</span>
        <span class="nv">$stmt_update</span><span class="o">-&gt;</span><span class="na">execute</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="nf">detectarNavegador</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$userAgent</span> <span class="o">=</span> <span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">];</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;Firefox&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">return</span> <span class="s1">&#39;Firefox&#39;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;Chrome&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">return</span> <span class="s1">&#39;Chrome&#39;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;Edge&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">return</span> <span class="s1">&#39;Edge&#39;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;Safari&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="o">&amp;&amp;</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;Chrome&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="k">return</span> <span class="s1">&#39;Safari&#39;</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;Opera&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span> <span class="o">||</span> <span class="nb">strpos</span><span class="p">(</span><span class="nv">$userAgent</span><span class="p">,</span> <span class="s1">&#39;OPR&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="k">return</span> <span class="s1">&#39;Opera&#39;</span><span class="p">;</span>

    <span class="k">return</span> <span class="s1">&#39;Desconocido&#39;</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\lib\registros.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo **registra todas las solicitudes** a la aplicación en una base de datos. </span>
<span class="sd"> * Se utiliza para **monitoreo de accesos** y **detección de intentos sospechosos**.</span>
<span class="sd"> *</span>
<span class="sd"> *</span>
<span class="sd"> * ## Funcionamiento:</span>
<span class="sd"> * - Se conecta a la base de datos `crismon1`.</span>
<span class="sd"> * - Inserta un nuevo registro en la tabla `registros` con los siguientes datos:</span>
<span class="sd"> *   - **Fecha y hora del acceso** (`epoch`).</span>
<span class="sd"> *   - **Dirección IP del usuario** (`REMOTE_ADDR`).</span>
<span class="sd"> *   - **Navegador usado** (`HTTP_USER_AGENT`).</span>
<span class="sd"> *   - **Página solicitada** (`REQUEST_URI`).</span>
<span class="sd"> *</span>
<span class="sd"> */</span>
    <span class="c1">// INICIA DE CONEXION</span>
    <span class="nv">$servidor</span> <span class="o">=</span> <span class="s2">&quot;localhost&quot;</span><span class="p">;</span>
    <span class="nv">$usuario</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
    <span class="nv">$contrasena</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>
    <span class="nv">$basededatos</span> <span class="o">=</span> <span class="s2">&quot;crismon1&quot;</span><span class="p">;</span>

    <span class="nv">$conexion</span> <span class="o">=</span> <span class="nb">mysqli_connect</span><span class="p">(</span><span class="nv">$servidor</span><span class="p">,</span> <span class="nv">$usuario</span><span class="p">,</span> <span class="nv">$contrasena</span><span class="p">,</span> <span class="nv">$basededatos</span><span class="p">);</span>

    <span class="c1">// Inserta un registro en la base de datos</span>
    <span class="nv">$query</span> <span class="o">=</span> <span class="s2">&quot;INSERT INTO registros VALUES</span>

<span class="s2">            (</span>
<span class="s2">                NULL,</span>
<span class="s2">                &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_TIME&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REMOTE_ADDR&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;HTTP_USER_AGENT&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                &#39;&quot;</span><span class="o">.</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">&#39;REQUEST_URI&#39;</span><span class="p">]</span><span class="o">.</span><span class="s2">&quot;&#39;,</span>
<span class="s2">                &#39;&#39;</span>


<span class="s2">            );&quot;</span><span class="p">;</span>


    <span class="nv">$result</span> <span class="o">=</span> <span class="nx">mysqli_query</span><span class="p">(</span><span class="nv">$conexion</span> <span class="p">,</span> <span class="nv">$query</span><span class="p">);</span>


<span class="cp">?&gt;</span>
</code></pre></div>

<h2>servidor\lib\sanear.php</h2>
<div class="codehilite"><pre><span></span><code><span class="cp">&lt;?php</span>

<span class="sd">/**</span>
<span class="sd"> * ## Descripción:</span>
<span class="sd"> * Este archivo contiene una función para **sanitizar datos de entrada** y prevenir ataques de inyección SQL.</span>
<span class="sd"> *</span>
<span class="sd"> *</span>
<span class="sd"> * ## Funcionamiento:</span>
<span class="sd"> * - `sanear($elemento)`: </span>
<span class="sd"> *   - Verifica si la entrada es un array, de lo contrario devuelve un error JSON.</span>
<span class="sd"> *   - Comprueba que las claves y valores no contengan palabras prohibidas (`DELETE`, `DROP`, `TRUNCATE`, `TABLE`).</span>
<span class="sd"> *   - Aplica la verificación **de manera recursiva en arrays anidados**.</span>
<span class="sd"> *</span>
<span class="sd"> */</span>



<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">function_exists</span><span class="p">(</span><span class="s1">&#39;sanear&#39;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">function</span> <span class="nf">sanear</span><span class="p">(</span><span class="o">&amp;</span><span class="nv">$elemento</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$elemento</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">die</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;resultado&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;error 1&quot;</span><span class="p">]));</span>
        <span class="p">}</span>

        <span class="nv">$coleccion</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="s1">&#39;drop&#39;</span><span class="p">,</span> <span class="s1">&#39;truncate&#39;</span><span class="p">,</span> <span class="s1">&#39;table&#39;</span><span class="p">];</span>

        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$elemento</span> <span class="k">as</span> <span class="nv">$clave</span> <span class="o">=&gt;</span> <span class="nv">$valor</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$entradaClave</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$clave</span><span class="p">);</span>
            <span class="k">foreach</span> <span class="p">(</span><span class="nv">$coleccion</span> <span class="k">as</span> <span class="nv">$palabra</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$entradaClave</span><span class="p">,</span> <span class="nv">$palabra</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">die</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;resultado&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;error 2&quot;</span><span class="p">]));</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="nb">is_string</span><span class="p">(</span><span class="nv">$valor</span><span class="p">))</span> <span class="p">{</span>
                <span class="nv">$entradaValor</span> <span class="o">=</span> <span class="nb">strtolower</span><span class="p">(</span><span class="nv">$valor</span><span class="p">);</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$coleccion</span> <span class="k">as</span> <span class="nv">$palabra</span><span class="p">)</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$entradaValor</span><span class="p">,</span> <span class="nv">$palabra</span><span class="p">)</span> <span class="o">!==</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">die</span><span class="p">(</span><span class="nb">json_encode</span><span class="p">([</span><span class="s2">&quot;resultado&quot;</span> <span class="o">=&gt;</span> <span class="s2">&quot;error 2&quot;</span><span class="p">]));</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nb">is_array</span><span class="p">(</span><span class="nv">$valor</span><span class="p">))</span> <span class="p">{</span>
                <span class="nx">sanear</span><span class="p">(</span><span class="nv">$valor</span><span class="p">);</span> <span class="c1">// Recursión para limpiar arrays anidados</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</code></pre></div>

<h1>Análisis Estático y Resumen del Código</h1>
            </main>
        </div>
    </body>
    </html>
    